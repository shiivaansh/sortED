var _k=Object.defineProperty;var kk=(t,e,r)=>e in t?_k(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Wu=(t,e,r)=>kk(t,typeof e!="symbol"?e+"":e,r);function Nk(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();function Ek(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zy={exports:{}},Mc={},By={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ho=Symbol.for("react.element"),jk=Symbol.for("react.portal"),Tk=Symbol.for("react.fragment"),Sk=Symbol.for("react.strict_mode"),Ak=Symbol.for("react.profiler"),Ik=Symbol.for("react.provider"),Ck=Symbol.for("react.context"),Pk=Symbol.for("react.forward_ref"),Rk=Symbol.for("react.suspense"),Dk=Symbol.for("react.memo"),Mk=Symbol.for("react.lazy"),lp=Symbol.iterator;function Lk(t){return t===null||typeof t!="object"?null:(t=lp&&t[lp]||t["@@iterator"],typeof t=="function"?t:null)}var qy={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Hy=Object.assign,Wy={};function Ii(t,e,r){this.props=t,this.context=e,this.refs=Wy,this.updater=r||qy}Ii.prototype.isReactComponent={};Ii.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ii.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Gy(){}Gy.prototype=Ii.prototype;function am(t,e,r){this.props=t,this.context=e,this.refs=Wy,this.updater=r||qy}var om=am.prototype=new Gy;om.constructor=am;Hy(om,Ii.prototype);om.isPureReactComponent=!0;var cp=Array.isArray,Ky=Object.prototype.hasOwnProperty,lm={current:null},Qy={key:!0,ref:!0,__self:!0,__source:!0};function Yy(t,e,r){var n,s={},i=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Ky.call(e,n)&&!Qy.hasOwnProperty(n)&&(s[n]=e[n]);var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(n in c=t.defaultProps,c)s[n]===void 0&&(s[n]=c[n]);return{$$typeof:ho,type:t,key:i,ref:o,props:s,_owner:lm.current}}function Ok(t,e){return{$$typeof:ho,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function cm(t){return typeof t=="object"&&t!==null&&t.$$typeof===ho}function Vk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var up=/\/+/g;function Gu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Vk(""+t.key):e.toString(36)}function _l(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ho:case jk:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+Gu(o,0):n,cp(s)?(r="",t!=null&&(r=t.replace(up,"$&/")+"/"),_l(s,e,r,"",function(d){return d})):s!=null&&(cm(s)&&(s=Ok(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(up,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",cp(t))for(var c=0;c<t.length;c++){i=t[c];var u=n+Gu(i,c);o+=_l(i,e,r,u,s)}else if(u=Lk(t),typeof u=="function")for(t=u.call(t),c=0;!(i=t.next()).done;)i=i.value,u=n+Gu(i,c++),o+=_l(i,e,r,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Zo(t,e,r){if(t==null)return t;var n=[],s=0;return _l(t,n,"","",function(i){return e.call(r,i,s++)}),n}function Fk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var At={current:null},kl={transition:null},Uk={ReactCurrentDispatcher:At,ReactCurrentBatchConfig:kl,ReactCurrentOwner:lm};function Jy(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Zo,forEach:function(t,e,r){Zo(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Zo(t,function(){e++}),e},toArray:function(t){return Zo(t,function(e){return e})||[]},only:function(t){if(!cm(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ae.Component=Ii;ae.Fragment=Tk;ae.Profiler=Ak;ae.PureComponent=am;ae.StrictMode=Sk;ae.Suspense=Rk;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Uk;ae.act=Jy;ae.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Hy({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=lm.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var c=t.type.defaultProps;for(u in e)Ky.call(e,u)&&!Qy.hasOwnProperty(u)&&(n[u]=e[u]===void 0&&c!==void 0?c[u]:e[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];n.children=c}return{$$typeof:ho,type:t.type,key:s,ref:i,props:n,_owner:o}};ae.createContext=function(t){return t={$$typeof:Ck,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Ik,_context:t},t.Consumer=t};ae.createElement=Yy;ae.createFactory=function(t){var e=Yy.bind(null,t);return e.type=t,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(t){return{$$typeof:Pk,render:t}};ae.isValidElement=cm;ae.lazy=function(t){return{$$typeof:Mk,_payload:{_status:-1,_result:t},_init:Fk}};ae.memo=function(t,e){return{$$typeof:Dk,type:t,compare:e===void 0?null:e}};ae.startTransition=function(t){var e=kl.transition;kl.transition={};try{t()}finally{kl.transition=e}};ae.unstable_act=Jy;ae.useCallback=function(t,e){return At.current.useCallback(t,e)};ae.useContext=function(t){return At.current.useContext(t)};ae.useDebugValue=function(){};ae.useDeferredValue=function(t){return At.current.useDeferredValue(t)};ae.useEffect=function(t,e){return At.current.useEffect(t,e)};ae.useId=function(){return At.current.useId()};ae.useImperativeHandle=function(t,e,r){return At.current.useImperativeHandle(t,e,r)};ae.useInsertionEffect=function(t,e){return At.current.useInsertionEffect(t,e)};ae.useLayoutEffect=function(t,e){return At.current.useLayoutEffect(t,e)};ae.useMemo=function(t,e){return At.current.useMemo(t,e)};ae.useReducer=function(t,e,r){return At.current.useReducer(t,e,r)};ae.useRef=function(t){return At.current.useRef(t)};ae.useState=function(t){return At.current.useState(t)};ae.useSyncExternalStore=function(t,e,r){return At.current.useSyncExternalStore(t,e,r)};ae.useTransition=function(){return At.current.useTransition()};ae.version="18.3.1";By.exports=ae;var C=By.exports;const $k=Ek(C),zk=Nk({__proto__:null,default:$k},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bk=C,qk=Symbol.for("react.element"),Hk=Symbol.for("react.fragment"),Wk=Object.prototype.hasOwnProperty,Gk=Bk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kk={key:!0,ref:!0,__self:!0,__source:!0};function Xy(t,e,r){var n,s={},i=null,o=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Wk.call(e,n)&&!Kk.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:qk,type:t,key:i,ref:o,props:s,_owner:Gk.current}}Mc.Fragment=Hk;Mc.jsx=Xy;Mc.jsxs=Xy;zy.exports=Mc;var a=zy.exports,Zy={exports:{}},Qt={},ex={exports:{}},tx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,X){var B=H.length;H.push(X);e:for(;0<B;){var ue=B-1>>>1,xe=H[ue];if(0<s(xe,X))H[ue]=X,H[B]=xe,B=ue;else break e}}function r(H){return H.length===0?null:H[0]}function n(H){if(H.length===0)return null;var X=H[0],B=H.pop();if(B!==X){H[0]=B;e:for(var ue=0,xe=H.length,Ue=xe>>>1;ue<Ue;){var Sr=2*(ue+1)-1,Ar=H[Sr],Ir=Sr+1,Cr=H[Ir];if(0>s(Ar,B))Ir<xe&&0>s(Cr,Ar)?(H[ue]=Cr,H[Ir]=B,ue=Ir):(H[ue]=Ar,H[Sr]=B,ue=Sr);else if(Ir<xe&&0>s(Cr,B))H[ue]=Cr,H[Ir]=B,ue=Ir;else break e}}return X}function s(H,X){var B=H.sortIndex-X.sortIndex;return B!==0?B:H.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],d=[],f=1,m=null,v=3,y=!1,j=!1,A=!1,R=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(H){for(var X=r(d);X!==null;){if(X.callback===null)n(d);else if(X.startTime<=H)n(d),X.sortIndex=X.expirationTime,e(u,X);else break;X=r(d)}}function P(H){if(A=!1,I(H),!j)if(r(u)!==null)j=!0,be(O);else{var X=r(d);X!==null&&De(P,X.startTime-H)}}function O(H,X){j=!1,A&&(A=!1,_(x),x=-1),y=!0;var B=v;try{for(I(X),m=r(u);m!==null&&(!(m.expirationTime>X)||H&&!b());){var ue=m.callback;if(typeof ue=="function"){m.callback=null,v=m.priorityLevel;var xe=ue(m.expirationTime<=X);X=t.unstable_now(),typeof xe=="function"?m.callback=xe:m===r(u)&&n(u),I(X)}else n(u);m=r(u)}if(m!==null)var Ue=!0;else{var Sr=r(d);Sr!==null&&De(P,Sr.startTime-X),Ue=!1}return Ue}finally{m=null,v=B,y=!1}}var D=!1,w=null,x=-1,g=5,k=-1;function b(){return!(t.unstable_now()-k<g)}function S(){if(w!==null){var H=t.unstable_now();k=H;var X=!0;try{X=w(!0,H)}finally{X?T():(D=!1,w=null)}}else D=!1}var T;if(typeof N=="function")T=function(){N(S)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,ee=V.port2;V.port1.onmessage=S,T=function(){ee.postMessage(null)}}else T=function(){R(S,0)};function be(H){w=H,D||(D=!0,T())}function De(H,X){x=R(function(){H(t.unstable_now())},X)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){j||y||(j=!0,be(O))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):g=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(H){switch(v){case 1:case 2:case 3:var X=3;break;default:X=v}var B=v;v=X;try{return H()}finally{v=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,X){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var B=v;v=H;try{return X()}finally{v=B}},t.unstable_scheduleCallback=function(H,X,B){var ue=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?ue+B:ue):B=ue,H){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=B+xe,H={id:f++,callback:X,priorityLevel:H,startTime:B,expirationTime:xe,sortIndex:-1},B>ue?(H.sortIndex=B,e(d,H),r(u)===null&&H===r(d)&&(A?(_(x),x=-1):A=!0,De(P,B-ue))):(H.sortIndex=xe,e(u,H),j||y||(j=!0,be(O))),H},t.unstable_shouldYield=b,t.unstable_wrapCallback=function(H){var X=v;return function(){var B=v;v=X;try{return H.apply(this,arguments)}finally{v=B}}}})(tx);ex.exports=tx;var Qk=ex.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yk=C,Kt=Qk;function z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var rx=new Set,Ma={};function _s(t,e){ci(t,e),ci(t+"Capture",e)}function ci(t,e){for(Ma[t]=e,t=0;t<e.length;t++)rx.add(e[t])}var qr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rd=Object.prototype.hasOwnProperty,Jk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dp={},hp={};function Xk(t){return Rd.call(hp,t)?!0:Rd.call(dp,t)?!1:Jk.test(t)?hp[t]=!0:(dp[t]=!0,!1)}function Zk(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function e1(t,e,r,n){if(e===null||typeof e>"u"||Zk(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function It(t,e,r,n,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var lt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){lt[t]=new It(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];lt[e]=new It(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){lt[t]=new It(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){lt[t]=new It(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){lt[t]=new It(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){lt[t]=new It(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){lt[t]=new It(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){lt[t]=new It(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){lt[t]=new It(t,5,!1,t.toLowerCase(),null,!1,!1)});var um=/[\-:]([a-z])/g;function dm(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(um,dm);lt[e]=new It(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(um,dm);lt[e]=new It(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(um,dm);lt[e]=new It(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){lt[t]=new It(t,1,!1,t.toLowerCase(),null,!1,!1)});lt.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){lt[t]=new It(t,1,!1,t.toLowerCase(),null,!0,!0)});function hm(t,e,r,n){var s=lt.hasOwnProperty(e)?lt[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(e1(e,r,s,n)&&(r=null),n||s===null?Xk(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var en=Yk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,el=Symbol.for("react.element"),Fs=Symbol.for("react.portal"),Us=Symbol.for("react.fragment"),mm=Symbol.for("react.strict_mode"),Dd=Symbol.for("react.profiler"),nx=Symbol.for("react.provider"),sx=Symbol.for("react.context"),fm=Symbol.for("react.forward_ref"),Md=Symbol.for("react.suspense"),Ld=Symbol.for("react.suspense_list"),gm=Symbol.for("react.memo"),mn=Symbol.for("react.lazy"),ix=Symbol.for("react.offscreen"),mp=Symbol.iterator;function ra(t){return t===null||typeof t!="object"?null:(t=mp&&t[mp]||t["@@iterator"],typeof t=="function"?t:null)}var Pe=Object.assign,Ku;function da(t){if(Ku===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Ku=e&&e[1]||""}return`
`+Ku+t}var Qu=!1;function Yu(t,e){if(!t||Qu)return"";Qu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var n=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){n=d}t.call(e.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=n.stack.split(`
`),o=s.length-1,c=i.length-1;1<=o&&0<=c&&s[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(s[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||s[o]!==i[c]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=c);break}}}finally{Qu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?da(t):""}function t1(t){switch(t.tag){case 5:return da(t.type);case 16:return da("Lazy");case 13:return da("Suspense");case 19:return da("SuspenseList");case 0:case 2:case 15:return t=Yu(t.type,!1),t;case 11:return t=Yu(t.type.render,!1),t;case 1:return t=Yu(t.type,!0),t;default:return""}}function Od(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Us:return"Fragment";case Fs:return"Portal";case Dd:return"Profiler";case mm:return"StrictMode";case Md:return"Suspense";case Ld:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case sx:return(t.displayName||"Context")+".Consumer";case nx:return(t._context.displayName||"Context")+".Provider";case fm:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gm:return e=t.displayName||null,e!==null?e:Od(t.type)||"Memo";case mn:e=t._payload,t=t._init;try{return Od(t(e))}catch{}}return null}function r1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Od(e);case 8:return e===mm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ax(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function n1(t){var e=ax(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tl(t){t._valueTracker||(t._valueTracker=n1(t))}function ox(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=ax(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Bl(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vd(t,e){var r=e.checked;return Pe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function fp(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=Vn(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lx(t,e){e=e.checked,e!=null&&hm(t,"checked",e,!1)}function Fd(t,e){lx(t,e);var r=Vn(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ud(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ud(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function gp(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ud(t,e,r){(e!=="number"||Bl(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var ha=Array.isArray;function Zs(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+Vn(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $d(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Pe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pp(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(z(92));if(ha(r)){if(1<r.length)throw Error(z(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Vn(r)}}function cx(t,e){var r=Vn(e.value),n=Vn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function yp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ux(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ux(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var rl,dx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(rl=rl||document.createElement("div"),rl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=rl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function La(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var ba={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},s1=["Webkit","ms","Moz","O"];Object.keys(ba).forEach(function(t){s1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ba[e]=ba[t]})});function hx(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||ba.hasOwnProperty(t)&&ba[t]?(""+e).trim():e+"px"}function mx(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=hx(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var i1=Pe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bd(t,e){if(e){if(i1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function qd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hd=null;function pm(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Wd=null,ei=null,ti=null;function xp(t){if(t=go(t)){if(typeof Wd!="function")throw Error(z(280));var e=t.stateNode;e&&(e=Uc(e),Wd(t.stateNode,t.type,e))}}function fx(t){ei?ti?ti.push(t):ti=[t]:ei=t}function gx(){if(ei){var t=ei,e=ti;if(ti=ei=null,xp(t),e)for(t=0;t<e.length;t++)xp(e[t])}}function px(t,e){return t(e)}function yx(){}var Ju=!1;function xx(t,e,r){if(Ju)return t(e,r);Ju=!0;try{return px(t,e,r)}finally{Ju=!1,(ei!==null||ti!==null)&&(yx(),gx())}}function Oa(t,e){var r=t.stateNode;if(r===null)return null;var n=Uc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(z(231,e,typeof r));return r}var Gd=!1;if(qr)try{var na={};Object.defineProperty(na,"passive",{get:function(){Gd=!0}}),window.addEventListener("test",na,na),window.removeEventListener("test",na,na)}catch{Gd=!1}function a1(t,e,r,n,s,i,o,c,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(f){this.onError(f)}}var _a=!1,ql=null,Hl=!1,Kd=null,o1={onError:function(t){_a=!0,ql=t}};function l1(t,e,r,n,s,i,o,c,u){_a=!1,ql=null,a1.apply(o1,arguments)}function c1(t,e,r,n,s,i,o,c,u){if(l1.apply(this,arguments),_a){if(_a){var d=ql;_a=!1,ql=null}else throw Error(z(198));Hl||(Hl=!0,Kd=d)}}function ks(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function vx(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vp(t){if(ks(t)!==t)throw Error(z(188))}function u1(t){var e=t.alternate;if(!e){if(e=ks(t),e===null)throw Error(z(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return vp(s),t;if(i===n)return vp(s),e;i=i.sibling}throw Error(z(188))}if(r.return!==n.return)r=s,n=i;else{for(var o=!1,c=s.child;c;){if(c===r){o=!0,r=s,n=i;break}if(c===n){o=!0,n=s,r=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===r){o=!0,r=i,n=s;break}if(c===n){o=!0,n=i,r=s;break}c=c.sibling}if(!o)throw Error(z(189))}}if(r.alternate!==n)throw Error(z(190))}if(r.tag!==3)throw Error(z(188));return r.stateNode.current===r?t:e}function wx(t){return t=u1(t),t!==null?bx(t):null}function bx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=bx(t);if(e!==null)return e;t=t.sibling}return null}var _x=Kt.unstable_scheduleCallback,wp=Kt.unstable_cancelCallback,d1=Kt.unstable_shouldYield,h1=Kt.unstable_requestPaint,ze=Kt.unstable_now,m1=Kt.unstable_getCurrentPriorityLevel,ym=Kt.unstable_ImmediatePriority,kx=Kt.unstable_UserBlockingPriority,Wl=Kt.unstable_NormalPriority,f1=Kt.unstable_LowPriority,Nx=Kt.unstable_IdlePriority,Lc=null,wr=null;function g1(t){if(wr&&typeof wr.onCommitFiberRoot=="function")try{wr.onCommitFiberRoot(Lc,t,void 0,(t.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:x1,p1=Math.log,y1=Math.LN2;function x1(t){return t>>>=0,t===0?32:31-(p1(t)/y1|0)|0}var nl=64,sl=4194304;function ma(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,o=r&268435455;if(o!==0){var c=o&~s;c!==0?n=ma(c):(i&=o,i!==0&&(n=ma(i)))}else o=r&~s,o!==0?n=ma(o):i!==0&&(n=ma(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-lr(e),s=1<<r,n|=t[r],e&=~s;return n}function v1(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function w1(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-lr(i),c=1<<o,u=s[o];u===-1?(!(c&r)||c&n)&&(s[o]=v1(c,e)):u<=e&&(t.expiredLanes|=c),i&=~c}}function Qd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ex(){var t=nl;return nl<<=1,!(nl&4194240)&&(nl=64),t}function Xu(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function mo(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lr(e),t[e]=r}function b1(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-lr(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function xm(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-lr(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var pe=0;function jx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Tx,vm,Sx,Ax,Ix,Yd=!1,il=[],En=null,jn=null,Tn=null,Va=new Map,Fa=new Map,gn=[],_1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function bp(t,e){switch(t){case"focusin":case"focusout":En=null;break;case"dragenter":case"dragleave":jn=null;break;case"mouseover":case"mouseout":Tn=null;break;case"pointerover":case"pointerout":Va.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fa.delete(e.pointerId)}}function sa(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=go(e),e!==null&&vm(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function k1(t,e,r,n,s){switch(e){case"focusin":return En=sa(En,t,e,r,n,s),!0;case"dragenter":return jn=sa(jn,t,e,r,n,s),!0;case"mouseover":return Tn=sa(Tn,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return Va.set(i,sa(Va.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,Fa.set(i,sa(Fa.get(i)||null,t,e,r,n,s)),!0}return!1}function Cx(t){var e=rs(t.target);if(e!==null){var r=ks(e);if(r!==null){if(e=r.tag,e===13){if(e=vx(r),e!==null){t.blockedOn=e,Ix(t.priority,function(){Sx(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Jd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Hd=n,r.target.dispatchEvent(n),Hd=null}else return e=go(r),e!==null&&vm(e),t.blockedOn=r,!1;e.shift()}return!0}function _p(t,e,r){Nl(t)&&r.delete(e)}function N1(){Yd=!1,En!==null&&Nl(En)&&(En=null),jn!==null&&Nl(jn)&&(jn=null),Tn!==null&&Nl(Tn)&&(Tn=null),Va.forEach(_p),Fa.forEach(_p)}function ia(t,e){t.blockedOn===e&&(t.blockedOn=null,Yd||(Yd=!0,Kt.unstable_scheduleCallback(Kt.unstable_NormalPriority,N1)))}function Ua(t){function e(s){return ia(s,t)}if(0<il.length){ia(il[0],t);for(var r=1;r<il.length;r++){var n=il[r];n.blockedOn===t&&(n.blockedOn=null)}}for(En!==null&&ia(En,t),jn!==null&&ia(jn,t),Tn!==null&&ia(Tn,t),Va.forEach(e),Fa.forEach(e),r=0;r<gn.length;r++)n=gn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<gn.length&&(r=gn[0],r.blockedOn===null);)Cx(r),r.blockedOn===null&&gn.shift()}var ri=en.ReactCurrentBatchConfig,Kl=!0;function E1(t,e,r,n){var s=pe,i=ri.transition;ri.transition=null;try{pe=1,wm(t,e,r,n)}finally{pe=s,ri.transition=i}}function j1(t,e,r,n){var s=pe,i=ri.transition;ri.transition=null;try{pe=4,wm(t,e,r,n)}finally{pe=s,ri.transition=i}}function wm(t,e,r,n){if(Kl){var s=Jd(t,e,r,n);if(s===null)ld(t,e,n,Ql,r),bp(t,n);else if(k1(s,t,e,r,n))n.stopPropagation();else if(bp(t,n),e&4&&-1<_1.indexOf(t)){for(;s!==null;){var i=go(s);if(i!==null&&Tx(i),i=Jd(t,e,r,n),i===null&&ld(t,e,n,Ql,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else ld(t,e,n,null,r)}}var Ql=null;function Jd(t,e,r,n){if(Ql=null,t=pm(n),t=rs(t),t!==null)if(e=ks(t),e===null)t=null;else if(r=e.tag,r===13){if(t=vx(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ql=t,null}function Px(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(m1()){case ym:return 1;case kx:return 4;case Wl:case f1:return 16;case Nx:return 536870912;default:return 16}default:return 16}}var bn=null,bm=null,El=null;function Rx(){if(El)return El;var t,e=bm,r=e.length,n,s="value"in bn?bn.value:bn.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[i-n];n++);return El=s.slice(t,1<n?1-n:void 0)}function jl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function al(){return!0}function kp(){return!1}function Yt(t){function e(r,n,s,i,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in t)t.hasOwnProperty(c)&&(r=t[c],this[c]=r?r(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?al:kp,this.isPropagationStopped=kp,this}return Pe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=al)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=al)},persist:function(){},isPersistent:al}),e}var Ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_m=Yt(Ci),fo=Pe({},Ci,{view:0,detail:0}),T1=Yt(fo),Zu,ed,aa,Oc=Pe({},fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:km,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==aa&&(aa&&t.type==="mousemove"?(Zu=t.screenX-aa.screenX,ed=t.screenY-aa.screenY):ed=Zu=0,aa=t),Zu)},movementY:function(t){return"movementY"in t?t.movementY:ed}}),Np=Yt(Oc),S1=Pe({},Oc,{dataTransfer:0}),A1=Yt(S1),I1=Pe({},fo,{relatedTarget:0}),td=Yt(I1),C1=Pe({},Ci,{animationName:0,elapsedTime:0,pseudoElement:0}),P1=Yt(C1),R1=Pe({},Ci,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),D1=Yt(R1),M1=Pe({},Ci,{data:0}),Ep=Yt(M1),L1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},O1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},V1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function F1(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=V1[t])?!!e[t]:!1}function km(){return F1}var U1=Pe({},fo,{key:function(t){if(t.key){var e=L1[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=jl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?O1[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:km,charCode:function(t){return t.type==="keypress"?jl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),$1=Yt(U1),z1=Pe({},Oc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jp=Yt(z1),B1=Pe({},fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:km}),q1=Yt(B1),H1=Pe({},Ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),W1=Yt(H1),G1=Pe({},Oc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),K1=Yt(G1),Q1=[9,13,27,32],Nm=qr&&"CompositionEvent"in window,ka=null;qr&&"documentMode"in document&&(ka=document.documentMode);var Y1=qr&&"TextEvent"in window&&!ka,Dx=qr&&(!Nm||ka&&8<ka&&11>=ka),Tp=" ",Sp=!1;function Mx(t,e){switch(t){case"keyup":return Q1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var $s=!1;function J1(t,e){switch(t){case"compositionend":return Lx(e);case"keypress":return e.which!==32?null:(Sp=!0,Tp);case"textInput":return t=e.data,t===Tp&&Sp?null:t;default:return null}}function X1(t,e){if($s)return t==="compositionend"||!Nm&&Mx(t,e)?(t=Rx(),El=bm=bn=null,$s=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Dx&&e.locale!=="ko"?null:e.data;default:return null}}var Z1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ap(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Z1[t.type]:e==="textarea"}function Ox(t,e,r,n){fx(n),e=Yl(e,"onChange"),0<e.length&&(r=new _m("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Na=null,$a=null;function eN(t){Kx(t,0)}function Vc(t){var e=qs(t);if(ox(e))return t}function tN(t,e){if(t==="change")return e}var Vx=!1;if(qr){var rd;if(qr){var nd="oninput"in document;if(!nd){var Ip=document.createElement("div");Ip.setAttribute("oninput","return;"),nd=typeof Ip.oninput=="function"}rd=nd}else rd=!1;Vx=rd&&(!document.documentMode||9<document.documentMode)}function Cp(){Na&&(Na.detachEvent("onpropertychange",Fx),$a=Na=null)}function Fx(t){if(t.propertyName==="value"&&Vc($a)){var e=[];Ox(e,$a,t,pm(t)),xx(eN,e)}}function rN(t,e,r){t==="focusin"?(Cp(),Na=e,$a=r,Na.attachEvent("onpropertychange",Fx)):t==="focusout"&&Cp()}function nN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Vc($a)}function sN(t,e){if(t==="click")return Vc(e)}function iN(t,e){if(t==="input"||t==="change")return Vc(e)}function aN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var dr=typeof Object.is=="function"?Object.is:aN;function za(t,e){if(dr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Rd.call(e,s)||!dr(t[s],e[s]))return!1}return!0}function Pp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Rp(t,e){var r=Pp(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Pp(r)}}function Ux(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ux(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $x(){for(var t=window,e=Bl();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Bl(t.document)}return e}function Em(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oN(t){var e=$x(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Ux(r.ownerDocument.documentElement,r)){if(n!==null&&Em(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=Rp(r,i);var o=Rp(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var lN=qr&&"documentMode"in document&&11>=document.documentMode,zs=null,Xd=null,Ea=null,Zd=!1;function Dp(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Zd||zs==null||zs!==Bl(n)||(n=zs,"selectionStart"in n&&Em(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ea&&za(Ea,n)||(Ea=n,n=Yl(Xd,"onSelect"),0<n.length&&(e=new _m("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=zs)))}function ol(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Bs={animationend:ol("Animation","AnimationEnd"),animationiteration:ol("Animation","AnimationIteration"),animationstart:ol("Animation","AnimationStart"),transitionend:ol("Transition","TransitionEnd")},sd={},zx={};qr&&(zx=document.createElement("div").style,"AnimationEvent"in window||(delete Bs.animationend.animation,delete Bs.animationiteration.animation,delete Bs.animationstart.animation),"TransitionEvent"in window||delete Bs.transitionend.transition);function Fc(t){if(sd[t])return sd[t];if(!Bs[t])return t;var e=Bs[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in zx)return sd[t]=e[r];return t}var Bx=Fc("animationend"),qx=Fc("animationiteration"),Hx=Fc("animationstart"),Wx=Fc("transitionend"),Gx=new Map,Mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bn(t,e){Gx.set(t,e),_s(e,[t])}for(var id=0;id<Mp.length;id++){var ad=Mp[id],cN=ad.toLowerCase(),uN=ad[0].toUpperCase()+ad.slice(1);Bn(cN,"on"+uN)}Bn(Bx,"onAnimationEnd");Bn(qx,"onAnimationIteration");Bn(Hx,"onAnimationStart");Bn("dblclick","onDoubleClick");Bn("focusin","onFocus");Bn("focusout","onBlur");Bn(Wx,"onTransitionEnd");ci("onMouseEnter",["mouseout","mouseover"]);ci("onMouseLeave",["mouseout","mouseover"]);ci("onPointerEnter",["pointerout","pointerover"]);ci("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dN=new Set("cancel close invalid load scroll toggle".split(" ").concat(fa));function Lp(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,c1(n,e,void 0,t),t.currentTarget=null}function Kx(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var o=n.length-1;0<=o;o--){var c=n[o],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==i&&s.isPropagationStopped())break e;Lp(s,c,d),i=u}else for(o=0;o<n.length;o++){if(c=n[o],u=c.instance,d=c.currentTarget,c=c.listener,u!==i&&s.isPropagationStopped())break e;Lp(s,c,d),i=u}}}if(Hl)throw t=Kd,Hl=!1,Kd=null,t}function Ne(t,e){var r=e[sh];r===void 0&&(r=e[sh]=new Set);var n=t+"__bubble";r.has(n)||(Qx(e,t,2,!1),r.add(n))}function od(t,e,r){var n=0;e&&(n|=4),Qx(r,t,n,e)}var ll="_reactListening"+Math.random().toString(36).slice(2);function Ba(t){if(!t[ll]){t[ll]=!0,rx.forEach(function(r){r!=="selectionchange"&&(dN.has(r)||od(r,!1,t),od(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ll]||(e[ll]=!0,od("selectionchange",!1,e))}}function Qx(t,e,r,n){switch(Px(e)){case 1:var s=E1;break;case 4:s=j1;break;default:s=wm}r=s.bind(null,e,r,t),s=void 0,!Gd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function ld(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var c=n.stateNode.containerInfo;if(c===s||c.nodeType===8&&c.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;c!==null;){if(o=rs(c),o===null)return;if(u=o.tag,u===5||u===6){n=i=o;continue e}c=c.parentNode}}n=n.return}xx(function(){var d=i,f=pm(r),m=[];e:{var v=Gx.get(t);if(v!==void 0){var y=_m,j=t;switch(t){case"keypress":if(jl(r)===0)break e;case"keydown":case"keyup":y=$1;break;case"focusin":j="focus",y=td;break;case"focusout":j="blur",y=td;break;case"beforeblur":case"afterblur":y=td;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Np;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=A1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=q1;break;case Bx:case qx:case Hx:y=P1;break;case Wx:y=W1;break;case"scroll":y=T1;break;case"wheel":y=K1;break;case"copy":case"cut":case"paste":y=D1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=jp}var A=(e&4)!==0,R=!A&&t==="scroll",_=A?v!==null?v+"Capture":null:v;A=[];for(var N=d,I;N!==null;){I=N;var P=I.stateNode;if(I.tag===5&&P!==null&&(I=P,_!==null&&(P=Oa(N,_),P!=null&&A.push(qa(N,P,I)))),R)break;N=N.return}0<A.length&&(v=new y(v,j,null,r,f),m.push({event:v,listeners:A}))}}if(!(e&7)){e:{if(v=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",v&&r!==Hd&&(j=r.relatedTarget||r.fromElement)&&(rs(j)||j[Hr]))break e;if((y||v)&&(v=f.window===f?f:(v=f.ownerDocument)?v.defaultView||v.parentWindow:window,y?(j=r.relatedTarget||r.toElement,y=d,j=j?rs(j):null,j!==null&&(R=ks(j),j!==R||j.tag!==5&&j.tag!==6)&&(j=null)):(y=null,j=d),y!==j)){if(A=Np,P="onMouseLeave",_="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(A=jp,P="onPointerLeave",_="onPointerEnter",N="pointer"),R=y==null?v:qs(y),I=j==null?v:qs(j),v=new A(P,N+"leave",y,r,f),v.target=R,v.relatedTarget=I,P=null,rs(f)===d&&(A=new A(_,N+"enter",j,r,f),A.target=I,A.relatedTarget=R,P=A),R=P,y&&j)t:{for(A=y,_=j,N=0,I=A;I;I=Ds(I))N++;for(I=0,P=_;P;P=Ds(P))I++;for(;0<N-I;)A=Ds(A),N--;for(;0<I-N;)_=Ds(_),I--;for(;N--;){if(A===_||_!==null&&A===_.alternate)break t;A=Ds(A),_=Ds(_)}A=null}else A=null;y!==null&&Op(m,v,y,A,!1),j!==null&&R!==null&&Op(m,R,j,A,!0)}}e:{if(v=d?qs(d):window,y=v.nodeName&&v.nodeName.toLowerCase(),y==="select"||y==="input"&&v.type==="file")var O=tN;else if(Ap(v))if(Vx)O=iN;else{O=nN;var D=rN}else(y=v.nodeName)&&y.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(O=sN);if(O&&(O=O(t,d))){Ox(m,O,r,f);break e}D&&D(t,v,d),t==="focusout"&&(D=v._wrapperState)&&D.controlled&&v.type==="number"&&Ud(v,"number",v.value)}switch(D=d?qs(d):window,t){case"focusin":(Ap(D)||D.contentEditable==="true")&&(zs=D,Xd=d,Ea=null);break;case"focusout":Ea=Xd=zs=null;break;case"mousedown":Zd=!0;break;case"contextmenu":case"mouseup":case"dragend":Zd=!1,Dp(m,r,f);break;case"selectionchange":if(lN)break;case"keydown":case"keyup":Dp(m,r,f)}var w;if(Nm)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else $s?Mx(t,r)&&(x="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(x="onCompositionStart");x&&(Dx&&r.locale!=="ko"&&($s||x!=="onCompositionStart"?x==="onCompositionEnd"&&$s&&(w=Rx()):(bn=f,bm="value"in bn?bn.value:bn.textContent,$s=!0)),D=Yl(d,x),0<D.length&&(x=new Ep(x,t,null,r,f),m.push({event:x,listeners:D}),w?x.data=w:(w=Lx(r),w!==null&&(x.data=w)))),(w=Y1?J1(t,r):X1(t,r))&&(d=Yl(d,"onBeforeInput"),0<d.length&&(f=new Ep("onBeforeInput","beforeinput",null,r,f),m.push({event:f,listeners:d}),f.data=w))}Kx(m,e)})}function qa(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Yl(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Oa(t,r),i!=null&&n.unshift(qa(t,i,s)),i=Oa(t,e),i!=null&&n.push(qa(t,i,s))),t=t.return}return n}function Ds(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Op(t,e,r,n,s){for(var i=e._reactName,o=[];r!==null&&r!==n;){var c=r,u=c.alternate,d=c.stateNode;if(u!==null&&u===n)break;c.tag===5&&d!==null&&(c=d,s?(u=Oa(r,i),u!=null&&o.unshift(qa(r,u,c))):s||(u=Oa(r,i),u!=null&&o.push(qa(r,u,c)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var hN=/\r\n?/g,mN=/\u0000|\uFFFD/g;function Vp(t){return(typeof t=="string"?t:""+t).replace(hN,`
`).replace(mN,"")}function cl(t,e,r){if(e=Vp(e),Vp(t)!==e&&r)throw Error(z(425))}function Jl(){}var eh=null,th=null;function rh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var nh=typeof setTimeout=="function"?setTimeout:void 0,fN=typeof clearTimeout=="function"?clearTimeout:void 0,Fp=typeof Promise=="function"?Promise:void 0,gN=typeof queueMicrotask=="function"?queueMicrotask:typeof Fp<"u"?function(t){return Fp.resolve(null).then(t).catch(pN)}:nh;function pN(t){setTimeout(function(){throw t})}function cd(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),Ua(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);Ua(e)}function Sn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Up(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Pi=Math.random().toString(36).slice(2),yr="__reactFiber$"+Pi,Ha="__reactProps$"+Pi,Hr="__reactContainer$"+Pi,sh="__reactEvents$"+Pi,yN="__reactListeners$"+Pi,xN="__reactHandles$"+Pi;function rs(t){var e=t[yr];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Hr]||r[yr]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Up(t);t!==null;){if(r=t[yr])return r;t=Up(t)}return e}t=r,r=t.parentNode}return null}function go(t){return t=t[yr]||t[Hr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function qs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(z(33))}function Uc(t){return t[Ha]||null}var ih=[],Hs=-1;function qn(t){return{current:t}}function je(t){0>Hs||(t.current=ih[Hs],ih[Hs]=null,Hs--)}function _e(t,e){Hs++,ih[Hs]=t.current,t.current=e}var Fn={},bt=qn(Fn),Dt=qn(!1),us=Fn;function ui(t,e){var r=t.type.contextTypes;if(!r)return Fn;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Mt(t){return t=t.childContextTypes,t!=null}function Xl(){je(Dt),je(bt)}function $p(t,e,r){if(bt.current!==Fn)throw Error(z(168));_e(bt,e),_e(Dt,r)}function Yx(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(z(108,r1(t)||"Unknown",s));return Pe({},r,n)}function Zl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Fn,us=bt.current,_e(bt,t),_e(Dt,Dt.current),!0}function zp(t,e,r){var n=t.stateNode;if(!n)throw Error(z(169));r?(t=Yx(t,e,us),n.__reactInternalMemoizedMergedChildContext=t,je(Dt),je(bt),_e(bt,t)):je(Dt),_e(Dt,r)}var Mr=null,$c=!1,ud=!1;function Jx(t){Mr===null?Mr=[t]:Mr.push(t)}function vN(t){$c=!0,Jx(t)}function Hn(){if(!ud&&Mr!==null){ud=!0;var t=0,e=pe;try{var r=Mr;for(pe=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Mr=null,$c=!1}catch(s){throw Mr!==null&&(Mr=Mr.slice(t+1)),_x(ym,Hn),s}finally{pe=e,ud=!1}}return null}var Ws=[],Gs=0,ec=null,tc=0,Jt=[],Xt=0,ds=null,Lr=1,Or="";function Xn(t,e){Ws[Gs++]=tc,Ws[Gs++]=ec,ec=t,tc=e}function Xx(t,e,r){Jt[Xt++]=Lr,Jt[Xt++]=Or,Jt[Xt++]=ds,ds=t;var n=Lr;t=Or;var s=32-lr(n)-1;n&=~(1<<s),r+=1;var i=32-lr(e)+s;if(30<i){var o=s-s%5;i=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Lr=1<<32-lr(e)+s|r<<s|n,Or=i+t}else Lr=1<<i|r<<s|n,Or=t}function jm(t){t.return!==null&&(Xn(t,1),Xx(t,1,0))}function Tm(t){for(;t===ec;)ec=Ws[--Gs],Ws[Gs]=null,tc=Ws[--Gs],Ws[Gs]=null;for(;t===ds;)ds=Jt[--Xt],Jt[Xt]=null,Or=Jt[--Xt],Jt[Xt]=null,Lr=Jt[--Xt],Jt[Xt]=null}var Wt=null,qt=null,Se=!1,or=null;function Zx(t,e){var r=Zt(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Bp(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wt=t,qt=Sn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wt=t,qt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=ds!==null?{id:Lr,overflow:Or}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Zt(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Wt=t,qt=null,!0):!1;default:return!1}}function ah(t){return(t.mode&1)!==0&&(t.flags&128)===0}function oh(t){if(Se){var e=qt;if(e){var r=e;if(!Bp(t,e)){if(ah(t))throw Error(z(418));e=Sn(r.nextSibling);var n=Wt;e&&Bp(t,e)?Zx(n,r):(t.flags=t.flags&-4097|2,Se=!1,Wt=t)}}else{if(ah(t))throw Error(z(418));t.flags=t.flags&-4097|2,Se=!1,Wt=t}}}function qp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wt=t}function ul(t){if(t!==Wt)return!1;if(!Se)return qp(t),Se=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rh(t.type,t.memoizedProps)),e&&(e=qt)){if(ah(t))throw ev(),Error(z(418));for(;e;)Zx(t,e),e=Sn(e.nextSibling)}if(qp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){qt=Sn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}qt=null}}else qt=Wt?Sn(t.stateNode.nextSibling):null;return!0}function ev(){for(var t=qt;t;)t=Sn(t.nextSibling)}function di(){qt=Wt=null,Se=!1}function Sm(t){or===null?or=[t]:or.push(t)}var wN=en.ReactCurrentBatchConfig;function oa(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(z(309));var n=r.stateNode}if(!n)throw Error(z(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var c=s.refs;o===null?delete c[i]:c[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(z(284));if(!r._owner)throw Error(z(290,t))}return t}function dl(t,e){throw t=Object.prototype.toString.call(e),Error(z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Hp(t){var e=t._init;return e(t._payload)}function tv(t){function e(_,N){if(t){var I=_.deletions;I===null?(_.deletions=[N],_.flags|=16):I.push(N)}}function r(_,N){if(!t)return null;for(;N!==null;)e(_,N),N=N.sibling;return null}function n(_,N){for(_=new Map;N!==null;)N.key!==null?_.set(N.key,N):_.set(N.index,N),N=N.sibling;return _}function s(_,N){return _=Pn(_,N),_.index=0,_.sibling=null,_}function i(_,N,I){return _.index=I,t?(I=_.alternate,I!==null?(I=I.index,I<N?(_.flags|=2,N):I):(_.flags|=2,N)):(_.flags|=1048576,N)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function c(_,N,I,P){return N===null||N.tag!==6?(N=yd(I,_.mode,P),N.return=_,N):(N=s(N,I),N.return=_,N)}function u(_,N,I,P){var O=I.type;return O===Us?f(_,N,I.props.children,P,I.key):N!==null&&(N.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===mn&&Hp(O)===N.type)?(P=s(N,I.props),P.ref=oa(_,N,I),P.return=_,P):(P=Rl(I.type,I.key,I.props,null,_.mode,P),P.ref=oa(_,N,I),P.return=_,P)}function d(_,N,I,P){return N===null||N.tag!==4||N.stateNode.containerInfo!==I.containerInfo||N.stateNode.implementation!==I.implementation?(N=xd(I,_.mode,P),N.return=_,N):(N=s(N,I.children||[]),N.return=_,N)}function f(_,N,I,P,O){return N===null||N.tag!==7?(N=ls(I,_.mode,P,O),N.return=_,N):(N=s(N,I),N.return=_,N)}function m(_,N,I){if(typeof N=="string"&&N!==""||typeof N=="number")return N=yd(""+N,_.mode,I),N.return=_,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case el:return I=Rl(N.type,N.key,N.props,null,_.mode,I),I.ref=oa(_,null,N),I.return=_,I;case Fs:return N=xd(N,_.mode,I),N.return=_,N;case mn:var P=N._init;return m(_,P(N._payload),I)}if(ha(N)||ra(N))return N=ls(N,_.mode,I,null),N.return=_,N;dl(_,N)}return null}function v(_,N,I,P){var O=N!==null?N.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return O!==null?null:c(_,N,""+I,P);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case el:return I.key===O?u(_,N,I,P):null;case Fs:return I.key===O?d(_,N,I,P):null;case mn:return O=I._init,v(_,N,O(I._payload),P)}if(ha(I)||ra(I))return O!==null?null:f(_,N,I,P,null);dl(_,I)}return null}function y(_,N,I,P,O){if(typeof P=="string"&&P!==""||typeof P=="number")return _=_.get(I)||null,c(N,_,""+P,O);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case el:return _=_.get(P.key===null?I:P.key)||null,u(N,_,P,O);case Fs:return _=_.get(P.key===null?I:P.key)||null,d(N,_,P,O);case mn:var D=P._init;return y(_,N,I,D(P._payload),O)}if(ha(P)||ra(P))return _=_.get(I)||null,f(N,_,P,O,null);dl(N,P)}return null}function j(_,N,I,P){for(var O=null,D=null,w=N,x=N=0,g=null;w!==null&&x<I.length;x++){w.index>x?(g=w,w=null):g=w.sibling;var k=v(_,w,I[x],P);if(k===null){w===null&&(w=g);break}t&&w&&k.alternate===null&&e(_,w),N=i(k,N,x),D===null?O=k:D.sibling=k,D=k,w=g}if(x===I.length)return r(_,w),Se&&Xn(_,x),O;if(w===null){for(;x<I.length;x++)w=m(_,I[x],P),w!==null&&(N=i(w,N,x),D===null?O=w:D.sibling=w,D=w);return Se&&Xn(_,x),O}for(w=n(_,w);x<I.length;x++)g=y(w,_,x,I[x],P),g!==null&&(t&&g.alternate!==null&&w.delete(g.key===null?x:g.key),N=i(g,N,x),D===null?O=g:D.sibling=g,D=g);return t&&w.forEach(function(b){return e(_,b)}),Se&&Xn(_,x),O}function A(_,N,I,P){var O=ra(I);if(typeof O!="function")throw Error(z(150));if(I=O.call(I),I==null)throw Error(z(151));for(var D=O=null,w=N,x=N=0,g=null,k=I.next();w!==null&&!k.done;x++,k=I.next()){w.index>x?(g=w,w=null):g=w.sibling;var b=v(_,w,k.value,P);if(b===null){w===null&&(w=g);break}t&&w&&b.alternate===null&&e(_,w),N=i(b,N,x),D===null?O=b:D.sibling=b,D=b,w=g}if(k.done)return r(_,w),Se&&Xn(_,x),O;if(w===null){for(;!k.done;x++,k=I.next())k=m(_,k.value,P),k!==null&&(N=i(k,N,x),D===null?O=k:D.sibling=k,D=k);return Se&&Xn(_,x),O}for(w=n(_,w);!k.done;x++,k=I.next())k=y(w,_,x,k.value,P),k!==null&&(t&&k.alternate!==null&&w.delete(k.key===null?x:k.key),N=i(k,N,x),D===null?O=k:D.sibling=k,D=k);return t&&w.forEach(function(S){return e(_,S)}),Se&&Xn(_,x),O}function R(_,N,I,P){if(typeof I=="object"&&I!==null&&I.type===Us&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case el:e:{for(var O=I.key,D=N;D!==null;){if(D.key===O){if(O=I.type,O===Us){if(D.tag===7){r(_,D.sibling),N=s(D,I.props.children),N.return=_,_=N;break e}}else if(D.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===mn&&Hp(O)===D.type){r(_,D.sibling),N=s(D,I.props),N.ref=oa(_,D,I),N.return=_,_=N;break e}r(_,D);break}else e(_,D);D=D.sibling}I.type===Us?(N=ls(I.props.children,_.mode,P,I.key),N.return=_,_=N):(P=Rl(I.type,I.key,I.props,null,_.mode,P),P.ref=oa(_,N,I),P.return=_,_=P)}return o(_);case Fs:e:{for(D=I.key;N!==null;){if(N.key===D)if(N.tag===4&&N.stateNode.containerInfo===I.containerInfo&&N.stateNode.implementation===I.implementation){r(_,N.sibling),N=s(N,I.children||[]),N.return=_,_=N;break e}else{r(_,N);break}else e(_,N);N=N.sibling}N=xd(I,_.mode,P),N.return=_,_=N}return o(_);case mn:return D=I._init,R(_,N,D(I._payload),P)}if(ha(I))return j(_,N,I,P);if(ra(I))return A(_,N,I,P);dl(_,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,N!==null&&N.tag===6?(r(_,N.sibling),N=s(N,I),N.return=_,_=N):(r(_,N),N=yd(I,_.mode,P),N.return=_,_=N),o(_)):r(_,N)}return R}var hi=tv(!0),rv=tv(!1),rc=qn(null),nc=null,Ks=null,Am=null;function Im(){Am=Ks=nc=null}function Cm(t){var e=rc.current;je(rc),t._currentValue=e}function lh(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function ni(t,e){nc=t,Am=Ks=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Rt=!0),t.firstContext=null)}function tr(t){var e=t._currentValue;if(Am!==t)if(t={context:t,memoizedValue:e,next:null},Ks===null){if(nc===null)throw Error(z(308));Ks=t,nc.dependencies={lanes:0,firstContext:t}}else Ks=Ks.next=t;return e}var ns=null;function Pm(t){ns===null?ns=[t]:ns.push(t)}function nv(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Pm(e)):(r.next=s.next,s.next=r),e.interleaved=r,Wr(t,n)}function Wr(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var fn=!1;function Rm(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function $r(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function An(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,he&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Wr(t,r)}return s=n.interleaved,s===null?(e.next=e,Pm(n)):(e.next=s.next,s.next=e),n.interleaved=e,Wr(t,r)}function Tl(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,xm(t,r)}}function Wp(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function sc(t,e,r,n){var s=t.updateQueue;fn=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,c=s.shared.pending;if(c!==null){s.shared.pending=null;var u=c,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=t.alternate;f!==null&&(f=f.updateQueue,c=f.lastBaseUpdate,c!==o&&(c===null?f.firstBaseUpdate=d:c.next=d,f.lastBaseUpdate=u))}if(i!==null){var m=s.baseState;o=0,f=d=u=null,c=i;do{var v=c.lane,y=c.eventTime;if((n&v)===v){f!==null&&(f=f.next={eventTime:y,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var j=t,A=c;switch(v=e,y=r,A.tag){case 1:if(j=A.payload,typeof j=="function"){m=j.call(y,m,v);break e}m=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=A.payload,v=typeof j=="function"?j.call(y,m,v):j,v==null)break e;m=Pe({},m,v);break e;case 2:fn=!0}}c.callback!==null&&c.lane!==0&&(t.flags|=64,v=s.effects,v===null?s.effects=[c]:v.push(c))}else y={eventTime:y,lane:v,tag:c.tag,payload:c.payload,callback:c.callback,next:null},f===null?(d=f=y,u=m):f=f.next=y,o|=v;if(c=c.next,c===null){if(c=s.shared.pending,c===null)break;v=c,c=v.next,v.next=null,s.lastBaseUpdate=v,s.shared.pending=null}}while(!0);if(f===null&&(u=m),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ms|=o,t.lanes=o,t.memoizedState=m}}function Gp(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(z(191,s));s.call(n)}}}var po={},br=qn(po),Wa=qn(po),Ga=qn(po);function ss(t){if(t===po)throw Error(z(174));return t}function Dm(t,e){switch(_e(Ga,e),_e(Wa,t),_e(br,po),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zd(e,t)}je(br),_e(br,e)}function mi(){je(br),je(Wa),je(Ga)}function iv(t){ss(Ga.current);var e=ss(br.current),r=zd(e,t.type);e!==r&&(_e(Wa,t),_e(br,r))}function Mm(t){Wa.current===t&&(je(br),je(Wa))}var Ae=qn(0);function ic(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var dd=[];function Lm(){for(var t=0;t<dd.length;t++)dd[t]._workInProgressVersionPrimary=null;dd.length=0}var Sl=en.ReactCurrentDispatcher,hd=en.ReactCurrentBatchConfig,hs=0,Ie=null,Qe=null,Xe=null,ac=!1,ja=!1,Ka=0,bN=0;function mt(){throw Error(z(321))}function Om(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!dr(t[r],e[r]))return!1;return!0}function Vm(t,e,r,n,s,i){if(hs=i,Ie=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Sl.current=t===null||t.memoizedState===null?EN:jN,t=r(n,s),ja){i=0;do{if(ja=!1,Ka=0,25<=i)throw Error(z(301));i+=1,Xe=Qe=null,e.updateQueue=null,Sl.current=TN,t=r(n,s)}while(ja)}if(Sl.current=oc,e=Qe!==null&&Qe.next!==null,hs=0,Xe=Qe=Ie=null,ac=!1,e)throw Error(z(300));return t}function Fm(){var t=Ka!==0;return Ka=0,t}function pr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Ie.memoizedState=Xe=t:Xe=Xe.next=t,Xe}function rr(){if(Qe===null){var t=Ie.alternate;t=t!==null?t.memoizedState:null}else t=Qe.next;var e=Xe===null?Ie.memoizedState:Xe.next;if(e!==null)Xe=e,Qe=t;else{if(t===null)throw Error(z(310));Qe=t,t={memoizedState:Qe.memoizedState,baseState:Qe.baseState,baseQueue:Qe.baseQueue,queue:Qe.queue,next:null},Xe===null?Ie.memoizedState=Xe=t:Xe=Xe.next=t}return Xe}function Qa(t,e){return typeof e=="function"?e(t):e}function md(t){var e=rr(),r=e.queue;if(r===null)throw Error(z(311));r.lastRenderedReducer=t;var n=Qe,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var c=o=null,u=null,d=i;do{var f=d.lane;if((hs&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=m,o=n):u=u.next=m,Ie.lanes|=f,ms|=f}d=d.next}while(d!==null&&d!==i);u===null?o=n:u.next=c,dr(n,e.memoizedState)||(Rt=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,Ie.lanes|=i,ms|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function fd(t){var e=rr(),r=e.queue;if(r===null)throw Error(z(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);dr(i,e.memoizedState)||(Rt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function av(){}function ov(t,e){var r=Ie,n=rr(),s=e(),i=!dr(n.memoizedState,s);if(i&&(n.memoizedState=s,Rt=!0),n=n.queue,Um(uv.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||Xe!==null&&Xe.memoizedState.tag&1){if(r.flags|=2048,Ya(9,cv.bind(null,r,n,s,e),void 0,null),Ze===null)throw Error(z(349));hs&30||lv(r,e,s)}return s}function lv(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Ie.updateQueue,e===null?(e={lastEffect:null,stores:null},Ie.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function cv(t,e,r,n){e.value=r,e.getSnapshot=n,dv(e)&&hv(t)}function uv(t,e,r){return r(function(){dv(e)&&hv(t)})}function dv(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!dr(t,r)}catch{return!0}}function hv(t){var e=Wr(t,1);e!==null&&cr(e,t,1,-1)}function Kp(t){var e=pr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qa,lastRenderedState:t},e.queue=t,t=t.dispatch=NN.bind(null,Ie,t),[e.memoizedState,t]}function Ya(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=Ie.updateQueue,e===null?(e={lastEffect:null,stores:null},Ie.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function mv(){return rr().memoizedState}function Al(t,e,r,n){var s=pr();Ie.flags|=t,s.memoizedState=Ya(1|e,r,void 0,n===void 0?null:n)}function zc(t,e,r,n){var s=rr();n=n===void 0?null:n;var i=void 0;if(Qe!==null){var o=Qe.memoizedState;if(i=o.destroy,n!==null&&Om(n,o.deps)){s.memoizedState=Ya(e,r,i,n);return}}Ie.flags|=t,s.memoizedState=Ya(1|e,r,i,n)}function Qp(t,e){return Al(8390656,8,t,e)}function Um(t,e){return zc(2048,8,t,e)}function fv(t,e){return zc(4,2,t,e)}function gv(t,e){return zc(4,4,t,e)}function pv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yv(t,e,r){return r=r!=null?r.concat([t]):null,zc(4,4,pv.bind(null,e,t),r)}function $m(){}function xv(t,e){var r=rr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Om(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function vv(t,e){var r=rr();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Om(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function wv(t,e,r){return hs&21?(dr(r,e)||(r=Ex(),Ie.lanes|=r,ms|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Rt=!0),t.memoizedState=r)}function _N(t,e){var r=pe;pe=r!==0&&4>r?r:4,t(!0);var n=hd.transition;hd.transition={};try{t(!1),e()}finally{pe=r,hd.transition=n}}function bv(){return rr().memoizedState}function kN(t,e,r){var n=Cn(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},_v(t))kv(e,r);else if(r=nv(t,e,r,n),r!==null){var s=Tt();cr(r,t,n,s),Nv(r,e,n)}}function NN(t,e,r){var n=Cn(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(_v(t))kv(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,c=i(o,r);if(s.hasEagerState=!0,s.eagerState=c,dr(c,o)){var u=e.interleaved;u===null?(s.next=s,Pm(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}r=nv(t,e,s,n),r!==null&&(s=Tt(),cr(r,t,n,s),Nv(r,e,n))}}function _v(t){var e=t.alternate;return t===Ie||e!==null&&e===Ie}function kv(t,e){ja=ac=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function Nv(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,xm(t,r)}}var oc={readContext:tr,useCallback:mt,useContext:mt,useEffect:mt,useImperativeHandle:mt,useInsertionEffect:mt,useLayoutEffect:mt,useMemo:mt,useReducer:mt,useRef:mt,useState:mt,useDebugValue:mt,useDeferredValue:mt,useTransition:mt,useMutableSource:mt,useSyncExternalStore:mt,useId:mt,unstable_isNewReconciler:!1},EN={readContext:tr,useCallback:function(t,e){return pr().memoizedState=[t,e===void 0?null:e],t},useContext:tr,useEffect:Qp,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Al(4194308,4,pv.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Al(4194308,4,t,e)},useInsertionEffect:function(t,e){return Al(4,2,t,e)},useMemo:function(t,e){var r=pr();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=pr();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=kN.bind(null,Ie,t),[n.memoizedState,t]},useRef:function(t){var e=pr();return t={current:t},e.memoizedState=t},useState:Kp,useDebugValue:$m,useDeferredValue:function(t){return pr().memoizedState=t},useTransition:function(){var t=Kp(!1),e=t[0];return t=_N.bind(null,t[1]),pr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=Ie,s=pr();if(Se){if(r===void 0)throw Error(z(407));r=r()}else{if(r=e(),Ze===null)throw Error(z(349));hs&30||lv(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,Qp(uv.bind(null,n,i,t),[t]),n.flags|=2048,Ya(9,cv.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=pr(),e=Ze.identifierPrefix;if(Se){var r=Or,n=Lr;r=(n&~(1<<32-lr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=Ka++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=bN++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jN={readContext:tr,useCallback:xv,useContext:tr,useEffect:Um,useImperativeHandle:yv,useInsertionEffect:fv,useLayoutEffect:gv,useMemo:vv,useReducer:md,useRef:mv,useState:function(){return md(Qa)},useDebugValue:$m,useDeferredValue:function(t){var e=rr();return wv(e,Qe.memoizedState,t)},useTransition:function(){var t=md(Qa)[0],e=rr().memoizedState;return[t,e]},useMutableSource:av,useSyncExternalStore:ov,useId:bv,unstable_isNewReconciler:!1},TN={readContext:tr,useCallback:xv,useContext:tr,useEffect:Um,useImperativeHandle:yv,useInsertionEffect:fv,useLayoutEffect:gv,useMemo:vv,useReducer:fd,useRef:mv,useState:function(){return fd(Qa)},useDebugValue:$m,useDeferredValue:function(t){var e=rr();return Qe===null?e.memoizedState=t:wv(e,Qe.memoizedState,t)},useTransition:function(){var t=fd(Qa)[0],e=rr().memoizedState;return[t,e]},useMutableSource:av,useSyncExternalStore:ov,useId:bv,unstable_isNewReconciler:!1};function ir(t,e){if(t&&t.defaultProps){e=Pe({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ch(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:Pe({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Bc={isMounted:function(t){return(t=t._reactInternals)?ks(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Tt(),s=Cn(t),i=$r(n,s);i.payload=e,r!=null&&(i.callback=r),e=An(t,i,s),e!==null&&(cr(e,t,s,n),Tl(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Tt(),s=Cn(t),i=$r(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=An(t,i,s),e!==null&&(cr(e,t,s,n),Tl(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Tt(),n=Cn(t),s=$r(r,n);s.tag=2,e!=null&&(s.callback=e),e=An(t,s,n),e!==null&&(cr(e,t,n,r),Tl(e,t,n))}};function Yp(t,e,r,n,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,o):e.prototype&&e.prototype.isPureReactComponent?!za(r,n)||!za(s,i):!0}function Ev(t,e,r){var n=!1,s=Fn,i=e.contextType;return typeof i=="object"&&i!==null?i=tr(i):(s=Mt(e)?us:bt.current,n=e.contextTypes,i=(n=n!=null)?ui(t,s):Fn),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Jp(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Bc.enqueueReplaceState(e,e.state,null)}function uh(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Rm(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=tr(i):(i=Mt(e)?us:bt.current,s.context=ui(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ch(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Bc.enqueueReplaceState(s,s.state,null),sc(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fi(t,e){try{var r="",n=e;do r+=t1(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function gd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function dh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var SN=typeof WeakMap=="function"?WeakMap:Map;function jv(t,e,r){r=$r(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){cc||(cc=!0,bh=n),dh(t,e)},r}function Tv(t,e,r){r=$r(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){dh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){dh(t,e),typeof n!="function"&&(In===null?In=new Set([this]):In.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function Xp(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new SN;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=zN.bind(null,t,e,r),e.then(t,t))}function Zp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function e0(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=$r(-1,1),e.tag=2,An(r,e,1))),r.lanes|=1),t)}var AN=en.ReactCurrentOwner,Rt=!1;function Et(t,e,r,n){e.child=t===null?rv(e,null,r,n):hi(e,t.child,r,n)}function t0(t,e,r,n,s){r=r.render;var i=e.ref;return ni(e,s),n=Vm(t,e,r,n,i,s),r=Fm(),t!==null&&!Rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gr(t,e,s)):(Se&&r&&jm(e),e.flags|=1,Et(t,e,n,s),e.child)}function r0(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!Qm(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,Sv(t,e,i,n,s)):(t=Rl(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:za,r(o,n)&&t.ref===e.ref)return Gr(t,e,s)}return e.flags|=1,t=Pn(i,n),t.ref=e.ref,t.return=e,e.child=t}function Sv(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(za(i,n)&&t.ref===e.ref)if(Rt=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(Rt=!0);else return e.lanes=t.lanes,Gr(t,e,s)}return hh(t,e,r,n,s)}function Av(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},_e(Ys,Bt),Bt|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,_e(Ys,Bt),Bt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,_e(Ys,Bt),Bt|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,_e(Ys,Bt),Bt|=n;return Et(t,e,s,r),e.child}function Iv(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function hh(t,e,r,n,s){var i=Mt(r)?us:bt.current;return i=ui(e,i),ni(e,s),r=Vm(t,e,r,n,i,s),n=Fm(),t!==null&&!Rt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Gr(t,e,s)):(Se&&n&&jm(e),e.flags|=1,Et(t,e,r,s),e.child)}function n0(t,e,r,n,s){if(Mt(r)){var i=!0;Zl(e)}else i=!1;if(ni(e,s),e.stateNode===null)Il(t,e),Ev(e,r,n),uh(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,c=e.memoizedProps;o.props=c;var u=o.context,d=r.contextType;typeof d=="object"&&d!==null?d=tr(d):(d=Mt(r)?us:bt.current,d=ui(e,d));var f=r.getDerivedStateFromProps,m=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==n||u!==d)&&Jp(e,o,n,d),fn=!1;var v=e.memoizedState;o.state=v,sc(e,n,o,s),u=e.memoizedState,c!==n||v!==u||Dt.current||fn?(typeof f=="function"&&(ch(e,r,f,n),u=e.memoizedState),(c=fn||Yp(e,r,c,n,v,u,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=u),o.props=n,o.state=u,o.context=d,n=c):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,sv(t,e),c=e.memoizedProps,d=e.type===e.elementType?c:ir(e.type,c),o.props=d,m=e.pendingProps,v=o.context,u=r.contextType,typeof u=="object"&&u!==null?u=tr(u):(u=Mt(r)?us:bt.current,u=ui(e,u));var y=r.getDerivedStateFromProps;(f=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==m||v!==u)&&Jp(e,o,n,u),fn=!1,v=e.memoizedState,o.state=v,sc(e,n,o,s);var j=e.memoizedState;c!==m||v!==j||Dt.current||fn?(typeof y=="function"&&(ch(e,r,y,n),j=e.memoizedState),(d=fn||Yp(e,r,d,n,v,j,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,j,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,j,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=j),o.props=n,o.state=j,o.context=u,n=d):(typeof o.componentDidUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===t.memoizedProps&&v===t.memoizedState||(e.flags|=1024),n=!1)}return mh(t,e,r,n,i,s)}function mh(t,e,r,n,s,i){Iv(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&zp(e,r,!1),Gr(t,e,i);n=e.stateNode,AN.current=e;var c=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=hi(e,t.child,null,i),e.child=hi(e,null,c,i)):Et(t,e,c,i),e.memoizedState=n.state,s&&zp(e,r,!0),e.child}function Cv(t){var e=t.stateNode;e.pendingContext?$p(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$p(t,e.context,!1),Dm(t,e.containerInfo)}function s0(t,e,r,n,s){return di(),Sm(s),e.flags|=256,Et(t,e,r,n),e.child}var fh={dehydrated:null,treeContext:null,retryLane:0};function gh(t){return{baseLanes:t,cachePool:null,transitions:null}}function Pv(t,e,r){var n=e.pendingProps,s=Ae.current,i=!1,o=(e.flags&128)!==0,c;if((c=o)||(c=t!==null&&t.memoizedState===null?!1:(s&2)!==0),c?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),_e(Ae,s&1),t===null)return oh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,i?(n=e.mode,i=e.child,o={mode:"hidden",children:o},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Wc(o,n,0,null),t=ls(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=gh(r),e.memoizedState=fh,t):zm(e,o));if(s=t.memoizedState,s!==null&&(c=s.dehydrated,c!==null))return IN(t,e,o,n,c,s,r);if(i){i=n.fallback,o=e.mode,s=t.child,c=s.sibling;var u={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=u,e.deletions=null):(n=Pn(s,u),n.subtreeFlags=s.subtreeFlags&14680064),c!==null?i=Pn(c,i):(i=ls(i,o,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,o=t.child.memoizedState,o=o===null?gh(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~r,e.memoizedState=fh,n}return i=t.child,t=i.sibling,n=Pn(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function zm(t,e){return e=Wc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hl(t,e,r,n){return n!==null&&Sm(n),hi(e,t.child,null,r),t=zm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function IN(t,e,r,n,s,i,o){if(r)return e.flags&256?(e.flags&=-257,n=gd(Error(z(422))),hl(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Wc({mode:"visible",children:n.children},s,0,null),i=ls(i,s,o,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&hi(e,t.child,null,o),e.child.memoizedState=gh(o),e.memoizedState=fh,i);if(!(e.mode&1))return hl(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var c=n.dgst;return n=c,i=Error(z(419)),n=gd(i,n,void 0),hl(t,e,o,n)}if(c=(o&t.childLanes)!==0,Rt||c){if(n=Ze,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Wr(t,s),cr(n,t,s,-1))}return Km(),n=gd(Error(z(421))),hl(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=BN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,qt=Sn(s.nextSibling),Wt=e,Se=!0,or=null,t!==null&&(Jt[Xt++]=Lr,Jt[Xt++]=Or,Jt[Xt++]=ds,Lr=t.id,Or=t.overflow,ds=e),e=zm(e,n.children),e.flags|=4096,e)}function i0(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),lh(t.return,e,r)}function pd(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function Rv(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Et(t,e,n.children,r),n=Ae.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&i0(t,r,e);else if(t.tag===19)i0(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(_e(Ae,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&ic(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),pd(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ic(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}pd(e,!0,r,null,i);break;case"together":pd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Il(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Gr(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),ms|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(z(153));if(e.child!==null){for(t=e.child,r=Pn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Pn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function CN(t,e,r){switch(e.tag){case 3:Cv(e),di();break;case 5:iv(e);break;case 1:Mt(e.type)&&Zl(e);break;case 4:Dm(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;_e(rc,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(_e(Ae,Ae.current&1),e.flags|=128,null):r&e.child.childLanes?Pv(t,e,r):(_e(Ae,Ae.current&1),t=Gr(t,e,r),t!==null?t.sibling:null);_e(Ae,Ae.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Rv(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),_e(Ae,Ae.current),n)break;return null;case 22:case 23:return e.lanes=0,Av(t,e,r)}return Gr(t,e,r)}var Dv,ph,Mv,Lv;Dv=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};ph=function(){};Mv=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,ss(br.current);var i=null;switch(r){case"input":s=Vd(t,s),n=Vd(t,n),i=[];break;case"select":s=Pe({},s,{value:void 0}),n=Pe({},n,{value:void 0}),i=[];break;case"textarea":s=$d(t,s),n=$d(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Jl)}Bd(r,n);var o;r=null;for(d in s)if(!n.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var c=s[d];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ma.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in n){var u=n[d];if(c=s!=null?s[d]:void 0,n.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(o in c)!c.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in u)u.hasOwnProperty(o)&&c[o]!==u[o]&&(r||(r={}),r[o]=u[o])}else r||(i||(i=[]),i.push(d,r)),r=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ma.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ne("scroll",t),i||c===u||(i=[])):(i=i||[]).push(d,u))}r&&(i=i||[]).push("style",r);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Lv=function(t,e,r,n){r!==n&&(e.flags|=4)};function la(t,e){if(!Se)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function PN(t,e,r){var n=e.pendingProps;switch(Tm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ft(e),null;case 1:return Mt(e.type)&&Xl(),ft(e),null;case 3:return n=e.stateNode,mi(),je(Dt),je(bt),Lm(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(ul(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,or!==null&&(Nh(or),or=null))),ph(t,e),ft(e),null;case 5:Mm(e);var s=ss(Ga.current);if(r=e.type,t!==null&&e.stateNode!=null)Mv(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(z(166));return ft(e),null}if(t=ss(br.current),ul(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[yr]=e,n[Ha]=i,t=(e.mode&1)!==0,r){case"dialog":Ne("cancel",n),Ne("close",n);break;case"iframe":case"object":case"embed":Ne("load",n);break;case"video":case"audio":for(s=0;s<fa.length;s++)Ne(fa[s],n);break;case"source":Ne("error",n);break;case"img":case"image":case"link":Ne("error",n),Ne("load",n);break;case"details":Ne("toggle",n);break;case"input":fp(n,i),Ne("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Ne("invalid",n);break;case"textarea":pp(n,i),Ne("invalid",n)}Bd(r,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?n.textContent!==c&&(i.suppressHydrationWarning!==!0&&cl(n.textContent,c,t),s=["children",c]):typeof c=="number"&&n.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&cl(n.textContent,c,t),s=["children",""+c]):Ma.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&Ne("scroll",n)}switch(r){case"input":tl(n),gp(n,i,!0);break;case"textarea":tl(n),yp(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=Jl)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ux(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[yr]=e,t[Ha]=n,Dv(t,e,!1,!1),e.stateNode=t;e:{switch(o=qd(r,n),r){case"dialog":Ne("cancel",t),Ne("close",t),s=n;break;case"iframe":case"object":case"embed":Ne("load",t),s=n;break;case"video":case"audio":for(s=0;s<fa.length;s++)Ne(fa[s],t);s=n;break;case"source":Ne("error",t),s=n;break;case"img":case"image":case"link":Ne("error",t),Ne("load",t),s=n;break;case"details":Ne("toggle",t),s=n;break;case"input":fp(t,n),s=Vd(t,n),Ne("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=Pe({},n,{value:void 0}),Ne("invalid",t);break;case"textarea":pp(t,n),s=$d(t,n),Ne("invalid",t);break;default:s=n}Bd(r,s),c=s;for(i in c)if(c.hasOwnProperty(i)){var u=c[i];i==="style"?mx(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&dx(t,u)):i==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&La(t,u):typeof u=="number"&&La(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ma.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ne("scroll",t):u!=null&&hm(t,i,u,o))}switch(r){case"input":tl(t),gp(t,n,!1);break;case"textarea":tl(t),yp(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Vn(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Zs(t,!!n.multiple,i,!1):n.defaultValue!=null&&Zs(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Jl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ft(e),null;case 6:if(t&&e.stateNode!=null)Lv(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(z(166));if(r=ss(Ga.current),ss(br.current),ul(e)){if(n=e.stateNode,r=e.memoizedProps,n[yr]=e,(i=n.nodeValue!==r)&&(t=Wt,t!==null))switch(t.tag){case 3:cl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cl(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[yr]=e,e.stateNode=n}return ft(e),null;case 13:if(je(Ae),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Se&&qt!==null&&e.mode&1&&!(e.flags&128))ev(),di(),e.flags|=98560,i=!1;else if(i=ul(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(z(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(z(317));i[yr]=e}else di(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ft(e),i=!1}else or!==null&&(Nh(or),or=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ae.current&1?Ye===0&&(Ye=3):Km())),e.updateQueue!==null&&(e.flags|=4),ft(e),null);case 4:return mi(),ph(t,e),t===null&&Ba(e.stateNode.containerInfo),ft(e),null;case 10:return Cm(e.type._context),ft(e),null;case 17:return Mt(e.type)&&Xl(),ft(e),null;case 19:if(je(Ae),i=e.memoizedState,i===null)return ft(e),null;if(n=(e.flags&128)!==0,o=i.rendering,o===null)if(n)la(i,!1);else{if(Ye!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ic(t),o!==null){for(e.flags|=128,la(i,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return _e(Ae,Ae.current&1|2),e.child}t=t.sibling}i.tail!==null&&ze()>gi&&(e.flags|=128,n=!0,la(i,!1),e.lanes=4194304)}else{if(!n)if(t=ic(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),la(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Se)return ft(e),null}else 2*ze()-i.renderingStartTime>gi&&r!==1073741824&&(e.flags|=128,n=!0,la(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(r=i.last,r!==null?r.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ze(),e.sibling=null,r=Ae.current,_e(Ae,n?r&1|2:r&1),e):(ft(e),null);case 22:case 23:return Gm(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Bt&1073741824&&(ft(e),e.subtreeFlags&6&&(e.flags|=8192)):ft(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function RN(t,e){switch(Tm(e),e.tag){case 1:return Mt(e.type)&&Xl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return mi(),je(Dt),je(bt),Lm(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mm(e),null;case 13:if(je(Ae),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(z(340));di()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(Ae),null;case 4:return mi(),null;case 10:return Cm(e.type._context),null;case 22:case 23:return Gm(),null;case 24:return null;default:return null}}var ml=!1,xt=!1,DN=typeof WeakSet=="function"?WeakSet:Set,G=null;function Qs(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Oe(t,e,n)}else r.current=null}function yh(t,e,r){try{r()}catch(n){Oe(t,e,n)}}var a0=!1;function MN(t,e){if(eh=Kl,t=$x(),Em(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,c=-1,u=-1,d=0,f=0,m=t,v=null;t:for(;;){for(var y;m!==r||s!==0&&m.nodeType!==3||(c=o+s),m!==i||n!==0&&m.nodeType!==3||(u=o+n),m.nodeType===3&&(o+=m.nodeValue.length),(y=m.firstChild)!==null;)v=m,m=y;for(;;){if(m===t)break t;if(v===r&&++d===s&&(c=o),v===i&&++f===n&&(u=o),(y=m.nextSibling)!==null)break;m=v,v=m.parentNode}m=y}r=c===-1||u===-1?null:{start:c,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(th={focusedElem:t,selectionRange:r},Kl=!1,G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var j=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var A=j.memoizedProps,R=j.memoizedState,_=e.stateNode,N=_.getSnapshotBeforeUpdate(e.elementType===e.type?A:ir(e.type,A),R);_.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(P){Oe(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return j=a0,a0=!1,j}function Ta(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&yh(e,r,i)}s=s.next}while(s!==n)}}function qc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function xh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function Ov(t){var e=t.alternate;e!==null&&(t.alternate=null,Ov(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[yr],delete e[Ha],delete e[sh],delete e[yN],delete e[xN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Vv(t){return t.tag===5||t.tag===3||t.tag===4}function o0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Vv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Jl));else if(n!==4&&(t=t.child,t!==null))for(vh(t,e,r),t=t.sibling;t!==null;)vh(t,e,r),t=t.sibling}function wh(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(wh(t,e,r),t=t.sibling;t!==null;)wh(t,e,r),t=t.sibling}var nt=null,ar=!1;function un(t,e,r){for(r=r.child;r!==null;)Fv(t,e,r),r=r.sibling}function Fv(t,e,r){if(wr&&typeof wr.onCommitFiberUnmount=="function")try{wr.onCommitFiberUnmount(Lc,r)}catch{}switch(r.tag){case 5:xt||Qs(r,e);case 6:var n=nt,s=ar;nt=null,un(t,e,r),nt=n,ar=s,nt!==null&&(ar?(t=nt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):nt.removeChild(r.stateNode));break;case 18:nt!==null&&(ar?(t=nt,r=r.stateNode,t.nodeType===8?cd(t.parentNode,r):t.nodeType===1&&cd(t,r),Ua(t)):cd(nt,r.stateNode));break;case 4:n=nt,s=ar,nt=r.stateNode.containerInfo,ar=!0,un(t,e,r),nt=n,ar=s;break;case 0:case 11:case 14:case 15:if(!xt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&yh(r,e,o),s=s.next}while(s!==n)}un(t,e,r);break;case 1:if(!xt&&(Qs(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(c){Oe(r,e,c)}un(t,e,r);break;case 21:un(t,e,r);break;case 22:r.mode&1?(xt=(n=xt)||r.memoizedState!==null,un(t,e,r),xt=n):un(t,e,r);break;default:un(t,e,r)}}function l0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new DN),e.forEach(function(n){var s=qN.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function sr(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,o=e,c=o;e:for(;c!==null;){switch(c.tag){case 5:nt=c.stateNode,ar=!1;break e;case 3:nt=c.stateNode.containerInfo,ar=!0;break e;case 4:nt=c.stateNode.containerInfo,ar=!0;break e}c=c.return}if(nt===null)throw Error(z(160));Fv(i,o,s),nt=null,ar=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Oe(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Uv(e,t),e=e.sibling}function Uv(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(sr(e,t),gr(t),n&4){try{Ta(3,t,t.return),qc(3,t)}catch(A){Oe(t,t.return,A)}try{Ta(5,t,t.return)}catch(A){Oe(t,t.return,A)}}break;case 1:sr(e,t),gr(t),n&512&&r!==null&&Qs(r,r.return);break;case 5:if(sr(e,t),gr(t),n&512&&r!==null&&Qs(r,r.return),t.flags&32){var s=t.stateNode;try{La(s,"")}catch(A){Oe(t,t.return,A)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=r!==null?r.memoizedProps:i,c=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&lx(s,i),qd(c,o);var d=qd(c,i);for(o=0;o<u.length;o+=2){var f=u[o],m=u[o+1];f==="style"?mx(s,m):f==="dangerouslySetInnerHTML"?dx(s,m):f==="children"?La(s,m):hm(s,f,m,d)}switch(c){case"input":Fd(s,i);break;case"textarea":cx(s,i);break;case"select":var v=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var y=i.value;y!=null?Zs(s,!!i.multiple,y,!1):v!==!!i.multiple&&(i.defaultValue!=null?Zs(s,!!i.multiple,i.defaultValue,!0):Zs(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ha]=i}catch(A){Oe(t,t.return,A)}}break;case 6:if(sr(e,t),gr(t),n&4){if(t.stateNode===null)throw Error(z(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(A){Oe(t,t.return,A)}}break;case 3:if(sr(e,t),gr(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ua(e.containerInfo)}catch(A){Oe(t,t.return,A)}break;case 4:sr(e,t),gr(t);break;case 13:sr(e,t),gr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Hm=ze())),n&4&&l0(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(xt=(d=xt)||f,sr(e,t),xt=d):sr(e,t),gr(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!f&&t.mode&1)for(G=t,f=t.child;f!==null;){for(m=G=f;G!==null;){switch(v=G,y=v.child,v.tag){case 0:case 11:case 14:case 15:Ta(4,v,v.return);break;case 1:Qs(v,v.return);var j=v.stateNode;if(typeof j.componentWillUnmount=="function"){n=v,r=v.return;try{e=n,j.props=e.memoizedProps,j.state=e.memoizedState,j.componentWillUnmount()}catch(A){Oe(n,r,A)}}break;case 5:Qs(v,v.return);break;case 22:if(v.memoizedState!==null){u0(m);continue}}y!==null?(y.return=v,G=y):u0(m)}f=f.sibling}e:for(f=null,m=t;;){if(m.tag===5){if(f===null){f=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=m.stateNode,u=m.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=hx("display",o))}catch(A){Oe(t,t.return,A)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(A){Oe(t,t.return,A)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:sr(e,t),gr(t),n&4&&l0(t);break;case 21:break;default:sr(e,t),gr(t)}}function gr(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(Vv(r)){var n=r;break e}r=r.return}throw Error(z(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(La(s,""),n.flags&=-33);var i=o0(t);wh(t,i,s);break;case 3:case 4:var o=n.stateNode.containerInfo,c=o0(t);vh(t,c,o);break;default:throw Error(z(161))}}catch(u){Oe(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function LN(t,e,r){G=t,$v(t)}function $v(t,e,r){for(var n=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||ml;if(!o){var c=s.alternate,u=c!==null&&c.memoizedState!==null||xt;c=ml;var d=xt;if(ml=o,(xt=u)&&!d)for(G=s;G!==null;)o=G,u=o.child,o.tag===22&&o.memoizedState!==null?d0(s):u!==null?(u.return=o,G=u):d0(s);for(;i!==null;)G=i,$v(i),i=i.sibling;G=s,ml=c,xt=d}c0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):c0(t)}}function c0(t){for(;G!==null;){var e=G;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:xt||qc(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!xt)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:ir(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Gp(e,i,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Gp(e,o,r)}break;case 5:var c=e.stateNode;if(r===null&&e.flags&4){r=c;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&Ua(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}xt||e.flags&512&&xh(e)}catch(v){Oe(e,e.return,v)}}if(e===t){G=null;break}if(r=e.sibling,r!==null){r.return=e.return,G=r;break}G=e.return}}function u0(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var r=e.sibling;if(r!==null){r.return=e.return,G=r;break}G=e.return}}function d0(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{qc(4,e)}catch(u){Oe(e,r,u)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(u){Oe(e,s,u)}}var i=e.return;try{xh(e)}catch(u){Oe(e,i,u)}break;case 5:var o=e.return;try{xh(e)}catch(u){Oe(e,o,u)}}}catch(u){Oe(e,e.return,u)}if(e===t){G=null;break}var c=e.sibling;if(c!==null){c.return=e.return,G=c;break}G=e.return}}var ON=Math.ceil,lc=en.ReactCurrentDispatcher,Bm=en.ReactCurrentOwner,er=en.ReactCurrentBatchConfig,he=0,Ze=null,We=null,at=0,Bt=0,Ys=qn(0),Ye=0,Ja=null,ms=0,Hc=0,qm=0,Sa=null,Ct=null,Hm=0,gi=1/0,Dr=null,cc=!1,bh=null,In=null,fl=!1,_n=null,uc=0,Aa=0,_h=null,Cl=-1,Pl=0;function Tt(){return he&6?ze():Cl!==-1?Cl:Cl=ze()}function Cn(t){return t.mode&1?he&2&&at!==0?at&-at:wN.transition!==null?(Pl===0&&(Pl=Ex()),Pl):(t=pe,t!==0||(t=window.event,t=t===void 0?16:Px(t.type)),t):1}function cr(t,e,r,n){if(50<Aa)throw Aa=0,_h=null,Error(z(185));mo(t,r,n),(!(he&2)||t!==Ze)&&(t===Ze&&(!(he&2)&&(Hc|=r),Ye===4&&pn(t,at)),Lt(t,n),r===1&&he===0&&!(e.mode&1)&&(gi=ze()+500,$c&&Hn()))}function Lt(t,e){var r=t.callbackNode;w1(t,e);var n=Gl(t,t===Ze?at:0);if(n===0)r!==null&&wp(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&wp(r),e===1)t.tag===0?vN(h0.bind(null,t)):Jx(h0.bind(null,t)),gN(function(){!(he&6)&&Hn()}),r=null;else{switch(jx(n)){case 1:r=ym;break;case 4:r=kx;break;case 16:r=Wl;break;case 536870912:r=Nx;break;default:r=Wl}r=Qv(r,zv.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function zv(t,e){if(Cl=-1,Pl=0,he&6)throw Error(z(327));var r=t.callbackNode;if(si()&&t.callbackNode!==r)return null;var n=Gl(t,t===Ze?at:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=dc(t,n);else{e=n;var s=he;he|=2;var i=qv();(Ze!==t||at!==e)&&(Dr=null,gi=ze()+500,os(t,e));do try{UN();break}catch(c){Bv(t,c)}while(!0);Im(),lc.current=i,he=s,We!==null?e=0:(Ze=null,at=0,e=Ye)}if(e!==0){if(e===2&&(s=Qd(t),s!==0&&(n=s,e=kh(t,s))),e===1)throw r=Ja,os(t,0),pn(t,n),Lt(t,ze()),r;if(e===6)pn(t,n);else{if(s=t.current.alternate,!(n&30)&&!VN(s)&&(e=dc(t,n),e===2&&(i=Qd(t),i!==0&&(n=i,e=kh(t,i))),e===1))throw r=Ja,os(t,0),pn(t,n),Lt(t,ze()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(z(345));case 2:Zn(t,Ct,Dr);break;case 3:if(pn(t,n),(n&130023424)===n&&(e=Hm+500-ze(),10<e)){if(Gl(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Tt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=nh(Zn.bind(null,t,Ct,Dr),e);break}Zn(t,Ct,Dr);break;case 4:if(pn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-lr(n);i=1<<o,o=e[o],o>s&&(s=o),n&=~i}if(n=s,n=ze()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ON(n/1960))-n,10<n){t.timeoutHandle=nh(Zn.bind(null,t,Ct,Dr),n);break}Zn(t,Ct,Dr);break;case 5:Zn(t,Ct,Dr);break;default:throw Error(z(329))}}}return Lt(t,ze()),t.callbackNode===r?zv.bind(null,t):null}function kh(t,e){var r=Sa;return t.current.memoizedState.isDehydrated&&(os(t,e).flags|=256),t=dc(t,e),t!==2&&(e=Ct,Ct=r,e!==null&&Nh(e)),t}function Nh(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function VN(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!dr(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function pn(t,e){for(e&=~qm,e&=~Hc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-lr(e),n=1<<r;t[r]=-1,e&=~n}}function h0(t){if(he&6)throw Error(z(327));si();var e=Gl(t,0);if(!(e&1))return Lt(t,ze()),null;var r=dc(t,e);if(t.tag!==0&&r===2){var n=Qd(t);n!==0&&(e=n,r=kh(t,n))}if(r===1)throw r=Ja,os(t,0),pn(t,e),Lt(t,ze()),r;if(r===6)throw Error(z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Zn(t,Ct,Dr),Lt(t,ze()),null}function Wm(t,e){var r=he;he|=1;try{return t(e)}finally{he=r,he===0&&(gi=ze()+500,$c&&Hn())}}function fs(t){_n!==null&&_n.tag===0&&!(he&6)&&si();var e=he;he|=1;var r=er.transition,n=pe;try{if(er.transition=null,pe=1,t)return t()}finally{pe=n,er.transition=r,he=e,!(he&6)&&Hn()}}function Gm(){Bt=Ys.current,je(Ys)}function os(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,fN(r)),We!==null)for(r=We.return;r!==null;){var n=r;switch(Tm(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xl();break;case 3:mi(),je(Dt),je(bt),Lm();break;case 5:Mm(n);break;case 4:mi();break;case 13:je(Ae);break;case 19:je(Ae);break;case 10:Cm(n.type._context);break;case 22:case 23:Gm()}r=r.return}if(Ze=t,We=t=Pn(t.current,null),at=Bt=e,Ye=0,Ja=null,qm=Hc=ms=0,Ct=Sa=null,ns!==null){for(e=0;e<ns.length;e++)if(r=ns[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var o=i.next;i.next=s,n.next=o}r.pending=n}ns=null}return t}function Bv(t,e){do{var r=We;try{if(Im(),Sl.current=oc,ac){for(var n=Ie.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ac=!1}if(hs=0,Xe=Qe=Ie=null,ja=!1,Ka=0,Bm.current=null,r===null||r.return===null){Ye=1,Ja=e,We=null;break}e:{var i=t,o=r.return,c=r,u=e;if(e=at,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=c,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var v=f.alternate;v?(f.updateQueue=v.updateQueue,f.memoizedState=v.memoizedState,f.lanes=v.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=Zp(o);if(y!==null){y.flags&=-257,e0(y,o,c,i,e),y.mode&1&&Xp(i,d,e),e=y,u=d;var j=e.updateQueue;if(j===null){var A=new Set;A.add(u),e.updateQueue=A}else j.add(u);break e}else{if(!(e&1)){Xp(i,d,e),Km();break e}u=Error(z(426))}}else if(Se&&c.mode&1){var R=Zp(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),e0(R,o,c,i,e),Sm(fi(u,c));break e}}i=u=fi(u,c),Ye!==4&&(Ye=2),Sa===null?Sa=[i]:Sa.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=jv(i,u,e);Wp(i,_);break e;case 1:c=u;var N=i.type,I=i.stateNode;if(!(i.flags&128)&&(typeof N.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(In===null||!In.has(I)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=Tv(i,c,e);Wp(i,P);break e}}i=i.return}while(i!==null)}Wv(r)}catch(O){e=O,We===r&&r!==null&&(We=r=r.return);continue}break}while(!0)}function qv(){var t=lc.current;return lc.current=oc,t===null?oc:t}function Km(){(Ye===0||Ye===3||Ye===2)&&(Ye=4),Ze===null||!(ms&268435455)&&!(Hc&268435455)||pn(Ze,at)}function dc(t,e){var r=he;he|=2;var n=qv();(Ze!==t||at!==e)&&(Dr=null,os(t,e));do try{FN();break}catch(s){Bv(t,s)}while(!0);if(Im(),he=r,lc.current=n,We!==null)throw Error(z(261));return Ze=null,at=0,Ye}function FN(){for(;We!==null;)Hv(We)}function UN(){for(;We!==null&&!d1();)Hv(We)}function Hv(t){var e=Kv(t.alternate,t,Bt);t.memoizedProps=t.pendingProps,e===null?Wv(t):We=e,Bm.current=null}function Wv(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=RN(r,e),r!==null){r.flags&=32767,We=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ye=6,We=null;return}}else if(r=PN(r,e,Bt),r!==null){We=r;return}if(e=e.sibling,e!==null){We=e;return}We=e=t}while(e!==null);Ye===0&&(Ye=5)}function Zn(t,e,r){var n=pe,s=er.transition;try{er.transition=null,pe=1,$N(t,e,r,n)}finally{er.transition=s,pe=n}return null}function $N(t,e,r,n){do si();while(_n!==null);if(he&6)throw Error(z(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(z(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(b1(t,i),t===Ze&&(We=Ze=null,at=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||fl||(fl=!0,Qv(Wl,function(){return si(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=er.transition,er.transition=null;var o=pe;pe=1;var c=he;he|=4,Bm.current=null,MN(t,r),Uv(r,t),oN(th),Kl=!!eh,th=eh=null,t.current=r,LN(r),h1(),he=c,pe=o,er.transition=i}else t.current=r;if(fl&&(fl=!1,_n=t,uc=s),i=t.pendingLanes,i===0&&(In=null),g1(r.stateNode),Lt(t,ze()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(cc)throw cc=!1,t=bh,bh=null,t;return uc&1&&t.tag!==0&&si(),i=t.pendingLanes,i&1?t===_h?Aa++:(Aa=0,_h=t):Aa=0,Hn(),null}function si(){if(_n!==null){var t=jx(uc),e=er.transition,r=pe;try{if(er.transition=null,pe=16>t?16:t,_n===null)var n=!1;else{if(t=_n,_n=null,uc=0,he&6)throw Error(z(331));var s=he;for(he|=4,G=t.current;G!==null;){var i=G,o=i.child;if(G.flags&16){var c=i.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(G=d;G!==null;){var f=G;switch(f.tag){case 0:case 11:case 15:Ta(8,f,i)}var m=f.child;if(m!==null)m.return=f,G=m;else for(;G!==null;){f=G;var v=f.sibling,y=f.return;if(Ov(f),f===d){G=null;break}if(v!==null){v.return=y,G=v;break}G=y}}}var j=i.alternate;if(j!==null){var A=j.child;if(A!==null){j.child=null;do{var R=A.sibling;A.sibling=null,A=R}while(A!==null)}}G=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,G=o;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ta(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,G=_;break e}G=i.return}}var N=t.current;for(G=N;G!==null;){o=G;var I=o.child;if(o.subtreeFlags&2064&&I!==null)I.return=o,G=I;else e:for(o=N;G!==null;){if(c=G,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:qc(9,c)}}catch(O){Oe(c,c.return,O)}if(c===o){G=null;break e}var P=c.sibling;if(P!==null){P.return=c.return,G=P;break e}G=c.return}}if(he=s,Hn(),wr&&typeof wr.onPostCommitFiberRoot=="function")try{wr.onPostCommitFiberRoot(Lc,t)}catch{}n=!0}return n}finally{pe=r,er.transition=e}}return!1}function m0(t,e,r){e=fi(r,e),e=jv(t,e,1),t=An(t,e,1),e=Tt(),t!==null&&(mo(t,1,e),Lt(t,e))}function Oe(t,e,r){if(t.tag===3)m0(t,t,r);else for(;e!==null;){if(e.tag===3){m0(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(In===null||!In.has(n))){t=fi(r,t),t=Tv(e,t,1),e=An(e,t,1),t=Tt(),e!==null&&(mo(e,1,t),Lt(e,t));break}}e=e.return}}function zN(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Tt(),t.pingedLanes|=t.suspendedLanes&r,Ze===t&&(at&r)===r&&(Ye===4||Ye===3&&(at&130023424)===at&&500>ze()-Hm?os(t,0):qm|=r),Lt(t,e)}function Gv(t,e){e===0&&(t.mode&1?(e=sl,sl<<=1,!(sl&130023424)&&(sl=4194304)):e=1);var r=Tt();t=Wr(t,e),t!==null&&(mo(t,e,r),Lt(t,r))}function BN(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),Gv(t,r)}function qN(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(z(314))}n!==null&&n.delete(e),Gv(t,r)}var Kv;Kv=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Dt.current)Rt=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Rt=!1,CN(t,e,r);Rt=!!(t.flags&131072)}else Rt=!1,Se&&e.flags&1048576&&Xx(e,tc,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Il(t,e),t=e.pendingProps;var s=ui(e,bt.current);ni(e,r),s=Vm(null,e,n,t,s,r);var i=Fm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Mt(n)?(i=!0,Zl(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Rm(e),s.updater=Bc,e.stateNode=s,s._reactInternals=e,uh(e,n,t,r),e=mh(null,e,n,!0,i,r)):(e.tag=0,Se&&i&&jm(e),Et(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Il(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=WN(n),t=ir(n,t),s){case 0:e=hh(null,e,n,t,r);break e;case 1:e=n0(null,e,n,t,r);break e;case 11:e=t0(null,e,n,t,r);break e;case 14:e=r0(null,e,n,ir(n.type,t),r);break e}throw Error(z(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ir(n,s),hh(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ir(n,s),n0(t,e,n,s,r);case 3:e:{if(Cv(e),t===null)throw Error(z(387));n=e.pendingProps,i=e.memoizedState,s=i.element,sv(t,e),sc(e,n,null,r);var o=e.memoizedState;if(n=o.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=fi(Error(z(423)),e),e=s0(t,e,n,r,s);break e}else if(n!==s){s=fi(Error(z(424)),e),e=s0(t,e,n,r,s);break e}else for(qt=Sn(e.stateNode.containerInfo.firstChild),Wt=e,Se=!0,or=null,r=rv(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(di(),n===s){e=Gr(t,e,r);break e}Et(t,e,n,r)}e=e.child}return e;case 5:return iv(e),t===null&&oh(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,rh(n,s)?o=null:i!==null&&rh(n,i)&&(e.flags|=32),Iv(t,e),Et(t,e,o,r),e.child;case 6:return t===null&&oh(e),null;case 13:return Pv(t,e,r);case 4:return Dm(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=hi(e,null,n,r):Et(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ir(n,s),t0(t,e,n,s,r);case 7:return Et(t,e,e.pendingProps,r),e.child;case 8:return Et(t,e,e.pendingProps.children,r),e.child;case 12:return Et(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,_e(rc,n._currentValue),n._currentValue=o,i!==null)if(dr(i.value,o)){if(i.children===s.children&&!Dt.current){e=Gr(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var u=c.firstContext;u!==null;){if(u.context===n){if(i.tag===1){u=$r(-1,r&-r),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=r,u=i.alternate,u!==null&&(u.lanes|=r),lh(i.return,r,e),c.lanes|=r;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(z(341));o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),lh(o,r,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Et(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,ni(e,r),s=tr(s),n=n(s),e.flags|=1,Et(t,e,n,r),e.child;case 14:return n=e.type,s=ir(n,e.pendingProps),s=ir(n.type,s),r0(t,e,n,s,r);case 15:return Sv(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:ir(n,s),Il(t,e),e.tag=1,Mt(n)?(t=!0,Zl(e)):t=!1,ni(e,r),Ev(e,n,s),uh(e,n,s,r),mh(null,e,n,!0,t,r);case 19:return Rv(t,e,r);case 22:return Av(t,e,r)}throw Error(z(156,e.tag))};function Qv(t,e){return _x(t,e)}function HN(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(t,e,r,n){return new HN(t,e,r,n)}function Qm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function WN(t){if(typeof t=="function")return Qm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fm)return 11;if(t===gm)return 14}return 2}function Pn(t,e){var r=t.alternate;return r===null?(r=Zt(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Rl(t,e,r,n,s,i){var o=2;if(n=t,typeof t=="function")Qm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Us:return ls(r.children,s,i,e);case mm:o=8,s|=8;break;case Dd:return t=Zt(12,r,e,s|2),t.elementType=Dd,t.lanes=i,t;case Md:return t=Zt(13,r,e,s),t.elementType=Md,t.lanes=i,t;case Ld:return t=Zt(19,r,e,s),t.elementType=Ld,t.lanes=i,t;case ix:return Wc(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nx:o=10;break e;case sx:o=9;break e;case fm:o=11;break e;case gm:o=14;break e;case mn:o=16,n=null;break e}throw Error(z(130,t==null?t:typeof t,""))}return e=Zt(o,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function ls(t,e,r,n){return t=Zt(7,t,n,e),t.lanes=r,t}function Wc(t,e,r,n){return t=Zt(22,t,n,e),t.elementType=ix,t.lanes=r,t.stateNode={isHidden:!1},t}function yd(t,e,r){return t=Zt(6,t,null,e),t.lanes=r,t}function xd(t,e,r){return e=Zt(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function GN(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xu(0),this.expirationTimes=Xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xu(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ym(t,e,r,n,s,i,o,c,u){return t=new GN(t,e,r,c,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Zt(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Rm(i),t}function KN(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fs,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function Yv(t){if(!t)return Fn;t=t._reactInternals;e:{if(ks(t)!==t||t.tag!==1)throw Error(z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Mt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(t.tag===1){var r=t.type;if(Mt(r))return Yx(t,r,e)}return e}function Jv(t,e,r,n,s,i,o,c,u){return t=Ym(r,n,!0,t,s,i,o,c,u),t.context=Yv(null),r=t.current,n=Tt(),s=Cn(r),i=$r(n,s),i.callback=e??null,An(r,i,s),t.current.lanes=s,mo(t,s,n),Lt(t,n),t}function Gc(t,e,r,n){var s=e.current,i=Tt(),o=Cn(s);return r=Yv(r),e.context===null?e.context=r:e.pendingContext=r,e=$r(i,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=An(s,e,o),t!==null&&(cr(t,s,o,i),Tl(t,s,o)),o}function hc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function f0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Jm(t,e){f0(t,e),(t=t.alternate)&&f0(t,e)}function QN(){return null}var Xv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xm(t){this._internalRoot=t}Kc.prototype.render=Xm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(z(409));Gc(t,e,null,null)};Kc.prototype.unmount=Xm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;fs(function(){Gc(null,t,null,null)}),e[Hr]=null}};function Kc(t){this._internalRoot=t}Kc.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ax();t={blockedOn:null,target:t,priority:e};for(var r=0;r<gn.length&&e!==0&&e<gn[r].priority;r++);gn.splice(r,0,t),r===0&&Cx(t)}};function Zm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function g0(){}function YN(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var d=hc(o);i.call(d)}}var o=Jv(e,n,t,0,null,!1,!1,"",g0);return t._reactRootContainer=o,t[Hr]=o.current,Ba(t.nodeType===8?t.parentNode:t),fs(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var c=n;n=function(){var d=hc(u);c.call(d)}}var u=Ym(t,0,!1,null,null,!1,!1,"",g0);return t._reactRootContainer=u,t[Hr]=u.current,Ba(t.nodeType===8?t.parentNode:t),fs(function(){Gc(e,u,r,n)}),u}function Yc(t,e,r,n,s){var i=r._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var c=s;s=function(){var u=hc(o);c.call(u)}}Gc(e,o,t,s)}else o=YN(r,e,t,s,n);return hc(o)}Tx=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=ma(e.pendingLanes);r!==0&&(xm(e,r|1),Lt(e,ze()),!(he&6)&&(gi=ze()+500,Hn()))}break;case 13:fs(function(){var n=Wr(t,1);if(n!==null){var s=Tt();cr(n,t,1,s)}}),Jm(t,1)}};vm=function(t){if(t.tag===13){var e=Wr(t,134217728);if(e!==null){var r=Tt();cr(e,t,134217728,r)}Jm(t,134217728)}};Sx=function(t){if(t.tag===13){var e=Cn(t),r=Wr(t,e);if(r!==null){var n=Tt();cr(r,t,e,n)}Jm(t,e)}};Ax=function(){return pe};Ix=function(t,e){var r=pe;try{return pe=t,e()}finally{pe=r}};Wd=function(t,e,r){switch(e){case"input":if(Fd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Uc(n);if(!s)throw Error(z(90));ox(n),Fd(n,s)}}}break;case"textarea":cx(t,r);break;case"select":e=r.value,e!=null&&Zs(t,!!r.multiple,e,!1)}};px=Wm;yx=fs;var JN={usingClientEntryPoint:!1,Events:[go,qs,Uc,fx,gx,Wm]},ca={findFiberByHostInstance:rs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},XN={bundleType:ca.bundleType,version:ca.version,rendererPackageName:ca.rendererPackageName,rendererConfig:ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:en.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wx(t),t===null?null:t.stateNode},findFiberByHostInstance:ca.findFiberByHostInstance||QN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gl.isDisabled&&gl.supportsFiber)try{Lc=gl.inject(XN),wr=gl}catch{}}Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JN;Qt.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zm(e))throw Error(z(200));return KN(t,e,null,r)};Qt.createRoot=function(t,e){if(!Zm(t))throw Error(z(299));var r=!1,n="",s=Xv;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ym(t,1,!1,null,null,r,!1,n,s),t[Hr]=e.current,Ba(t.nodeType===8?t.parentNode:t),new Xm(e)};Qt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(z(188)):(t=Object.keys(t).join(","),Error(z(268,t)));return t=wx(e),t=t===null?null:t.stateNode,t};Qt.flushSync=function(t){return fs(t)};Qt.hydrate=function(t,e,r){if(!Qc(e))throw Error(z(200));return Yc(null,t,e,!0,r)};Qt.hydrateRoot=function(t,e,r){if(!Zm(t))throw Error(z(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",o=Xv;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=Jv(e,null,t,1,r??null,s,!1,i,o),t[Hr]=e.current,Ba(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Kc(e)};Qt.render=function(t,e,r){if(!Qc(e))throw Error(z(200));return Yc(null,t,e,!1,r)};Qt.unmountComponentAtNode=function(t){if(!Qc(t))throw Error(z(40));return t._reactRootContainer?(fs(function(){Yc(null,null,t,!1,function(){t._reactRootContainer=null,t[Hr]=null})}),!0):!1};Qt.unstable_batchedUpdates=Wm;Qt.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Qc(r))throw Error(z(200));if(t==null||t._reactInternals===void 0)throw Error(z(38));return Yc(t,e,r,!1,n)};Qt.version="18.3.1-next-f1338f8080-20240426";function Zv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zv)}catch(t){console.error(t)}}Zv(),Zy.exports=Qt;var ZN=Zy.exports,ew,p0=ZN;ew=p0.createRoot,p0.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xa(){return Xa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xa.apply(this,arguments)}var kn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(kn||(kn={}));const y0="popstate";function e2(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:o,hash:c}=n.location;return Eh("",{pathname:i,search:o,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:mc(s)}return r2(e,r,null,t)}function Ce(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tw(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function t2(){return Math.random().toString(36).substr(2,8)}function x0(t,e){return{usr:t.state,key:t.key,idx:e}}function Eh(t,e,r,n){return r===void 0&&(r=null),Xa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ri(e):e,{state:r,key:e&&e.key||n||t2()})}function mc(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Ri(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function r2(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,o=s.history,c=kn.Pop,u=null,d=f();d==null&&(d=0,o.replaceState(Xa({},o.state,{idx:d}),""));function f(){return(o.state||{idx:null}).idx}function m(){c=kn.Pop;let R=f(),_=R==null?null:R-d;d=R,u&&u({action:c,location:A.location,delta:_})}function v(R,_){c=kn.Push;let N=Eh(A.location,R,_);d=f()+1;let I=x0(N,d),P=A.createHref(N);try{o.pushState(I,"",P)}catch(O){if(O instanceof DOMException&&O.name==="DataCloneError")throw O;s.location.assign(P)}i&&u&&u({action:c,location:A.location,delta:1})}function y(R,_){c=kn.Replace;let N=Eh(A.location,R,_);d=f();let I=x0(N,d),P=A.createHref(N);o.replaceState(I,"",P),i&&u&&u({action:c,location:A.location,delta:0})}function j(R){let _=s.location.origin!=="null"?s.location.origin:s.location.href,N=typeof R=="string"?R:mc(R);return N=N.replace(/ $/,"%20"),Ce(_,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,_)}let A={get action(){return c},get location(){return t(s,o)},listen(R){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(y0,m),u=R,()=>{s.removeEventListener(y0,m),u=null}},createHref(R){return e(s,R)},createURL:j,encodeLocation(R){let _=j(R);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:v,replace:y,go(R){return o.go(R)}};return A}var v0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(v0||(v0={}));function n2(t,e,r){return r===void 0&&(r="/"),s2(t,e,r)}function s2(t,e,r,n){let s=typeof e=="string"?Ri(e):e,i=pi(s.pathname||"/",r);if(i==null)return null;let o=rw(t);i2(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let d=p2(i);c=f2(o[u],d)}return c}function rw(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,o,c)=>{let u={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};u.relativePath.startsWith("/")&&(Ce(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let d=Rn([n,u.relativePath]),f=r.concat(u);i.children&&i.children.length>0&&(Ce(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),rw(i.children,e,f,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:h2(d,i.index),routesMeta:f})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))s(i,o);else for(let u of nw(i.path))s(i,o,u)}),e}function nw(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let o=nw(n.join("/")),c=[];return c.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function i2(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:m2(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const a2=/^:[\w-]+$/,o2=3,l2=2,c2=1,u2=10,d2=-2,w0=t=>t==="*";function h2(t,e){let r=t.split("/"),n=r.length;return r.some(w0)&&(n+=d2),e&&(n+=l2),r.filter(s=>!w0(s)).reduce((s,i)=>s+(a2.test(i)?o2:i===""?c2:u2),n)}function m2(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function f2(t,e,r){let{routesMeta:n}=t,s={},i="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],d=c===n.length-1,f=i==="/"?e:e.slice(i.length)||"/",m=jh({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},f),v=u.route;if(!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:Rn([i,m.pathname]),pathnameBase:w2(Rn([i,m.pathnameBase])),route:v}),m.pathnameBase!=="/"&&(i=Rn([i,m.pathnameBase]))}return o}function jh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=g2(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((d,f,m)=>{let{paramName:v,isOptional:y}=f;if(v==="*"){let A=c[m]||"";o=i.slice(0,i.length-A.length).replace(/(.)\/+$/,"$1")}const j=c[m];return y&&!j?d[v]=void 0:d[v]=(j||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function g2(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),tw(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function p2(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tw(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function pi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function y2(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Ri(t):t;return{pathname:r?r.startsWith("/")?r:x2(r,e):e,search:b2(n),hash:_2(s)}}function x2(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function vd(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function v2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function ef(t,e){let r=v2(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function tf(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Ri(t):(s=Xa({},t),Ce(!s.pathname||!s.pathname.includes("?"),vd("?","pathname","search",s)),Ce(!s.pathname||!s.pathname.includes("#"),vd("#","pathname","hash",s)),Ce(!s.search||!s.search.includes("#"),vd("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,c;if(o==null)c=r;else{let m=e.length-1;if(!n&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),m-=1;s.pathname=v.join("/")}c=m>=0?e[m]:"/"}let u=y2(s,c),d=o&&o!=="/"&&o.endsWith("/"),f=(i||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(d||f)&&(u.pathname+="/"),u}const Rn=t=>t.join("/").replace(/\/\/+/g,"/"),w2=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),b2=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_2=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function k2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const sw=["post","put","patch","delete"];new Set(sw);const N2=["get",...sw];new Set(N2);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Za(){return Za=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Za.apply(this,arguments)}const Jc=C.createContext(null),iw=C.createContext(null),tn=C.createContext(null),Xc=C.createContext(null),rn=C.createContext({outlet:null,matches:[],isDataRoute:!1}),aw=C.createContext(null);function E2(t,e){let{relative:r}=e===void 0?{}:e;Di()||Ce(!1);let{basename:n,navigator:s}=C.useContext(tn),{hash:i,pathname:o,search:c}=Zc(t,{relative:r}),u=o;return n!=="/"&&(u=o==="/"?n:Rn([n,o])),s.createHref({pathname:u,search:c,hash:i})}function Di(){return C.useContext(Xc)!=null}function Mi(){return Di()||Ce(!1),C.useContext(Xc).location}function ow(t){C.useContext(tn).static||C.useLayoutEffect(t)}function Ns(){let{isDataRoute:t}=C.useContext(rn);return t?U2():j2()}function j2(){Di()||Ce(!1);let t=C.useContext(Jc),{basename:e,future:r,navigator:n}=C.useContext(tn),{matches:s}=C.useContext(rn),{pathname:i}=Mi(),o=JSON.stringify(ef(s,r.v7_relativeSplatPath)),c=C.useRef(!1);return ow(()=>{c.current=!0}),C.useCallback(function(d,f){if(f===void 0&&(f={}),!c.current)return;if(typeof d=="number"){n.go(d);return}let m=tf(d,JSON.parse(o),i,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Rn([e,m.pathname])),(f.replace?n.replace:n.push)(m,f.state,f)},[e,n,o,i,t])}const T2=C.createContext(null);function S2(t){let e=C.useContext(rn).outlet;return e&&C.createElement(T2.Provider,{value:t},e)}function Zc(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=C.useContext(tn),{matches:s}=C.useContext(rn),{pathname:i}=Mi(),o=JSON.stringify(ef(s,n.v7_relativeSplatPath));return C.useMemo(()=>tf(t,JSON.parse(o),i,r==="path"),[t,o,i,r])}function A2(t,e){return I2(t,e)}function I2(t,e,r,n){Di()||Ce(!1);let{navigator:s}=C.useContext(tn),{matches:i}=C.useContext(rn),o=i[i.length-1],c=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let d=Mi(),f;if(e){var m;let R=typeof e=="string"?Ri(e):e;u==="/"||(m=R.pathname)!=null&&m.startsWith(u)||Ce(!1),f=R}else f=d;let v=f.pathname||"/",y=v;if(u!=="/"){let R=u.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(R.length).join("/")}let j=n2(t,{pathname:y}),A=M2(j&&j.map(R=>Object.assign({},R,{params:Object.assign({},c,R.params),pathname:Rn([u,s.encodeLocation?s.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?u:Rn([u,s.encodeLocation?s.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),i,r,n);return e&&A?C.createElement(Xc.Provider,{value:{location:Za({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:kn.Pop}},A):A}function C2(){let t=F2(),e=k2(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),r?C.createElement("pre",{style:s},r):null,null)}const P2=C.createElement(C2,null);class R2 extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?C.createElement(rn.Provider,{value:this.props.routeContext},C.createElement(aw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function D2(t){let{routeContext:e,match:r,children:n}=t,s=C.useContext(Jc);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(rn.Provider,{value:e},n)}function M2(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,c=(s=r)==null?void 0:s.errors;if(c!=null){let f=o.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);f>=0||Ce(!1),o=o.slice(0,Math.min(o.length,f+1))}let u=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<o.length;f++){let m=o[f];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=f),m.route.id){let{loaderData:v,errors:y}=r,j=m.route.loader&&v[m.route.id]===void 0&&(!y||y[m.route.id]===void 0);if(m.route.lazy||j){u=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((f,m,v)=>{let y,j=!1,A=null,R=null;r&&(y=c&&m.route.id?c[m.route.id]:void 0,A=m.route.errorElement||P2,u&&(d<0&&v===0?($2("route-fallback"),j=!0,R=null):d===v&&(j=!0,R=m.route.hydrateFallbackElement||null)));let _=e.concat(o.slice(0,v+1)),N=()=>{let I;return y?I=A:j?I=R:m.route.Component?I=C.createElement(m.route.Component,null):m.route.element?I=m.route.element:I=f,C.createElement(D2,{match:m,routeContext:{outlet:f,matches:_,isDataRoute:r!=null},children:I})};return r&&(m.route.ErrorBoundary||m.route.errorElement||v===0)?C.createElement(R2,{location:r.location,revalidation:r.revalidation,component:A,error:y,children:N(),routeContext:{outlet:null,matches:_,isDataRoute:!0}}):N()},null)}var lw=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(lw||{}),cw=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(cw||{});function L2(t){let e=C.useContext(Jc);return e||Ce(!1),e}function O2(t){let e=C.useContext(iw);return e||Ce(!1),e}function V2(t){let e=C.useContext(rn);return e||Ce(!1),e}function uw(t){let e=V2(),r=e.matches[e.matches.length-1];return r.route.id||Ce(!1),r.route.id}function F2(){var t;let e=C.useContext(aw),r=O2(),n=uw();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function U2(){let{router:t}=L2(lw.UseNavigateStable),e=uw(cw.UseNavigateStable),r=C.useRef(!1);return ow(()=>{r.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Za({fromRouteId:e},i)))},[t,e])}const b0={};function $2(t,e,r){b0[t]||(b0[t]=!0)}function z2(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function rf(t){let{to:e,replace:r,state:n,relative:s}=t;Di()||Ce(!1);let{future:i,static:o}=C.useContext(tn),{matches:c}=C.useContext(rn),{pathname:u}=Mi(),d=Ns(),f=tf(e,ef(c,i.v7_relativeSplatPath),u,s==="path"),m=JSON.stringify(f);return C.useEffect(()=>d(JSON.parse(m),{replace:r,state:n,relative:s}),[d,m,s,r,n]),null}function dw(t){return S2(t.context)}function Te(t){Ce(!1)}function B2(t){let{basename:e="/",children:r=null,location:n,navigationType:s=kn.Pop,navigator:i,static:o=!1,future:c}=t;Di()&&Ce(!1);let u=e.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:u,navigator:i,static:o,future:Za({v7_relativeSplatPath:!1},c)}),[u,c,i,o]);typeof n=="string"&&(n=Ri(n));let{pathname:f="/",search:m="",hash:v="",state:y=null,key:j="default"}=n,A=C.useMemo(()=>{let R=pi(f,u);return R==null?null:{location:{pathname:R,search:m,hash:v,state:y,key:j},navigationType:s}},[u,f,m,v,y,j,s]);return A==null?null:C.createElement(tn.Provider,{value:d},C.createElement(Xc.Provider,{children:r,value:A}))}function q2(t){let{children:e,location:r}=t;return A2(Th(e),r)}new Promise(()=>{});function Th(t,e){e===void 0&&(e=[]);let r=[];return C.Children.forEach(t,(n,s)=>{if(!C.isValidElement(n))return;let i=[...e,s];if(n.type===C.Fragment){r.push.apply(r,Th(n.props.children,i));return}n.type!==Te&&Ce(!1),!n.props.index||!n.props.children||Ce(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Th(n.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fc(){return fc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fc.apply(this,arguments)}function hw(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function H2(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function W2(t,e){return t.button===0&&(!e||e==="_self")&&!H2(t)}const G2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],K2=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Q2="6";try{window.__reactRouterVersion=Q2}catch{}const Y2=C.createContext({isTransitioning:!1}),J2="startTransition",_0=zk[J2];function X2(t){let{basename:e,children:r,future:n,window:s}=t,i=C.useRef();i.current==null&&(i.current=e2({window:s,v5Compat:!0}));let o=i.current,[c,u]=C.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},f=C.useCallback(m=>{d&&_0?_0(()=>u(m)):u(m)},[u,d]);return C.useLayoutEffect(()=>o.listen(f),[o,f]),C.useEffect(()=>z2(n),[n]),C.createElement(B2,{basename:e,children:r,location:c.location,navigationType:c.action,navigator:o,future:n})}const Z2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gs=C.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:o,state:c,target:u,to:d,preventScrollReset:f,viewTransition:m}=e,v=hw(e,G2),{basename:y}=C.useContext(tn),j,A=!1;if(typeof d=="string"&&eE.test(d)&&(j=d,Z2))try{let I=new URL(window.location.href),P=d.startsWith("//")?new URL(I.protocol+d):new URL(d),O=pi(P.pathname,y);P.origin===I.origin&&O!=null?d=O+P.search+P.hash:A=!0}catch{}let R=E2(d,{relative:s}),_=rE(d,{replace:o,state:c,target:u,preventScrollReset:f,relative:s,viewTransition:m});function N(I){n&&n(I),I.defaultPrevented||_(I)}return C.createElement("a",fc({},v,{href:j||R,onClick:A||i?n:N,ref:r,target:u}))}),mw=C.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:i="",end:o=!1,style:c,to:u,viewTransition:d,children:f}=e,m=hw(e,K2),v=Zc(u,{relative:m.relative}),y=Mi(),j=C.useContext(iw),{navigator:A,basename:R}=C.useContext(tn),_=j!=null&&nE(v)&&d===!0,N=A.encodeLocation?A.encodeLocation(v).pathname:v.pathname,I=y.pathname,P=j&&j.navigation&&j.navigation.location?j.navigation.location.pathname:null;s||(I=I.toLowerCase(),P=P?P.toLowerCase():null,N=N.toLowerCase()),P&&R&&(P=pi(P,R)||P);const O=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let D=I===N||!o&&I.startsWith(N)&&I.charAt(O)==="/",w=P!=null&&(P===N||!o&&P.startsWith(N)&&P.charAt(N.length)==="/"),x={isActive:D,isPending:w,isTransitioning:_},g=D?n:void 0,k;typeof i=="function"?k=i(x):k=[i,D?"active":null,w?"pending":null,_?"transitioning":null].filter(Boolean).join(" ");let b=typeof c=="function"?c(x):c;return C.createElement(gs,fc({},m,{"aria-current":g,className:k,ref:r,style:b,to:u,viewTransition:d}),typeof f=="function"?f(x):f)});var Sh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Sh||(Sh={}));var k0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(k0||(k0={}));function tE(t){let e=C.useContext(Jc);return e||Ce(!1),e}function rE(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:o,viewTransition:c}=e===void 0?{}:e,u=Ns(),d=Mi(),f=Zc(t,{relative:o});return C.useCallback(m=>{if(W2(m,r)){m.preventDefault();let v=n!==void 0?n:mc(d)===mc(f);u(t,{replace:v,state:s,preventScrollReset:i,relative:o,viewTransition:c})}},[d,u,f,n,s,r,t,i,o,c])}function nE(t,e){e===void 0&&(e={});let r=C.useContext(Y2);r==null&&Ce(!1);let{basename:n}=tE(Sh.useViewTransitionState),s=Zc(t,{relative:e.relative});if(!r.isTransitioning)return!1;let i=pi(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=pi(r.nextLocation.pathname,n)||r.nextLocation.pathname;return jh(s.pathname,o)!=null||jh(s.pathname,i)!=null}var N0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},sE=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],o=t[r++],c=t[r++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const i=t[r++],o=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},gw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,c=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,f=i>>2,m=(i&3)<<4|c>>4;let v=(c&15)<<2|d>>6,y=d&63;u||(y=64,o||(v=64)),n.push(r[f],r[m],r[v],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):sE(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],c=s<t.length?r[t.charAt(s)]:0;++s;const d=s<t.length?r[t.charAt(s)]:64;++s;const m=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||c==null||d==null||m==null)throw new iE;const v=i<<2|c>>4;if(n.push(v),d!==64){const y=c<<4&240|d>>2;if(n.push(y),m!==64){const j=d<<6&192|m;n.push(j)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class iE extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const aE=function(t){const e=fw(t);return gw.encodeByteArray(e,!0)},gc=function(t){return aE(t).replace(/\./g,"")},pw=function(t){try{return gw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE=()=>oE().__FIREBASE_DEFAULTS__,cE=()=>{if(typeof process>"u"||typeof N0>"u")return;const t=N0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},uE=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&pw(t[1]);return e&&JSON.parse(e)},eu=()=>{try{return lE()||cE()||uE()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},yw=t=>{var e,r;return(r=(e=eu())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},dE=t=>{const e=yw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},xw=()=>{var t;return(t=eu())===null||t===void 0?void 0:t.config},vw=t=>{var e;return(e=eu())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hE{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[gc(JSON.stringify(r)),gc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_t())}function gE(){var t;const e=(t=eu())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pE(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yE(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function xE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vE(){const t=_t();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function wE(){return!gE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function bE(){try{return typeof indexedDB=="object"}catch{return!1}}function _E(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE="FirebaseError";class nn extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=kE,Object.setPrototypeOf(this,nn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}}class yo{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?NE(i,n):"Error",c=`${this.serviceName}: ${o} (${s}).`;return new nn(s,c,n)}}function NE(t,e){return t.replace(EE,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const EE=/\{\$([^}]+)}/g;function jE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function yi(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],o=e[s];if(E0(i)&&E0(o)){if(!yi(i,o))return!1}else if(i!==o)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function E0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function ga(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[s,i]=n.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function pa(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function TE(t,e){const r=new SE(t,e);return r.subscribe.bind(r)}class SE{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");AE(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=wd),s.error===void 0&&(s.error=wd),s.complete===void 0&&(s.complete=wd);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function AE(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function wd(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t){return t&&t._delegate?t._delegate:t}class ps{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IE{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new hE;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(PE(e))try{this.getOrInitializeService({instanceIdentifier:es})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=es){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=es){return this.instances.has(e)}getOptions(e=es){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);n===c&&o.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:CE(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=es){return this.component?this.component.multipleInstances?e:es:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CE(t){return t===es?void 0:t}function PE(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RE{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new IE(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const DE={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},ME=le.INFO,LE={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},OE=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=LE[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class nf{constructor(e){this.name=e,this._logLevel=ME,this._logHandler=OE,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?DE[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}const VE=(t,e)=>e.some(r=>t instanceof r);let j0,T0;function FE(){return j0||(j0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function UE(){return T0||(T0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ww=new WeakMap,Ah=new WeakMap,bw=new WeakMap,bd=new WeakMap,sf=new WeakMap;function $E(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{r(Dn(t.result)),s()},o=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&ww.set(r,t)}).catch(()=>{}),sf.set(e,t),e}function zE(t){if(Ah.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{r(),s()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Ah.set(t,e)}let Ih={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ah.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Dn(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function BE(t){Ih=t(Ih)}function qE(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(_d(this),e,...r);return bw.set(n,e.sort?e.sort():[e]),Dn(n)}:UE().includes(t)?function(...e){return t.apply(_d(this),e),Dn(ww.get(this))}:function(...e){return Dn(t.apply(_d(this),e))}}function HE(t){return typeof t=="function"?qE(t):(t instanceof IDBTransaction&&zE(t),VE(t,FE())?new Proxy(t,Ih):t)}function Dn(t){if(t instanceof IDBRequest)return $E(t);if(bd.has(t))return bd.get(t);const e=HE(t);return e!==t&&(bd.set(t,e),sf.set(e,t)),e}const _d=t=>sf.get(t);function WE(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),c=Dn(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Dn(o.result),u.oldVersion,u.newVersion,Dn(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}const GE=["get","getKey","getAll","getAllKeys","count"],KE=["put","add","delete","clear"],kd=new Map;function S0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(kd.get(e))return kd.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=KE.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||GE.includes(r)))return;const i=async function(o,...c){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return n&&(d=d.index(c.shift())),(await Promise.all([d[r](...c),s&&u.done]))[0]};return kd.set(e,i),i}BE(t=>({...t,get:(e,r,n)=>S0(e,r)||t.get(e,r,n),has:(e,r)=>!!S0(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(YE(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function YE(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ch="@firebase/app",A0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kr=new nf("@firebase/app"),JE="@firebase/app-compat",XE="@firebase/analytics-compat",ZE="@firebase/analytics",ej="@firebase/app-check-compat",tj="@firebase/app-check",rj="@firebase/auth",nj="@firebase/auth-compat",sj="@firebase/database",ij="@firebase/data-connect",aj="@firebase/database-compat",oj="@firebase/functions",lj="@firebase/functions-compat",cj="@firebase/installations",uj="@firebase/installations-compat",dj="@firebase/messaging",hj="@firebase/messaging-compat",mj="@firebase/performance",fj="@firebase/performance-compat",gj="@firebase/remote-config",pj="@firebase/remote-config-compat",yj="@firebase/storage",xj="@firebase/storage-compat",vj="@firebase/firestore",wj="@firebase/vertexai-preview",bj="@firebase/firestore-compat",_j="firebase",kj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph="[DEFAULT]",Nj={[Ch]:"fire-core",[JE]:"fire-core-compat",[ZE]:"fire-analytics",[XE]:"fire-analytics-compat",[tj]:"fire-app-check",[ej]:"fire-app-check-compat",[rj]:"fire-auth",[nj]:"fire-auth-compat",[sj]:"fire-rtdb",[ij]:"fire-data-connect",[aj]:"fire-rtdb-compat",[oj]:"fire-fn",[lj]:"fire-fn-compat",[cj]:"fire-iid",[uj]:"fire-iid-compat",[dj]:"fire-fcm",[hj]:"fire-fcm-compat",[mj]:"fire-perf",[fj]:"fire-perf-compat",[gj]:"fire-rc",[pj]:"fire-rc-compat",[yj]:"fire-gcs",[xj]:"fire-gcs-compat",[vj]:"fire-fst",[bj]:"fire-fst-compat",[wj]:"fire-vertex","fire-js":"fire-js",[_j]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pc=new Map,Ej=new Map,Rh=new Map;function I0(t,e){try{t.container.addComponent(e)}catch(r){Kr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function xi(t){const e=t.name;if(Rh.has(e))return Kr.debug(`There were multiple attempts to register component ${e}.`),!1;Rh.set(e,t);for(const r of pc.values())I0(r,t);for(const r of Ej.values())I0(r,t);return!0}function af(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function vr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mn=new yo("app","Firebase",jj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ps("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mn.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=kj;function _w(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:Ph,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw Mn.create("bad-app-name",{appName:String(s)});if(r||(r=xw()),!r)throw Mn.create("no-options");const i=pc.get(s);if(i){if(yi(r,i.options)&&yi(n,i.config))return i;throw Mn.create("duplicate-app",{appName:s})}const o=new RE(s);for(const u of Rh.values())o.addComponent(u);const c=new Tj(r,n,o);return pc.set(s,c),c}function kw(t=Ph){const e=pc.get(t);if(!e&&t===Ph&&xw())return _w();if(!e)throw Mn.create("no-app",{appName:t});return e}function Ln(t,e,r){var n;let s=(n=Nj[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const c=[`Unable to register library "${s}" with version "${e}":`];i&&c.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Kr.warn(c.join(" "));return}xi(new ps(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj="firebase-heartbeat-database",Aj=1,eo="firebase-heartbeat-store";let Nd=null;function Nw(){return Nd||(Nd=WE(Sj,Aj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(eo)}catch(r){console.warn(r)}}}}).catch(t=>{throw Mn.create("idb-open",{originalErrorMessage:t.message})})),Nd}async function Ij(t){try{const r=(await Nw()).transaction(eo),n=await r.objectStore(eo).get(Ew(t));return await r.done,n}catch(e){if(e instanceof nn)Kr.warn(e.message);else{const r=Mn.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Kr.warn(r.message)}}}async function C0(t,e){try{const n=(await Nw()).transaction(eo,"readwrite");await n.objectStore(eo).put(e,Ew(t)),await n.done}catch(r){if(r instanceof nn)Kr.warn(r.message);else{const n=Mn.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Kr.warn(n.message)}}}function Ew(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cj=1024,Pj=30*24*60*60*1e3;class Rj{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Mj(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=P0();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const c=new Date(o.date).valueOf();return Date.now()-c<=Pj}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Kr.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=P0(),{heartbeatsToSend:n,unsentEntries:s}=Dj(this._heartbeatsCache.heartbeats),i=gc(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Kr.warn(r),""}}}function P0(){return new Date().toISOString().substring(0,10)}function Dj(t,e=Cj){const r=[];let n=t.slice();for(const s of t){const i=r.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),R0(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),R0(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Mj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return bE()?_E().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Ij(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return C0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return C0(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function R0(t){return gc(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(t){xi(new ps("platform-logger",e=>new QE(e),"PRIVATE")),xi(new ps("heartbeat",e=>new Rj(e),"PRIVATE")),Ln(Ch,A0,t),Ln(Ch,A0,"esm2017"),Ln("fire-js","")}Lj("");function of(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function jw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Oj=jw,Tw=new yo("auth","Firebase",jw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yc=new nf("@firebase/auth");function Vj(t,...e){yc.logLevel<=le.WARN&&yc.warn(`Auth (${Li}): ${t}`,...e)}function Dl(t,...e){yc.logLevel<=le.ERROR&&yc.error(`Auth (${Li}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(t,...e){throw lf(t,...e)}function _r(t,...e){return lf(t,...e)}function Sw(t,e,r){const n=Object.assign(Object.assign({},Oj()),{[e]:r});return new yo("auth","Firebase",n).create(e,{appName:t.name})}function zr(t){return Sw(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lf(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return Tw.create(t,...e)}function te(t,e,...r){if(!t)throw lf(e,...r)}function Vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Dl(e),new Error(e)}function Qr(t,e){t||Vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Fj(){return D0()==="http:"||D0()==="https:"}function D0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Fj()||yE()||"connection"in navigator)?navigator.onLine:!0}function $j(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vo{constructor(e,r){this.shortDelay=e,this.longDelay=r,Qr(r>e,"Short delay should be less than long delay!"),this.isMobile=fE()||xE()}get(){return Uj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cf(t,e){Qr(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj=new vo(3e4,6e4);function Wn(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function sn(t,e,r,n,s={}){return Iw(t,s,async()=>{let i={},o={};n&&(e==="GET"?o=n:i={body:JSON.stringify(n)});const c=xo(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return pE()||(d.referrerPolicy="no-referrer"),Aw.fetch()(Cw(t,t.config.apiHost,r,c),d)})}async function Iw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},zj),e);try{const s=new Hj(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw pl(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw pl(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw pl(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw pl(t,"user-disabled",o);const f=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Sw(t,f,d);hr(t,f)}}catch(s){if(s instanceof nn)throw s;hr(t,"network-request-failed",{message:String(s)})}}async function wo(t,e,r,n,s={}){const i=await sn(t,e,r,n,s);return"mfaPendingCredential"in i&&hr(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Cw(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?cf(t.config,s):`${t.config.apiScheme}://${s}`}function qj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Hj{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(_r(this.auth,"network-request-failed")),Bj.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function pl(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=_r(t,e,n);return s.customData._tokenResponse=r,s}function M0(t){return t!==void 0&&t.enterprise!==void 0}class Wj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return qj(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function Gj(t,e){return sn(t,"GET","/v2/recaptchaConfig",Wn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kj(t,e){return sn(t,"POST","/v1/accounts:delete",e)}async function Pw(t,e){return sn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ia(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Qj(t,e=!1){const r=Fe(t),n=await r.getIdToken(e),s=uf(n);te(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Ia(Ed(s.auth_time)),issuedAtTime:Ia(Ed(s.iat)),expirationTime:Ia(Ed(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Ed(t){return Number(t)*1e3}function uf(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Dl("JWT malformed, contained fewer than 3 sections"),null;try{const s=pw(r);return s?JSON.parse(s):(Dl("Failed to decode base64 JWT payload"),null)}catch(s){return Dl("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function L0(t){const e=uf(t);return te(e,"internal-error"),te(typeof e.exp<"u","internal-error"),te(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof nn&&Yj(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function Yj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ia(this.lastLoginAt),this.creationTime=Ia(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xc(t){var e;const r=t.auth,n=await t.getIdToken(),s=await vi(t,Pw(r,{idToken:n}));te(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Rw(i.providerUserInfo):[],c=Zj(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(c!=null&&c.length),f=u?d:!1,m={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:c,metadata:new Mh(i.createdAt,i.lastLoginAt),isAnonymous:f};Object.assign(t,m)}async function Xj(t){const e=Fe(t);await xc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Zj(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Rw(t){return t.map(e=>{var{providerId:r}=e,n=of(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eT(t,e){const r=await Iw(t,{},async()=>{const n=xo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=Cw(t,s,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Aw.fetch()(o,{method:"POST",headers:c,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function tT(t,e){return sn(t,"POST","/v2/accounts:revokeToken",Wn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){te(e.idToken,"internal-error"),te(typeof e.idToken<"u","internal-error"),te(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):L0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){te(e.length!==0,"internal-error");const r=L0(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(te(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await eT(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,o=new ii;return n&&(te(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),s&&(te(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(te(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ii,this.toJSON())}_performRefresh(){return Vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dn(t,e){te(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Fr{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=of(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Jj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Mh(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await vi(this,this.stsTokenManager.getToken(this.auth,e));return te(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return Qj(this,e)}reload(){return Xj(this)}_assign(e){this!==e&&(te(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Fr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){te(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await xc(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(vr(this.auth.app))return Promise.reject(zr(this.auth));const e=await this.getIdToken();return await vi(this,Kj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,o,c,u,d,f;const m=(n=r.displayName)!==null&&n!==void 0?n:void 0,v=(s=r.email)!==null&&s!==void 0?s:void 0,y=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,j=(o=r.photoURL)!==null&&o!==void 0?o:void 0,A=(c=r.tenantId)!==null&&c!==void 0?c:void 0,R=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,_=(d=r.createdAt)!==null&&d!==void 0?d:void 0,N=(f=r.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:I,emailVerified:P,isAnonymous:O,providerData:D,stsTokenManager:w}=r;te(I&&w,e,"internal-error");const x=ii.fromJSON(this.name,w);te(typeof I=="string",e,"internal-error"),dn(m,e.name),dn(v,e.name),te(typeof P=="boolean",e,"internal-error"),te(typeof O=="boolean",e,"internal-error"),dn(y,e.name),dn(j,e.name),dn(A,e.name),dn(R,e.name),dn(_,e.name),dn(N,e.name);const g=new Fr({uid:I,auth:e,email:v,emailVerified:P,displayName:m,isAnonymous:O,photoURL:j,phoneNumber:y,tenantId:A,stsTokenManager:x,createdAt:_,lastLoginAt:N});return D&&Array.isArray(D)&&(g.providerData=D.map(k=>Object.assign({},k))),R&&(g._redirectEventId=R),g}static async _fromIdTokenResponse(e,r,n=!1){const s=new ii;s.updateFromServerResponse(r);const i=new Fr({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await xc(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];te(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Rw(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),c=new ii;c.updateFromIdToken(n);const u=new Fr({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Mh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O0=new Map;function Ur(t){Qr(t instanceof Function,"Expected a class definition");let e=O0.get(t);return e?(Qr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,O0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}Dw.type="NONE";const V0=Dw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ml(t,e,r){return`firebase:${t}:${e}:${r}`}class ai{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=Ml(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ml("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Fr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new ai(Ur(V0),e,n);const s=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||Ur(V0);const o=Ml(n,e.config.apiKey,e.name);let c=null;for(const d of r)try{const f=await d._get(o);if(f){const m=Fr._fromJSON(e,f);d!==i&&(c=m),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new ai(i,e,n):(i=u[0],c&&await i._set(o,c.toJSON()),await Promise.all(r.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ai(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Mw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Uw(e))return"Blackberry";if($w(e))return"Webos";if(Lw(e))return"Safari";if((e.includes("chrome/")||Ow(e))&&!e.includes("edge/"))return"Chrome";if(Fw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Mw(t=_t()){return/firefox\//i.test(t)}function Lw(t=_t()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ow(t=_t()){return/crios\//i.test(t)}function Vw(t=_t()){return/iemobile/i.test(t)}function Fw(t=_t()){return/android/i.test(t)}function Uw(t=_t()){return/blackberry/i.test(t)}function $w(t=_t()){return/webos/i.test(t)}function df(t=_t()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function rT(t=_t()){var e;return df(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function nT(){return vE()&&document.documentMode===10}function zw(t=_t()){return df(t)||Fw(t)||$w(t)||Uw(t)||/windows phone/i.test(t)||Vw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(t,e=[]){let r;switch(t){case"Browser":r=F0(_t());break;case"Worker":r=`${F0(_t())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Li}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((o,c)=>{try{const u=e(i);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iT(t,e={}){return sn(t,"GET","/v2/passwordPolicy",Wn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT=6;class oT{constructor(e){var r,n,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:aT,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new U0(this),this.idTokenSubscription=new U0(this),this.beforeStateQueue=new sT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Tw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ur(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await ai.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Pw(this,{idToken:e}),n=await Fr._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(vr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,c=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return te(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await xc(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$j()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(vr(this.app))return Promise.reject(zr(this));const r=e?Fe(e):null;return r&&te(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&te(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return vr(this.app)?Promise.reject(zr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return vr(this.app)?Promise.reject(zr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ur(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await iT(this),r=new oT(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await tT(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Ur(e)||this._popupRedirectResolver;te(r,this,"argument-error"),this.redirectPersistenceManager=await ai.create(this,[Ur(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(te(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,s);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return te(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Bw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&Vj(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function Es(t){return Fe(t)}class U0{constructor(e){this.auth=e,this.observer=null,this.addObserver=TE(r=>this.observer=r)}get next(){return te(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function cT(t){tu=t}function qw(t){return tu.loadJS(t)}function uT(){return tu.recaptchaEnterpriseScript}function dT(){return tu.gapiScript}function hT(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const mT="recaptcha-enterprise",fT="NO_RECAPTCHA";class gT{constructor(e){this.type=mT,this.auth=Es(e)}async verify(e="verify",r=!1){async function n(i){if(!r){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{Gj(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const d=new Wj(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{c(u)})})}function s(i,o,c){const u=window.grecaptcha;M0(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(fT)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{n(this.auth).then(c=>{if(!r&&M0(window.grecaptcha))s(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=uT();u.length!==0&&(u+=c),qw(u).then(()=>{s(c,i,o)}).catch(d=>{o(d)})}}).catch(c=>{o(c)})})}}async function $0(t,e,r,n=!1){const s=new gT(t);let i;try{i=await s.verify(r)}catch{i=await s.verify(r,!0)}const o=Object.assign({},e);return n?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Lh(t,e,r,n){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await $0(t,e,r,r==="getOobCode");return n(t,i)}else return n(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await $0(t,e,r,r==="getOobCode");return n(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(t,e){const r=af(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(yi(i,e??{}))return s;hr(s,"already-initialized")}return r.initialize({options:e})}function yT(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(Ur);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function xT(t,e,r){const n=Es(t);te(n._canInitEmulator,n,"emulator-config-failed"),te(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Hw(e),{host:o,port:c}=vT(e),u=c===null?"":`:${c}`;n.config.emulator={url:`${i}//${o}${u}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),wT()}function Hw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vT(t){const e=Hw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:z0(n.substr(i.length+1))}}else{const[i,o]=n.split(":");return{host:i,port:z0(o)}}}function z0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function wT(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hf{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Vr("not implemented")}_getIdTokenResponse(e){return Vr("not implemented")}_linkToIdToken(e,r){return Vr("not implemented")}_getReauthenticationResolver(e){return Vr("not implemented")}}async function bT(t,e){return sn(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _T(t,e){return wo(t,"POST","/v1/accounts:signInWithPassword",Wn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kT(t,e){return wo(t,"POST","/v1/accounts:signInWithEmailLink",Wn(t,e))}async function NT(t,e){return wo(t,"POST","/v1/accounts:signInWithEmailLink",Wn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to extends hf{constructor(e,r,n,s=null){super("password",n),this._email=e,this._password=r,this._tenantId=s}static _fromEmailAndPassword(e,r){return new to(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new to(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r!=null&&r.email&&(r!=null&&r.password)){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lh(e,r,"signInWithPassword",_T);case"emailLink":return kT(e,{email:this._email,oobCode:this._password});default:hr(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lh(e,n,"signUpPassword",bT);case"emailLink":return NT(e,{idToken:r,email:this._email,oobCode:this._password});default:hr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oi(t,e){return wo(t,"POST","/v1/accounts:signInWithIdp",Wn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="http://localhost";class ys extends hf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new ys(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):hr("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=of(r,["providerId","signInMethod"]);if(!n||!s)return null;const o=new ys(n,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return oi(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,oi(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,oi(e,r)}buildRequest(){const e={requestUri:ET,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=xo(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function TT(t){const e=ga(pa(t)).link,r=e?ga(pa(e)).deep_link_id:null,n=ga(pa(t)).deep_link_id;return(n?ga(pa(n)).link:null)||n||r||e||t}class mf{constructor(e){var r,n,s,i,o,c;const u=ga(pa(e)),d=(r=u.apiKey)!==null&&r!==void 0?r:null,f=(n=u.oobCode)!==null&&n!==void 0?n:null,m=jT((s=u.mode)!==null&&s!==void 0?s:null);te(d&&f&&m,"argument-error"),this.apiKey=d,this.operation=m,this.code=f,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const r=TT(e);try{return new mf(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(){this.providerId=Oi.PROVIDER_ID}static credential(e,r){return to._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=mf.parseLink(r);return te(n,"argument-error"),to._fromEmailAndCode(e,n.code,n.tenantId)}}Oi.PROVIDER_ID="password";Oi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Oi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends Ww{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn extends bo{constructor(){super("facebook.com")}static credential(e){return ys._fromParams({providerId:yn.PROVIDER_ID,signInMethod:yn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yn.credentialFromTaggedObject(e)}static credentialFromError(e){return yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return yn.credential(e.oauthAccessToken)}catch{return null}}}yn.FACEBOOK_SIGN_IN_METHOD="facebook.com";yn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn extends bo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return ys._fromParams({providerId:xn.PROVIDER_ID,signInMethod:xn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return xn.credentialFromTaggedObject(e)}static credentialFromError(e){return xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return xn.credential(r,n)}catch{return null}}}xn.GOOGLE_SIGN_IN_METHOD="google.com";xn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vn extends bo{constructor(){super("github.com")}static credential(e){return ys._fromParams({providerId:vn.PROVIDER_ID,signInMethod:vn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vn.credentialFromTaggedObject(e)}static credentialFromError(e){return vn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vn.credential(e.oauthAccessToken)}catch{return null}}}vn.GITHUB_SIGN_IN_METHOD="github.com";vn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn extends bo{constructor(){super("twitter.com")}static credential(e,r){return ys._fromParams({providerId:wn.PROVIDER_ID,signInMethod:wn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return wn.credentialFromTaggedObject(e)}static credentialFromError(e){return wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return wn.credential(r,n)}catch{return null}}}wn.TWITTER_SIGN_IN_METHOD="twitter.com";wn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ST(t,e){return wo(t,"POST","/v1/accounts:signUp",Wn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await Fr._fromIdTokenResponse(e,n,s),o=B0(n);return new xs({user:i,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=B0(n);return new xs({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function B0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc extends nn{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,vc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new vc(e,r,n,s)}}function Gw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?vc._fromErrorAndOperation(t,i,e,n):i})}async function AT(t,e,r=!1){const n=await vi(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return xs._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IT(t,e,r=!1){const{auth:n}=t;if(vr(n.app))return Promise.reject(zr(n));const s="reauthenticate";try{const i=await vi(t,Gw(n,s,e,t),r);te(i.idToken,n,"internal-error");const o=uf(i.idToken);te(o,n,"internal-error");const{sub:c}=o;return te(t.uid===c,n,"user-mismatch"),xs._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&hr(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kw(t,e,r=!1){if(vr(t.app))return Promise.reject(zr(t));const n="signIn",s=await Gw(t,n,e),i=await xs._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}async function CT(t,e){return Kw(Es(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qw(t){const e=Es(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Yw(t,e,r){if(vr(t.app))return Promise.reject(zr(t));const n=Es(t),o=await Lh(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ST).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Qw(t),u}),c=await xs._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function Jw(t,e,r){return vr(t.app)?Promise.reject(zr(t)):CT(Fe(t),Oi.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Qw(t),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PT(t,e){return sn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RT(t,{displayName:e,photoURL:r}){if(e===void 0&&r===void 0)return;const n=Fe(t),i={idToken:await n.getIdToken(),displayName:e,photoUrl:r,returnSecureToken:!0},o=await vi(n,PT(n.auth,i));n.displayName=o.displayName||null,n.photoURL=o.photoUrl||null;const c=n.providerData.find(({providerId:u})=>u==="password");c&&(c.displayName=n.displayName,c.photoURL=n.photoURL),await n._updateTokensIfNecessary(o)}function DT(t,e,r,n){return Fe(t).onIdTokenChanged(e,r,n)}function MT(t,e,r){return Fe(t).beforeAuthStateChanged(e,r)}function LT(t,e,r,n){return Fe(t).onAuthStateChanged(e,r,n)}function OT(t){return Fe(t).signOut()}const wc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xw{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(wc,"1"),this.storage.removeItem(wc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VT=1e3,FT=10;class Zw extends Xw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=zw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},i=this.storage.getItem(n);nT()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,FT):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},VT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Zw.type="LOCAL";const UT=Zw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb extends Xw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}eb.type="SESSION";const tb=eb;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $T(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ru{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new ru(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(o).map(async d=>d(r.origin,i)),u=await $T(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ru.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((c,u)=>{const d=ff("",20);s.port1.start();const f=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:s,onMessage(m){const v=m;if(v.data.eventId===d)switch(v.data.status){case"ack":clearTimeout(f),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(v.data.response);break;default:clearTimeout(f),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(){return window}function BT(t){kr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rb(){return typeof kr().WorkerGlobalScope<"u"&&typeof kr().importScripts=="function"}async function qT(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function HT(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function WT(){return rb()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb="firebaseLocalStorageDb",GT=1,bc="firebaseLocalStorage",sb="fbase_key";class _o{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function nu(t,e){return t.transaction([bc],e?"readwrite":"readonly").objectStore(bc)}function KT(){const t=indexedDB.deleteDatabase(nb);return new _o(t).toPromise()}function Oh(){const t=indexedDB.open(nb,GT);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(bc,{keyPath:sb})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(bc)?e(n):(n.close(),await KT(),e(await Oh()))})})}async function q0(t,e,r){const n=nu(t,!0).put({[sb]:e,value:r});return new _o(n).toPromise()}async function QT(t,e){const r=nu(t,!1).get(e),n=await new _o(r).toPromise();return n===void 0?null:n.value}function H0(t,e){const r=nu(t,!0).delete(e);return new _o(r).toPromise()}const YT=800,JT=3;class ib{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Oh(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>JT)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rb()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ru._getInstance(WT()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await qT(),!this.activeServiceWorker)return;this.sender=new zT(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||HT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Oh();return await q0(e,wc,"1"),await H0(e,wc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>q0(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>QT(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>H0(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=nu(s,!1).getAll();return new _o(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),YT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ib.type="LOCAL";const XT=ib;new vo(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZT(t,e){return e?Ur(e):(te(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf extends hf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return oi(e,this._buildIdpRequest())}_linkToIdToken(e,r){return oi(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return oi(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function eS(t){return Kw(t.auth,new gf(t),t.bypassAuthState)}function tS(t){const{auth:e,user:r}=t;return te(r,e,"internal-error"),IT(r,new gf(t),t.bypassAuthState)}async function rS(t){const{auth:e,user:r}=t;return te(r,e,"internal-error"),AT(r,new gf(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return eS;case"linkViaPopup":case"linkViaRedirect":return rS;case"reauthViaPopup":case"reauthViaRedirect":return tS;default:hr(this.auth,"internal-error")}}resolve(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=new vo(2e3,1e4);class Js extends ab{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Js.currentPopupAction&&Js.currentPopupAction.cancel(),Js.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return te(e,this.auth,"internal-error"),e}async onExecution(){Qr(this.filter.length===1,"Popup operations only handle one event");const e=ff();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(_r(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_r(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Js.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_r(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nS.get())};e()}}Js.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS="pendingRedirect",Ll=new Map;class iS extends ab{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=Ll.get(this.auth._key());if(!e){try{const n=await aS(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}Ll.set(this.auth._key(),e)}return this.bypassAuthState||Ll.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function aS(t,e){const r=cS(e),n=lS(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function oS(t,e){Ll.set(t._key(),e)}function lS(t){return Ur(t._redirectPersistence)}function cS(t){return Ml(sS,t.config.apiKey,t.name)}async function uS(t,e,r=!1){if(vr(t.app))return Promise.reject(zr(t));const n=Es(t),s=ZT(n,e),o=await new iS(n,s,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS=10*60*1e3;class hS{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!mS(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!ob(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(_r(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dS&&this.cachedEventUids.clear(),this.cachedEventUids.has(W0(e))}saveEventToCache(e){this.cachedEventUids.add(W0(e)),this.lastProcessedEventTime=Date.now()}}function W0(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ob({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function mS(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ob(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fS(t,e={}){return sn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,pS=/^https?/;async function yS(t){if(t.config.emulator)return;const{authorizedDomains:e}=await fS(t);for(const r of e)try{if(xS(r))return}catch{}hr(t,"unauthorized-domain")}function xS(t){const e=Dh(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!pS.test(r))return!1;if(gS.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS=new vo(3e4,6e4);function G0(){const t=kr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function wS(t){return new Promise((e,r)=>{var n,s,i;function o(){G0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{G0(),r(_r(t,"network-request-failed"))},timeout:vS.get()})}if(!((s=(n=kr().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=kr().gapi)===null||i===void 0)&&i.load)o();else{const c=hT("iframefcb");return kr()[c]=()=>{gapi.load?o():r(_r(t,"network-request-failed"))},qw(`${dT()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw Ol=null,e})}let Ol=null;function bS(t){return Ol=Ol||wS(t),Ol}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _S=new vo(5e3,15e3),kS="__/auth/iframe",NS="emulator/auth/iframe",ES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},jS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function TS(t){const e=t.config;te(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?cf(e,NS):`https://${t.config.authDomain}/${kS}`,n={apiKey:e.apiKey,appName:t.name,v:Li},s=jS.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${xo(n).slice(1)}`}async function SS(t){const e=await bS(t),r=kr().gapi;return te(r,t,"internal-error"),e.open({where:document.body,url:TS(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ES,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const o=_r(t,"network-request-failed"),c=kr().setTimeout(()=>{i(o)},_S.get());function u(){kr().clearTimeout(c),s(n)}n.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},IS=500,CS=600,PS="_blank",RS="http://localhost";class K0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function DS(t,e,r,n=IS,s=CS){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u=Object.assign(Object.assign({},AS),{width:n.toString(),height:s.toString(),top:i,left:o}),d=_t().toLowerCase();r&&(c=Ow(d)?PS:r),Mw(d)&&(e=e||RS,u.scrollbars="yes");const f=Object.entries(u).reduce((v,[y,j])=>`${v}${y}=${j},`,"");if(rT(d)&&c!=="_self")return MS(e||"",c),new K0(null);const m=window.open(e||"",c,f);te(m,t,"popup-blocked");try{m.focus()}catch{}return new K0(m)}function MS(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="__/auth/handler",OS="emulator/auth/handler",VS=encodeURIComponent("fac");async function Q0(t,e,r,n,s,i){te(t.config.authDomain,t,"auth-domain-config-required"),te(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:Li,eventId:s};if(e instanceof Ww){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",jE(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))o[f]=m}if(e instanceof bo){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const f of Object.keys(c))c[f]===void 0&&delete c[f];const u=await t._getAppCheckToken(),d=u?`#${VS}=${encodeURIComponent(u)}`:"";return`${FS(t)}?${xo(c).slice(1)}${d}`}function FS({config:t}){return t.emulator?cf(t,OS):`https://${t.authDomain}/${LS}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd="webStorageSupport";class US{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tb,this._completeRedirectFn=uS,this._overrideRedirectResult=oS}async _openPopup(e,r,n,s){var i;Qr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Q0(e,r,n,Dh(),s);return DS(e,o,ff())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await Q0(e,r,n,Dh(),s);return BT(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Qr(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await SS(e),n=new hS(e);return r.register("authEvent",s=>(te(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(jd,{type:jd},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[jd];o!==void 0&&r(!!o),hr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=yS(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return zw()||Lw()||df()}}const $S=US;var Y0="@firebase/auth",J0="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){te(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function qS(t){xi(new ps("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;te(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Bw(t)},d=new lT(n,s,i,u);return yT(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),xi(new ps("auth-internal",e=>{const r=Es(e.getProvider("auth").getImmediate());return(n=>new zS(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ln(Y0,J0,BS(t)),Ln(Y0,J0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS=5*60,WS=vw("authIdTokenMaxAge")||HS;let X0=null;const GS=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>WS)return;const s=r==null?void 0:r.token;X0!==s&&(X0=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function KS(t=kw()){const e=af(t,"auth");if(e.isInitialized())return e.getImmediate();const r=pT(t,{popupRedirectResolver:$S,persistence:[XT,UT,tb]}),n=vw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const o=GS(i.toString());MT(r,o,()=>o(r.currentUser)),DT(r,c=>o(c))}}const s=yw("auth");return s&&xT(r,`http://${s}`),r}function QS(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}cT({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=_r("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",QS().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});qS("Browser");var YS="firebase",JS="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ln(YS,JS,"app");var Z0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cs,lb;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,x){function g(){}g.prototype=x.prototype,w.D=x.prototype,w.prototype=new g,w.prototype.constructor=w,w.C=function(k,b,S){for(var T=Array(arguments.length-2),V=2;V<arguments.length;V++)T[V-2]=arguments[V];return x.prototype[b].apply(k,T)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,x,g){g||(g=0);var k=Array(16);if(typeof x=="string")for(var b=0;16>b;++b)k[b]=x.charCodeAt(g++)|x.charCodeAt(g++)<<8|x.charCodeAt(g++)<<16|x.charCodeAt(g++)<<24;else for(b=0;16>b;++b)k[b]=x[g++]|x[g++]<<8|x[g++]<<16|x[g++]<<24;x=w.g[0],g=w.g[1],b=w.g[2];var S=w.g[3],T=x+(S^g&(b^S))+k[0]+3614090360&4294967295;x=g+(T<<7&4294967295|T>>>25),T=S+(b^x&(g^b))+k[1]+3905402710&4294967295,S=x+(T<<12&4294967295|T>>>20),T=b+(g^S&(x^g))+k[2]+606105819&4294967295,b=S+(T<<17&4294967295|T>>>15),T=g+(x^b&(S^x))+k[3]+3250441966&4294967295,g=b+(T<<22&4294967295|T>>>10),T=x+(S^g&(b^S))+k[4]+4118548399&4294967295,x=g+(T<<7&4294967295|T>>>25),T=S+(b^x&(g^b))+k[5]+1200080426&4294967295,S=x+(T<<12&4294967295|T>>>20),T=b+(g^S&(x^g))+k[6]+2821735955&4294967295,b=S+(T<<17&4294967295|T>>>15),T=g+(x^b&(S^x))+k[7]+4249261313&4294967295,g=b+(T<<22&4294967295|T>>>10),T=x+(S^g&(b^S))+k[8]+1770035416&4294967295,x=g+(T<<7&4294967295|T>>>25),T=S+(b^x&(g^b))+k[9]+2336552879&4294967295,S=x+(T<<12&4294967295|T>>>20),T=b+(g^S&(x^g))+k[10]+4294925233&4294967295,b=S+(T<<17&4294967295|T>>>15),T=g+(x^b&(S^x))+k[11]+2304563134&4294967295,g=b+(T<<22&4294967295|T>>>10),T=x+(S^g&(b^S))+k[12]+1804603682&4294967295,x=g+(T<<7&4294967295|T>>>25),T=S+(b^x&(g^b))+k[13]+4254626195&4294967295,S=x+(T<<12&4294967295|T>>>20),T=b+(g^S&(x^g))+k[14]+2792965006&4294967295,b=S+(T<<17&4294967295|T>>>15),T=g+(x^b&(S^x))+k[15]+1236535329&4294967295,g=b+(T<<22&4294967295|T>>>10),T=x+(b^S&(g^b))+k[1]+4129170786&4294967295,x=g+(T<<5&4294967295|T>>>27),T=S+(g^b&(x^g))+k[6]+3225465664&4294967295,S=x+(T<<9&4294967295|T>>>23),T=b+(x^g&(S^x))+k[11]+643717713&4294967295,b=S+(T<<14&4294967295|T>>>18),T=g+(S^x&(b^S))+k[0]+3921069994&4294967295,g=b+(T<<20&4294967295|T>>>12),T=x+(b^S&(g^b))+k[5]+3593408605&4294967295,x=g+(T<<5&4294967295|T>>>27),T=S+(g^b&(x^g))+k[10]+38016083&4294967295,S=x+(T<<9&4294967295|T>>>23),T=b+(x^g&(S^x))+k[15]+3634488961&4294967295,b=S+(T<<14&4294967295|T>>>18),T=g+(S^x&(b^S))+k[4]+3889429448&4294967295,g=b+(T<<20&4294967295|T>>>12),T=x+(b^S&(g^b))+k[9]+568446438&4294967295,x=g+(T<<5&4294967295|T>>>27),T=S+(g^b&(x^g))+k[14]+3275163606&4294967295,S=x+(T<<9&4294967295|T>>>23),T=b+(x^g&(S^x))+k[3]+4107603335&4294967295,b=S+(T<<14&4294967295|T>>>18),T=g+(S^x&(b^S))+k[8]+1163531501&4294967295,g=b+(T<<20&4294967295|T>>>12),T=x+(b^S&(g^b))+k[13]+2850285829&4294967295,x=g+(T<<5&4294967295|T>>>27),T=S+(g^b&(x^g))+k[2]+4243563512&4294967295,S=x+(T<<9&4294967295|T>>>23),T=b+(x^g&(S^x))+k[7]+1735328473&4294967295,b=S+(T<<14&4294967295|T>>>18),T=g+(S^x&(b^S))+k[12]+2368359562&4294967295,g=b+(T<<20&4294967295|T>>>12),T=x+(g^b^S)+k[5]+4294588738&4294967295,x=g+(T<<4&4294967295|T>>>28),T=S+(x^g^b)+k[8]+2272392833&4294967295,S=x+(T<<11&4294967295|T>>>21),T=b+(S^x^g)+k[11]+1839030562&4294967295,b=S+(T<<16&4294967295|T>>>16),T=g+(b^S^x)+k[14]+4259657740&4294967295,g=b+(T<<23&4294967295|T>>>9),T=x+(g^b^S)+k[1]+2763975236&4294967295,x=g+(T<<4&4294967295|T>>>28),T=S+(x^g^b)+k[4]+1272893353&4294967295,S=x+(T<<11&4294967295|T>>>21),T=b+(S^x^g)+k[7]+4139469664&4294967295,b=S+(T<<16&4294967295|T>>>16),T=g+(b^S^x)+k[10]+3200236656&4294967295,g=b+(T<<23&4294967295|T>>>9),T=x+(g^b^S)+k[13]+681279174&4294967295,x=g+(T<<4&4294967295|T>>>28),T=S+(x^g^b)+k[0]+3936430074&4294967295,S=x+(T<<11&4294967295|T>>>21),T=b+(S^x^g)+k[3]+3572445317&4294967295,b=S+(T<<16&4294967295|T>>>16),T=g+(b^S^x)+k[6]+76029189&4294967295,g=b+(T<<23&4294967295|T>>>9),T=x+(g^b^S)+k[9]+3654602809&4294967295,x=g+(T<<4&4294967295|T>>>28),T=S+(x^g^b)+k[12]+3873151461&4294967295,S=x+(T<<11&4294967295|T>>>21),T=b+(S^x^g)+k[15]+530742520&4294967295,b=S+(T<<16&4294967295|T>>>16),T=g+(b^S^x)+k[2]+3299628645&4294967295,g=b+(T<<23&4294967295|T>>>9),T=x+(b^(g|~S))+k[0]+4096336452&4294967295,x=g+(T<<6&4294967295|T>>>26),T=S+(g^(x|~b))+k[7]+1126891415&4294967295,S=x+(T<<10&4294967295|T>>>22),T=b+(x^(S|~g))+k[14]+2878612391&4294967295,b=S+(T<<15&4294967295|T>>>17),T=g+(S^(b|~x))+k[5]+4237533241&4294967295,g=b+(T<<21&4294967295|T>>>11),T=x+(b^(g|~S))+k[12]+1700485571&4294967295,x=g+(T<<6&4294967295|T>>>26),T=S+(g^(x|~b))+k[3]+2399980690&4294967295,S=x+(T<<10&4294967295|T>>>22),T=b+(x^(S|~g))+k[10]+4293915773&4294967295,b=S+(T<<15&4294967295|T>>>17),T=g+(S^(b|~x))+k[1]+2240044497&4294967295,g=b+(T<<21&4294967295|T>>>11),T=x+(b^(g|~S))+k[8]+1873313359&4294967295,x=g+(T<<6&4294967295|T>>>26),T=S+(g^(x|~b))+k[15]+4264355552&4294967295,S=x+(T<<10&4294967295|T>>>22),T=b+(x^(S|~g))+k[6]+2734768916&4294967295,b=S+(T<<15&4294967295|T>>>17),T=g+(S^(b|~x))+k[13]+1309151649&4294967295,g=b+(T<<21&4294967295|T>>>11),T=x+(b^(g|~S))+k[4]+4149444226&4294967295,x=g+(T<<6&4294967295|T>>>26),T=S+(g^(x|~b))+k[11]+3174756917&4294967295,S=x+(T<<10&4294967295|T>>>22),T=b+(x^(S|~g))+k[2]+718787259&4294967295,b=S+(T<<15&4294967295|T>>>17),T=g+(S^(b|~x))+k[9]+3951481745&4294967295,w.g[0]=w.g[0]+x&4294967295,w.g[1]=w.g[1]+(b+(T<<21&4294967295|T>>>11))&4294967295,w.g[2]=w.g[2]+b&4294967295,w.g[3]=w.g[3]+S&4294967295}n.prototype.u=function(w,x){x===void 0&&(x=w.length);for(var g=x-this.blockSize,k=this.B,b=this.h,S=0;S<x;){if(b==0)for(;S<=g;)s(this,w,S),S+=this.blockSize;if(typeof w=="string"){for(;S<x;)if(k[b++]=w.charCodeAt(S++),b==this.blockSize){s(this,k),b=0;break}}else for(;S<x;)if(k[b++]=w[S++],b==this.blockSize){s(this,k),b=0;break}}this.h=b,this.o+=x},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var x=1;x<w.length-8;++x)w[x]=0;var g=8*this.o;for(x=w.length-8;x<w.length;++x)w[x]=g&255,g/=256;for(this.u(w),w=Array(16),x=g=0;4>x;++x)for(var k=0;32>k;k+=8)w[g++]=this.g[x]>>>k&255;return w};function i(w,x){var g=c;return Object.prototype.hasOwnProperty.call(g,w)?g[w]:g[w]=x(w)}function o(w,x){this.h=x;for(var g=[],k=!0,b=w.length-1;0<=b;b--){var S=w[b]|0;k&&S==x||(g[b]=S,k=!1)}this.g=g}var c={};function u(w){return-128<=w&&128>w?i(w,function(x){return new o([x|0],0>x?-1:0)}):new o([w|0],0>w?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return m;if(0>w)return R(d(-w));for(var x=[],g=1,k=0;w>=g;k++)x[k]=w/g|0,g*=4294967296;return new o(x,0)}function f(w,x){if(w.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(w.charAt(0)=="-")return R(f(w.substring(1),x));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var g=d(Math.pow(x,8)),k=m,b=0;b<w.length;b+=8){var S=Math.min(8,w.length-b),T=parseInt(w.substring(b,b+S),x);8>S?(S=d(Math.pow(x,S)),k=k.j(S).add(d(T))):(k=k.j(g),k=k.add(d(T)))}return k}var m=u(0),v=u(1),y=u(16777216);t=o.prototype,t.m=function(){if(A(this))return-R(this).m();for(var w=0,x=1,g=0;g<this.g.length;g++){var k=this.i(g);w+=(0<=k?k:4294967296+k)*x,x*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(j(this))return"0";if(A(this))return"-"+R(this).toString(w);for(var x=d(Math.pow(w,6)),g=this,k="";;){var b=P(g,x).g;g=_(g,b.j(x));var S=((0<g.g.length?g.g[0]:g.h)>>>0).toString(w);if(g=b,j(g))return S+k;for(;6>S.length;)S="0"+S;k=S+k}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function j(w){if(w.h!=0)return!1;for(var x=0;x<w.g.length;x++)if(w.g[x]!=0)return!1;return!0}function A(w){return w.h==-1}t.l=function(w){return w=_(this,w),A(w)?-1:j(w)?0:1};function R(w){for(var x=w.g.length,g=[],k=0;k<x;k++)g[k]=~w.g[k];return new o(g,~w.h).add(v)}t.abs=function(){return A(this)?R(this):this},t.add=function(w){for(var x=Math.max(this.g.length,w.g.length),g=[],k=0,b=0;b<=x;b++){var S=k+(this.i(b)&65535)+(w.i(b)&65535),T=(S>>>16)+(this.i(b)>>>16)+(w.i(b)>>>16);k=T>>>16,S&=65535,T&=65535,g[b]=T<<16|S}return new o(g,g[g.length-1]&-2147483648?-1:0)};function _(w,x){return w.add(R(x))}t.j=function(w){if(j(this)||j(w))return m;if(A(this))return A(w)?R(this).j(R(w)):R(R(this).j(w));if(A(w))return R(this.j(R(w)));if(0>this.l(y)&&0>w.l(y))return d(this.m()*w.m());for(var x=this.g.length+w.g.length,g=[],k=0;k<2*x;k++)g[k]=0;for(k=0;k<this.g.length;k++)for(var b=0;b<w.g.length;b++){var S=this.i(k)>>>16,T=this.i(k)&65535,V=w.i(b)>>>16,ee=w.i(b)&65535;g[2*k+2*b]+=T*ee,N(g,2*k+2*b),g[2*k+2*b+1]+=S*ee,N(g,2*k+2*b+1),g[2*k+2*b+1]+=T*V,N(g,2*k+2*b+1),g[2*k+2*b+2]+=S*V,N(g,2*k+2*b+2)}for(k=0;k<x;k++)g[k]=g[2*k+1]<<16|g[2*k];for(k=x;k<2*x;k++)g[k]=0;return new o(g,0)};function N(w,x){for(;(w[x]&65535)!=w[x];)w[x+1]+=w[x]>>>16,w[x]&=65535,x++}function I(w,x){this.g=w,this.h=x}function P(w,x){if(j(x))throw Error("division by zero");if(j(w))return new I(m,m);if(A(w))return x=P(R(w),x),new I(R(x.g),R(x.h));if(A(x))return x=P(w,R(x)),new I(R(x.g),x.h);if(30<w.g.length){if(A(w)||A(x))throw Error("slowDivide_ only works with positive integers.");for(var g=v,k=x;0>=k.l(w);)g=O(g),k=O(k);var b=D(g,1),S=D(k,1);for(k=D(k,2),g=D(g,2);!j(k);){var T=S.add(k);0>=T.l(w)&&(b=b.add(g),S=T),k=D(k,1),g=D(g,1)}return x=_(w,b.j(x)),new I(b,x)}for(b=m;0<=w.l(x);){for(g=Math.max(1,Math.floor(w.m()/x.m())),k=Math.ceil(Math.log(g)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),S=d(g),T=S.j(x);A(T)||0<T.l(w);)g-=k,S=d(g),T=S.j(x);j(S)&&(S=v),b=b.add(S),w=_(w,T)}return new I(b,w)}t.A=function(w){return P(this,w).h},t.and=function(w){for(var x=Math.max(this.g.length,w.g.length),g=[],k=0;k<x;k++)g[k]=this.i(k)&w.i(k);return new o(g,this.h&w.h)},t.or=function(w){for(var x=Math.max(this.g.length,w.g.length),g=[],k=0;k<x;k++)g[k]=this.i(k)|w.i(k);return new o(g,this.h|w.h)},t.xor=function(w){for(var x=Math.max(this.g.length,w.g.length),g=[],k=0;k<x;k++)g[k]=this.i(k)^w.i(k);return new o(g,this.h^w.h)};function O(w){for(var x=w.g.length+1,g=[],k=0;k<x;k++)g[k]=w.i(k)<<1|w.i(k-1)>>>31;return new o(g,w.h)}function D(w,x){var g=x>>5;x%=32;for(var k=w.g.length-g,b=[],S=0;S<k;S++)b[S]=0<x?w.i(S+g)>>>x|w.i(S+g+1)<<32-x:w.i(S+g);return new o(b,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,lb=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=f,cs=o}).apply(typeof Z0<"u"?Z0:typeof self<"u"?self:typeof window<"u"?window:{});var yl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var cb,ya,ub,Vl,Vh,db,hb,mb;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function r(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof yl=="object"&&yl];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var n=r(this);function s(l,h){if(h)e:{var p=n;l=l.split(".");for(var E=0;E<l.length-1;E++){var M=l[E];if(!(M in p))break e;p=p[M]}l=l[l.length-1],E=p[l],h=h(E),h!=E&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function i(l,h){l instanceof String&&(l+="");var p=0,E=!1,M={next:function(){if(!E&&p<l.length){var L=p++;return{value:h(L,l[L]),done:!1}}return E=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}s("Array.prototype.values",function(l){return l||function(){return i(this,function(h,p){return p})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function d(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function f(l,h,p){return l.call.apply(l.bind,arguments)}function m(l,h,p){if(!l)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,E),l.apply(h,M)}}return function(){return l.apply(h,arguments)}}function v(l,h,p){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,v.apply(null,arguments)}function y(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var E=p.slice();return E.push.apply(E,arguments),l.apply(this,E)}}function j(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(E,M,L){for(var q=Array(arguments.length-2),ve=2;ve<arguments.length;ve++)q[ve-2]=arguments[ve];return h.prototype[M].apply(E,q)}}function A(l){const h=l.length;if(0<h){const p=Array(h);for(let E=0;E<h;E++)p[E]=l[E];return p}return[]}function R(l,h){for(let p=1;p<arguments.length;p++){const E=arguments[p];if(u(E)){const M=l.length||0,L=E.length||0;l.length=M+L;for(let q=0;q<L;q++)l[M+q]=E[q]}else l.push(E)}}class _{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function N(l){return/^[\s\xa0]*$/.test(l)}function I(){var l=c.navigator;return l&&(l=l.userAgent)?l:""}function P(l){return P[" "](l),l}P[" "]=function(){};var O=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function D(l,h,p){for(const E in l)h.call(p,l[E],E,l)}function w(l,h){for(const p in l)h.call(void 0,l[p],p,l)}function x(l){const h={};for(const p in l)h[p]=l[p];return h}const g="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(l,h){let p,E;for(let M=1;M<arguments.length;M++){E=arguments[M];for(p in E)l[p]=E[p];for(let L=0;L<g.length;L++)p=g[L],Object.prototype.hasOwnProperty.call(E,p)&&(l[p]=E[p])}}function b(l){var h=1;l=l.split(":");const p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function S(l){c.setTimeout(()=>{throw l},0)}function T(){var l=X;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class V{constructor(){this.h=this.g=null}add(h,p){const E=ee.get();E.set(h,p),this.h?this.h.next=E:this.g=E,this.h=E}}var ee=new _(()=>new be,l=>l.reset());class be{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let De,H=!1,X=new V,B=()=>{const l=c.Promise.resolve(void 0);De=()=>{l.then(ue)}};var ue=()=>{for(var l;l=T();){try{l.h.call(l.g)}catch(p){S(p)}var h=ee;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}H=!1};function xe(){this.s=this.s,this.C=this.C}xe.prototype.s=!1,xe.prototype.ma=function(){this.s||(this.s=!0,this.N())},xe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ue(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Ue.prototype.h=function(){this.defaultPrevented=!0};var Sr=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};c.addEventListener("test",p,h),c.removeEventListener("test",p,h)}catch{}return l}();function Ar(l,h){if(Ue.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,E=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(O){e:{try{P(h.nodeName);var M=!0;break e}catch{}M=!1}M||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Ir[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Ar.aa.h.call(this)}}j(Ar,Ue);var Ir={2:"touch",3:"pen",4:"mouse"};Ar.prototype.h=function(){Ar.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Cr="closure_listenable_"+(1e6*Math.random()|0),H_=0;function W_(l,h,p,E,M){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!E,this.ha=M,this.key=++H_,this.da=this.fa=!1}function Mo(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Lo(l){this.src=l,this.g={},this.h=0}Lo.prototype.add=function(l,h,p,E,M){var L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);var q=Nu(l,h,E,M);return-1<q?(h=l[q],p||(h.fa=!1)):(h=new W_(h,this.src,L,!!E,M),h.fa=p,l.push(h)),h};function ku(l,h){var p=h.type;if(p in l.g){var E=l.g[p],M=Array.prototype.indexOf.call(E,h,void 0),L;(L=0<=M)&&Array.prototype.splice.call(E,M,1),L&&(Mo(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Nu(l,h,p,E){for(var M=0;M<l.length;++M){var L=l[M];if(!L.da&&L.listener==h&&L.capture==!!p&&L.ha==E)return M}return-1}var Eu="closure_lm_"+(1e6*Math.random()|0),ju={};function cg(l,h,p,E,M){if(Array.isArray(h)){for(var L=0;L<h.length;L++)cg(l,h[L],p,E,M);return null}return p=hg(p),l&&l[Cr]?l.K(h,p,d(E)?!!E.capture:!1,M):G_(l,h,p,!1,E,M)}function G_(l,h,p,E,M,L){if(!h)throw Error("Invalid event type");var q=d(M)?!!M.capture:!!M,ve=Su(l);if(ve||(l[Eu]=ve=new Lo(l)),p=ve.add(h,p,E,q,L),p.proxy)return p;if(E=K_(),p.proxy=E,E.src=l,E.listener=p,l.addEventListener)Sr||(M=q),M===void 0&&(M=!1),l.addEventListener(h.toString(),E,M);else if(l.attachEvent)l.attachEvent(dg(h.toString()),E);else if(l.addListener&&l.removeListener)l.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return p}function K_(){function l(p){return h.call(l.src,l.listener,p)}const h=Q_;return l}function ug(l,h,p,E,M){if(Array.isArray(h))for(var L=0;L<h.length;L++)ug(l,h[L],p,E,M);else E=d(E)?!!E.capture:!!E,p=hg(p),l&&l[Cr]?(l=l.i,h=String(h).toString(),h in l.g&&(L=l.g[h],p=Nu(L,p,E,M),-1<p&&(Mo(L[p]),Array.prototype.splice.call(L,p,1),L.length==0&&(delete l.g[h],l.h--)))):l&&(l=Su(l))&&(h=l.g[h.toString()],l=-1,h&&(l=Nu(h,p,E,M)),(p=-1<l?h[l]:null)&&Tu(p))}function Tu(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[Cr])ku(h.i,l);else{var p=l.type,E=l.proxy;h.removeEventListener?h.removeEventListener(p,E,l.capture):h.detachEvent?h.detachEvent(dg(p),E):h.addListener&&h.removeListener&&h.removeListener(E),(p=Su(h))?(ku(p,l),p.h==0&&(p.src=null,h[Eu]=null)):Mo(l)}}}function dg(l){return l in ju?ju[l]:ju[l]="on"+l}function Q_(l,h){if(l.da)l=!0;else{h=new Ar(h,this);var p=l.listener,E=l.ha||l.src;l.fa&&Tu(l),l=p.call(E,h)}return l}function Su(l){return l=l[Eu],l instanceof Lo?l:null}var Au="__closure_events_fn_"+(1e9*Math.random()>>>0);function hg(l){return typeof l=="function"?l:(l[Au]||(l[Au]=function(h){return l.handleEvent(h)}),l[Au])}function ut(){xe.call(this),this.i=new Lo(this),this.M=this,this.F=null}j(ut,xe),ut.prototype[Cr]=!0,ut.prototype.removeEventListener=function(l,h,p,E){ug(this,l,h,p,E)};function kt(l,h){var p,E=l.F;if(E)for(p=[];E;E=E.F)p.push(E);if(l=l.M,E=h.type||h,typeof h=="string")h=new Ue(h,l);else if(h instanceof Ue)h.target=h.target||l;else{var M=h;h=new Ue(E,l),k(h,M)}if(M=!0,p)for(var L=p.length-1;0<=L;L--){var q=h.g=p[L];M=Oo(q,E,!0,h)&&M}if(q=h.g=l,M=Oo(q,E,!0,h)&&M,M=Oo(q,E,!1,h)&&M,p)for(L=0;L<p.length;L++)q=h.g=p[L],M=Oo(q,E,!1,h)&&M}ut.prototype.N=function(){if(ut.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],E=0;E<p.length;E++)Mo(p[E]);delete l.g[h],l.h--}}this.F=null},ut.prototype.K=function(l,h,p,E){return this.i.add(String(l),h,!1,p,E)},ut.prototype.L=function(l,h,p,E){return this.i.add(String(l),h,!0,p,E)};function Oo(l,h,p,E){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var M=!0,L=0;L<h.length;++L){var q=h[L];if(q&&!q.da&&q.capture==p){var ve=q.listener,rt=q.ha||q.src;q.fa&&ku(l.i,q),M=ve.call(rt,E)!==!1&&M}}return M&&!E.defaultPrevented}function mg(l,h,p){if(typeof l=="function")p&&(l=v(l,p));else if(l&&typeof l.handleEvent=="function")l=v(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:c.setTimeout(l,h||0)}function fg(l){l.g=mg(()=>{l.g=null,l.i&&(l.i=!1,fg(l))},l.l);const h=l.h;l.h=null,l.m.apply(null,h)}class Y_ extends xe{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:fg(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Bi(l){xe.call(this),this.h=l,this.g={}}j(Bi,xe);var gg=[];function pg(l){D(l.g,function(h,p){this.g.hasOwnProperty(p)&&Tu(h)},l),l.g={}}Bi.prototype.N=function(){Bi.aa.N.call(this),pg(this)},Bi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Iu=c.JSON.stringify,J_=c.JSON.parse,X_=class{stringify(l){return c.JSON.stringify(l,void 0)}parse(l){return c.JSON.parse(l,void 0)}};function Cu(){}Cu.prototype.h=null;function yg(l){return l.h||(l.h=l.i())}function xg(){}var qi={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Pu(){Ue.call(this,"d")}j(Pu,Ue);function Ru(){Ue.call(this,"c")}j(Ru,Ue);var Kn={},vg=null;function Vo(){return vg=vg||new ut}Kn.La="serverreachability";function wg(l){Ue.call(this,Kn.La,l)}j(wg,Ue);function Hi(l){const h=Vo();kt(h,new wg(h))}Kn.STAT_EVENT="statevent";function bg(l,h){Ue.call(this,Kn.STAT_EVENT,l),this.stat=h}j(bg,Ue);function Nt(l){const h=Vo();kt(h,new bg(h,l))}Kn.Ma="timingevent";function _g(l,h){Ue.call(this,Kn.Ma,l),this.size=h}j(_g,Ue);function Wi(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){l()},h)}function Gi(){this.g=!0}Gi.prototype.xa=function(){this.g=!1};function Z_(l,h,p,E,M,L){l.info(function(){if(l.g)if(L)for(var q="",ve=L.split("&"),rt=0;rt<ve.length;rt++){var me=ve[rt].split("=");if(1<me.length){var dt=me[0];me=me[1];var ht=dt.split("_");q=2<=ht.length&&ht[1]=="type"?q+(dt+"="+me+"&"):q+(dt+"=redacted&")}}else q=null;else q=L;return"XMLHTTP REQ ("+E+") [attempt "+M+"]: "+h+`
`+p+`
`+q})}function ek(l,h,p,E,M,L,q){l.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+M+"]: "+h+`
`+p+`
`+L+" "+q})}function Is(l,h,p,E){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+rk(l,p)+(E?" "+E:"")})}function tk(l,h){l.info(function(){return"TIMEOUT: "+h})}Gi.prototype.info=function(){};function rk(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var E=p[l];if(!(2>E.length)){var M=E[1];if(Array.isArray(M)&&!(1>M.length)){var L=M[0];if(L!="noop"&&L!="stop"&&L!="close")for(var q=1;q<M.length;q++)M[q]=""}}}}return Iu(p)}catch{return h}}var Fo={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},kg={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Du;function Uo(){}j(Uo,Cu),Uo.prototype.g=function(){return new XMLHttpRequest},Uo.prototype.i=function(){return{}},Du=new Uo;function on(l,h,p,E){this.j=l,this.i=h,this.l=p,this.R=E||1,this.U=new Bi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ng}function Ng(){this.i=null,this.g="",this.h=!1}var Eg={},Mu={};function Lu(l,h,p){l.L=1,l.v=qo(Pr(h)),l.m=p,l.P=!0,jg(l,null)}function jg(l,h){l.F=Date.now(),$o(l),l.A=Pr(l.v);var p=l.A,E=l.R;Array.isArray(E)||(E=[String(E)]),Ug(p.i,"t",E),l.C=0,p=l.j.J,l.h=new Ng,l.g=sp(l.j,p?h:null,!l.m),0<l.O&&(l.M=new Y_(v(l.Y,l,l.g),l.O)),h=l.U,p=l.g,E=l.ca;var M="readystatechange";Array.isArray(M)||(M&&(gg[0]=M.toString()),M=gg);for(var L=0;L<M.length;L++){var q=cg(p,M[L],E||h.handleEvent,!1,h.h||h);if(!q)break;h.g[q.key]=q}h=l.H?x(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),Hi(),Z_(l.i,l.u,l.A,l.l,l.R,l.m)}on.prototype.ca=function(l){l=l.target;const h=this.M;h&&Rr(l)==3?h.j():this.Y(l)},on.prototype.Y=function(l){try{if(l==this.g)e:{const ht=Rr(this.g);var h=this.g.Ba();const Rs=this.g.Z();if(!(3>ht)&&(ht!=3||this.g&&(this.h.h||this.g.oa()||Gg(this.g)))){this.J||ht!=4||h==7||(h==8||0>=Rs?Hi(3):Hi(2)),Ou(this);var p=this.g.Z();this.X=p;t:if(Tg(this)){var E=Gg(this.g);l="";var M=E.length,L=Rr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qn(this),Ki(this);var q="";break t}this.h.i=new c.TextDecoder}for(h=0;h<M;h++)this.h.h=!0,l+=this.h.i.decode(E[h],{stream:!(L&&h==M-1)});E.length=0,this.h.g+=l,this.C=0,q=this.h.g}else q=this.g.oa();if(this.o=p==200,ek(this.i,this.u,this.A,this.l,this.R,ht,p),this.o){if(this.T&&!this.K){t:{if(this.g){var ve,rt=this.g;if((ve=rt.g?rt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(ve)){var me=ve;break t}}me=null}if(p=me)Is(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vu(this,p);else{this.o=!1,this.s=3,Nt(12),Qn(this),Ki(this);break e}}if(this.P){p=!0;let nr;for(;!this.J&&this.C<q.length;)if(nr=nk(this,q),nr==Mu){ht==4&&(this.s=4,Nt(14),p=!1),Is(this.i,this.l,null,"[Incomplete Response]");break}else if(nr==Eg){this.s=4,Nt(15),Is(this.i,this.l,q,"[Invalid Chunk]"),p=!1;break}else Is(this.i,this.l,nr,null),Vu(this,nr);if(Tg(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ht!=4||q.length!=0||this.h.h||(this.s=1,Nt(16),p=!1),this.o=this.o&&p,!p)Is(this.i,this.l,q,"[Invalid Chunked Response]"),Qn(this),Ki(this);else if(0<q.length&&!this.W){this.W=!0;var dt=this.j;dt.g==this&&dt.ba&&!dt.M&&(dt.j.info("Great, no buffering proxy detected. Bytes received: "+q.length),qu(dt),dt.M=!0,Nt(11))}}else Is(this.i,this.l,q,null),Vu(this,q);ht==4&&Qn(this),this.o&&!this.J&&(ht==4?ep(this.j,this):(this.o=!1,$o(this)))}else wk(this.g),p==400&&0<q.indexOf("Unknown SID")?(this.s=3,Nt(12)):(this.s=0,Nt(13)),Qn(this),Ki(this)}}}catch{}finally{}};function Tg(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function nk(l,h){var p=l.C,E=h.indexOf(`
`,p);return E==-1?Mu:(p=Number(h.substring(p,E)),isNaN(p)?Eg:(E+=1,E+p>h.length?Mu:(h=h.slice(E,E+p),l.C=E+p,h)))}on.prototype.cancel=function(){this.J=!0,Qn(this)};function $o(l){l.S=Date.now()+l.I,Sg(l,l.I)}function Sg(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Wi(v(l.ba,l),h)}function Ou(l){l.B&&(c.clearTimeout(l.B),l.B=null)}on.prototype.ba=function(){this.B=null;const l=Date.now();0<=l-this.S?(tk(this.i,this.A),this.L!=2&&(Hi(),Nt(17)),Qn(this),this.s=2,Ki(this)):Sg(this,this.S-l)};function Ki(l){l.j.G==0||l.J||ep(l.j,l)}function Qn(l){Ou(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,pg(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Vu(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Fu(p.h,l))){if(!l.K&&Fu(p.h,l)&&p.G==3){try{var E=p.Da.g.parse(h)}catch{E=null}if(Array.isArray(E)&&E.length==3){var M=E;if(M[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)Yo(p),Ko(p);else break e;Bu(p),Nt(18)}}else p.za=M[1],0<p.za-p.T&&37500>M[2]&&p.F&&p.v==0&&!p.C&&(p.C=Wi(v(p.Za,p),6e3));if(1>=Cg(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Jn(p,11)}else if((l.K||p.g==l)&&Yo(p),!N(h))for(M=p.Da.g.parse(h),h=0;h<M.length;h++){let me=M[h];if(p.T=me[0],me=me[1],p.G==2)if(me[0]=="c"){p.K=me[1],p.ia=me[2];const dt=me[3];dt!=null&&(p.la=dt,p.j.info("VER="+p.la));const ht=me[4];ht!=null&&(p.Aa=ht,p.j.info("SVER="+p.Aa));const Rs=me[5];Rs!=null&&typeof Rs=="number"&&0<Rs&&(E=1.5*Rs,p.L=E,p.j.info("backChannelRequestTimeoutMs_="+E)),E=p;const nr=l.g;if(nr){const Xo=nr.g?nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xo){var L=E.h;L.g||Xo.indexOf("spdy")==-1&&Xo.indexOf("quic")==-1&&Xo.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Uu(L,L.h),L.h=null))}if(E.D){const Hu=nr.g?nr.g.getResponseHeader("X-HTTP-Session-Id"):null;Hu&&(E.ya=Hu,ke(E.I,E.D,Hu))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),E=p;var q=l;if(E.qa=np(E,E.J?E.ia:null,E.W),q.K){Pg(E.h,q);var ve=q,rt=E.L;rt&&(ve.I=rt),ve.B&&(Ou(ve),$o(ve)),E.g=q}else Xg(E);0<p.i.length&&Qo(p)}else me[0]!="stop"&&me[0]!="close"||Jn(p,7);else p.G==3&&(me[0]=="stop"||me[0]=="close"?me[0]=="stop"?Jn(p,7):zu(p):me[0]!="noop"&&p.l&&p.l.ta(me),p.v=0)}}Hi(4)}catch{}}var sk=class{constructor(l,h){this.g=l,this.map=h}};function Ag(l){this.l=l||10,c.PerformanceNavigationTiming?(l=c.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ig(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Cg(l){return l.h?1:l.g?l.g.size:0}function Fu(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Uu(l,h){l.g?l.g.add(h):l.h=h}function Pg(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Ag.prototype.cancel=function(){if(this.i=Rg(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Rg(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(const p of l.g.values())h=h.concat(p.D);return h}return A(l.i)}function ik(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(u(l)){for(var h=[],p=l.length,E=0;E<p;E++)h.push(l[E]);return h}h=[],p=0;for(E in l)h[p++]=l[E];return h}function ak(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(u(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(const E in l)h[p++]=E;return h}}}function Dg(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(u(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=ak(l),E=ik(l),M=E.length,L=0;L<M;L++)h.call(void 0,E[L],p&&p[L],l)}var Mg=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ok(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var E=l[p].indexOf("="),M=null;if(0<=E){var L=l[p].substring(0,E);M=l[p].substring(E+1)}else L=l[p];h(L,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Yn(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Yn){this.h=l.h,zo(this,l.j),this.o=l.o,this.g=l.g,Bo(this,l.s),this.l=l.l;var h=l.i,p=new Ji;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),Lg(this,p),this.m=l.m}else l&&(h=String(l).match(Mg))?(this.h=!1,zo(this,h[1]||"",!0),this.o=Qi(h[2]||""),this.g=Qi(h[3]||"",!0),Bo(this,h[4]),this.l=Qi(h[5]||"",!0),Lg(this,h[6]||"",!0),this.m=Qi(h[7]||"")):(this.h=!1,this.i=new Ji(null,this.h))}Yn.prototype.toString=function(){var l=[],h=this.j;h&&l.push(Yi(h,Og,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(Yi(h,Og,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(Yi(p,p.charAt(0)=="/"?uk:ck,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",Yi(p,hk)),l.join("")};function Pr(l){return new Yn(l)}function zo(l,h,p){l.j=p?Qi(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function Bo(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function Lg(l,h,p){h instanceof Ji?(l.i=h,mk(l.i,l.h)):(p||(h=Yi(h,dk)),l.i=new Ji(h,l.h))}function ke(l,h,p){l.i.set(h,p)}function qo(l){return ke(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Qi(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Yi(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,lk),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function lk(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Og=/[#\/\?@]/g,ck=/[#\?:]/g,uk=/[#\?]/g,dk=/[#\?@]/g,hk=/#/g;function Ji(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function ln(l){l.g||(l.g=new Map,l.h=0,l.i&&ok(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}t=Ji.prototype,t.add=function(l,h){ln(this),this.i=null,l=Cs(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Vg(l,h){ln(l),h=Cs(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function Fg(l,h){return ln(l),h=Cs(l,h),l.g.has(h)}t.forEach=function(l,h){ln(this),this.g.forEach(function(p,E){p.forEach(function(M){l.call(h,M,E,this)},this)},this)},t.na=function(){ln(this);const l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let E=0;E<h.length;E++){const M=l[E];for(let L=0;L<M.length;L++)p.push(h[E])}return p},t.V=function(l){ln(this);let h=[];if(typeof l=="string")Fg(this,l)&&(h=h.concat(this.g.get(Cs(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},t.set=function(l,h){return ln(this),this.i=null,l=Cs(this,l),Fg(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},t.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Ug(l,h,p){Vg(l,h),0<p.length&&(l.i=null,l.g.set(Cs(l,h),A(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var E=h[p];const L=encodeURIComponent(String(E)),q=this.V(E);for(E=0;E<q.length;E++){var M=L;q[E]!==""&&(M+="="+encodeURIComponent(String(q[E]))),l.push(M)}}return this.i=l.join("&")};function Cs(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function mk(l,h){h&&!l.j&&(ln(l),l.i=null,l.g.forEach(function(p,E){var M=E.toLowerCase();E!=M&&(Vg(this,E),Ug(this,M,p))},l)),l.j=h}function fk(l,h){const p=new Gi;if(c.Image){const E=new Image;E.onload=y(cn,p,"TestLoadImage: loaded",!0,h,E),E.onerror=y(cn,p,"TestLoadImage: error",!1,h,E),E.onabort=y(cn,p,"TestLoadImage: abort",!1,h,E),E.ontimeout=y(cn,p,"TestLoadImage: timeout",!1,h,E),c.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=l}else h(!1)}function gk(l,h){const p=new Gi,E=new AbortController,M=setTimeout(()=>{E.abort(),cn(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:E.signal}).then(L=>{clearTimeout(M),L.ok?cn(p,"TestPingServer: ok",!0,h):cn(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(M),cn(p,"TestPingServer: error",!1,h)})}function cn(l,h,p,E,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),E(p)}catch{}}function pk(){this.g=new X_}function yk(l,h,p){const E=p||"";try{Dg(l,function(M,L){let q=M;d(M)&&(q=Iu(M)),h.push(E+L+"="+encodeURIComponent(q))})}catch(M){throw h.push(E+"type="+encodeURIComponent("_badmap")),M}}function Ho(l){this.l=l.Ub||null,this.j=l.eb||!1}j(Ho,Cu),Ho.prototype.g=function(){return new Wo(this.l,this.j)},Ho.prototype.i=function(l){return function(){return l}}({});function Wo(l,h){ut.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}j(Wo,ut),t=Wo.prototype,t.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,Zi(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||c).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xi(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Zi(this)),this.g&&(this.readyState=3,Zi(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;$g(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function $g(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Xi(this):Zi(this),this.readyState==3&&$g(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,Xi(this))},t.Qa=function(l){this.g&&(this.response=l,Xi(this))},t.ga=function(){this.g&&Xi(this)};function Xi(l){l.readyState=4,l.l=null,l.j=null,l.v=null,Zi(l)}t.setRequestHeader=function(l,h){this.u.append(l,h)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function Zi(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Wo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function zg(l){let h="";return D(l,function(p,E){h+=E,h+=":",h+=p,h+=`\r
`}),h}function $u(l,h,p){e:{for(E in p){var E=!1;break e}E=!0}E||(p=zg(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):ke(l,h,p))}function Me(l){ut.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}j(Me,ut);var xk=/^https?$/i,vk=["POST","PUT"];t=Me.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,h,p,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Du.g(),this.v=this.o?yg(this.o):yg(Du),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(L){Bg(this,L);return}if(l=p||"",p=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var M in E)p.set(M,E[M]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const L of E.keys())p.set(L,E.get(L));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(p.keys()).find(L=>L.toLowerCase()=="content-type"),M=c.FormData&&l instanceof c.FormData,!(0<=Array.prototype.indexOf.call(vk,h,void 0))||E||M||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,q]of p)this.g.setRequestHeader(L,q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wg(this),this.u=!0,this.g.send(l),this.u=!1}catch(L){Bg(this,L)}};function Bg(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,qg(l),Go(l)}function qg(l){l.A||(l.A=!0,kt(l,"complete"),kt(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,kt(this,"complete"),kt(this,"abort"),Go(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Go(this,!0)),Me.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Hg(this):this.bb())},t.bb=function(){Hg(this)};function Hg(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Rr(l)!=4||l.Z()!=2)){if(l.u&&Rr(l)==4)mg(l.Ea,0,l);else if(kt(l,"readystatechange"),Rr(l)==4){l.h=!1;try{const q=l.Z();e:switch(q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var E;if(E=q===0){var M=String(l.D).match(Mg)[1]||null;!M&&c.self&&c.self.location&&(M=c.self.location.protocol.slice(0,-1)),E=!xk.test(M?M.toLowerCase():"")}p=E}if(p)kt(l,"complete"),kt(l,"success");else{l.m=6;try{var L=2<Rr(l)?l.g.statusText:""}catch{L=""}l.l=L+" ["+l.Z()+"]",qg(l)}}finally{Go(l)}}}}function Go(l,h){if(l.g){Wg(l);const p=l.g,E=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||kt(l,"ready");try{p.onreadystatechange=E}catch{}}}function Wg(l){l.I&&(c.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Rr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Rr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),J_(h)}};function Gg(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function wk(l){const h={};l=(l.g&&2<=Rr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<l.length;E++){if(N(l[E]))continue;var p=b(l[E]);const M=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const L=h[M]||[];h[M]=L,L.push(p)}w(h,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ea(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function Kg(l){this.Aa=0,this.i=[],this.j=new Gi,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ea("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ea("baseRetryDelayMs",5e3,l),this.cb=ea("retryDelaySeedMs",1e4,l),this.Wa=ea("forwardChannelMaxRetries",2,l),this.wa=ea("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Ag(l&&l.concurrentRequestLimit),this.Da=new pk,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Kg.prototype,t.la=8,t.G=1,t.connect=function(l,h,p,E){Nt(0),this.W=l,this.H=h||{},p&&E!==void 0&&(this.H.OSID=p,this.H.OAID=E),this.F=this.X,this.I=np(this,null,this.W),Qo(this)};function zu(l){if(Qg(l),l.G==3){var h=l.U++,p=Pr(l.I);if(ke(p,"SID",l.K),ke(p,"RID",h),ke(p,"TYPE","terminate"),ta(l,p),h=new on(l,l.j,h),h.L=2,h.v=qo(Pr(p)),p=!1,c.navigator&&c.navigator.sendBeacon)try{p=c.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&c.Image&&(new Image().src=h.v,p=!0),p||(h.g=sp(h.j,null),h.g.ea(h.v)),h.F=Date.now(),$o(h)}rp(l)}function Ko(l){l.g&&(qu(l),l.g.cancel(),l.g=null)}function Qg(l){Ko(l),l.u&&(c.clearTimeout(l.u),l.u=null),Yo(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&c.clearTimeout(l.s),l.s=null)}function Qo(l){if(!Ig(l.h)&&!l.s){l.s=!0;var h=l.Ga;De||B(),H||(De(),H=!0),X.add(h,l),l.B=0}}function bk(l,h){return Cg(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Wi(v(l.Ga,l,h),tp(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;const M=new on(this,this.j,l);let L=this.o;if(this.S&&(L?(L=x(L),k(L,this.S)):L=this.S),this.m!==null||this.O||(M.H=L,L=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var E=this.i[p];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(h+=E,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=Jg(this,M,h),p=Pr(this.I),ke(p,"RID",l),ke(p,"CVER",22),this.D&&ke(p,"X-HTTP-Session-Id",this.D),ta(this,p),L&&(this.O?h="headers="+encodeURIComponent(String(zg(L)))+"&"+h:this.m&&$u(p,this.m,L)),Uu(this.h,M),this.Ua&&ke(p,"TYPE","init"),this.P?(ke(p,"$req",h),ke(p,"SID","null"),M.T=!0,Lu(M,p,null)):Lu(M,p,h),this.G=2}}else this.G==3&&(l?Yg(this,l):this.i.length==0||Ig(this.h)||Yg(this))};function Yg(l,h){var p;h?p=h.l:p=l.U++;const E=Pr(l.I);ke(E,"SID",l.K),ke(E,"RID",p),ke(E,"AID",l.T),ta(l,E),l.m&&l.o&&$u(E,l.m,l.o),p=new on(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=Jg(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Uu(l.h,p),Lu(p,E,h)}function ta(l,h){l.H&&D(l.H,function(p,E){ke(h,E,p)}),l.l&&Dg({},function(p,E){ke(h,E,p)})}function Jg(l,h,p){p=Math.min(l.i.length,p);var E=l.l?v(l.l.Na,l.l,l):null;e:{var M=l.i;let L=-1;for(;;){const q=["count="+p];L==-1?0<p?(L=M[0].g,q.push("ofs="+L)):L=0:q.push("ofs="+L);let ve=!0;for(let rt=0;rt<p;rt++){let me=M[rt].g;const dt=M[rt].map;if(me-=L,0>me)L=Math.max(0,M[rt].g-100),ve=!1;else try{yk(dt,q,"req"+me+"_")}catch{E&&E(dt)}}if(ve){E=q.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,E}function Xg(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;De||B(),H||(De(),H=!0),X.add(h,l),l.v=0}}function Bu(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Wi(v(l.Fa,l),tp(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,Zg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Wi(v(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Nt(10),Ko(this),Zg(this))};function qu(l){l.A!=null&&(c.clearTimeout(l.A),l.A=null)}function Zg(l){l.g=new on(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=Pr(l.qa);ke(h,"RID","rpc"),ke(h,"SID",l.K),ke(h,"AID",l.T),ke(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&ke(h,"TO",l.ja),ke(h,"TYPE","xmlhttp"),ta(l,h),l.m&&l.o&&$u(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=qo(Pr(h)),p.m=null,p.P=!0,jg(p,l)}t.Za=function(){this.C!=null&&(this.C=null,Ko(this),Bu(this),Nt(19))};function Yo(l){l.C!=null&&(c.clearTimeout(l.C),l.C=null)}function ep(l,h){var p=null;if(l.g==h){Yo(l),qu(l),l.g=null;var E=2}else if(Fu(l.h,h))p=h.D,Pg(l.h,h),E=1;else return;if(l.G!=0){if(h.o)if(E==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var M=l.B;E=Vo(),kt(E,new _g(E,p)),Qo(l)}else Xg(l);else if(M=h.s,M==3||M==0&&0<h.X||!(E==1&&bk(l,h)||E==2&&Bu(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),M){case 1:Jn(l,5);break;case 4:Jn(l,10);break;case 3:Jn(l,6);break;default:Jn(l,2)}}}function tp(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Jn(l,h){if(l.j.info("Error code "+h),h==2){var p=v(l.fb,l),E=l.Xa;const M=!E;E=new Yn(E||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||zo(E,"https"),qo(E),M?fk(E.toString(),p):gk(E.toString(),p)}else Nt(2);l.G=0,l.l&&l.l.sa(h),rp(l),Qg(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Nt(2)):(this.j.info("Failed to ping google.com"),Nt(1))};function rp(l){if(l.G=0,l.ka=[],l.l){const h=Rg(l.h);(h.length!=0||l.i.length!=0)&&(R(l.ka,h),R(l.ka,l.i),l.h.i.length=0,A(l.i),l.i.length=0),l.l.ra()}}function np(l,h,p){var E=p instanceof Yn?Pr(p):new Yn(p);if(E.g!="")h&&(E.g=h+"."+E.g),Bo(E,E.s);else{var M=c.location;E=M.protocol,h=h?h+"."+M.hostname:M.hostname,M=+M.port;var L=new Yn(null);E&&zo(L,E),h&&(L.g=h),M&&Bo(L,M),p&&(L.l=p),E=L}return p=l.D,h=l.ya,p&&h&&ke(E,p,h),ke(E,"VER",l.la),ta(l,E),E}function sp(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new Me(new Ho({eb:p})):new Me(l.pa),h.Ha(l.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function ip(){}t=ip.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Jo(){}Jo.prototype.g=function(l,h){return new Ut(l,h)};function Ut(l,h){ut.call(this),this.g=new Kg(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!N(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!N(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new Ps(this)}j(Ut,ut),Ut.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ut.prototype.close=function(){zu(this.g)},Ut.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=Iu(l),l=p);h.i.push(new sk(h.Ya++,l)),h.G==3&&Qo(h)},Ut.prototype.N=function(){this.g.l=null,delete this.j,zu(this.g),delete this.g,Ut.aa.N.call(this)};function ap(l){Pu.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(const p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}j(ap,Pu);function op(){Ru.call(this),this.status=1}j(op,Ru);function Ps(l){this.g=l}j(Ps,ip),Ps.prototype.ua=function(){kt(this.g,"a")},Ps.prototype.ta=function(l){kt(this.g,new ap(l))},Ps.prototype.sa=function(l){kt(this.g,new op)},Ps.prototype.ra=function(){kt(this.g,"b")},Jo.prototype.createWebChannel=Jo.prototype.g,Ut.prototype.send=Ut.prototype.o,Ut.prototype.open=Ut.prototype.m,Ut.prototype.close=Ut.prototype.close,mb=function(){return new Jo},hb=function(){return Vo()},db=Kn,Vh={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fo.NO_ERROR=0,Fo.TIMEOUT=8,Fo.HTTP_ERROR=6,Vl=Fo,kg.COMPLETE="complete",ub=kg,xg.EventType=qi,qi.OPEN="a",qi.CLOSE="b",qi.ERROR="c",qi.MESSAGE="d",ut.prototype.listen=ut.prototype.K,ya=xg,Me.prototype.listenOnce=Me.prototype.L,Me.prototype.getLastError=Me.prototype.Ka,Me.prototype.getLastErrorCode=Me.prototype.Ba,Me.prototype.getStatus=Me.prototype.Z,Me.prototype.getResponseJson=Me.prototype.Oa,Me.prototype.getResponseText=Me.prototype.oa,Me.prototype.send=Me.prototype.ea,Me.prototype.setWithCredentials=Me.prototype.Ha,cb=Me}).apply(typeof yl<"u"?yl:typeof self<"u"?self:typeof window<"u"?window:{});const ey="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};yt.UNAUTHENTICATED=new yt(null),yt.GOOGLE_CREDENTIALS=new yt("google-credentials-uid"),yt.FIRST_PARTY=new yt("first-party-uid"),yt.MOCK_USER=new yt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vi="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vs=new nf("@firebase/firestore");function ua(){return vs.logLevel}function K(t,...e){if(vs.logLevel<=le.DEBUG){const r=e.map(pf);vs.debug(`Firestore (${Vi}): ${t}`,...r)}}function Yr(t,...e){if(vs.logLevel<=le.ERROR){const r=e.map(pf);vs.error(`Firestore (${Vi}): ${t}`,...r)}}function wi(t,...e){if(vs.logLevel<=le.WARN){const r=e.map(pf);vs.warn(`Firestore (${Vi}): ${t}`,...r)}}function pf(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function re(t="Unexpected state"){const e=`FIRESTORE (${Vi}) INTERNAL ASSERTION FAILED: `+t;throw Yr(e),new Error(e)}function ye(t,e){t||re()}function se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends nn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Br{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class XS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(yt.UNAUTHENTICATED))}shutdown(){}}class ZS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class eA{constructor(e){this.t=e,this.currentUser=yt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){ye(this.o===void 0);let n=this.i;const s=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let i=new Br;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Br,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},c=u=>{K("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(K("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Br)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(K("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ye(typeof n.accessToken=="string"),new fb(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string"),new yt(e)}}class tA{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=yt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class rA{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new tA(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(yt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nA{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sA{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){ye(this.o===void 0);const n=i=>{i.error!=null&&K("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,K("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{K("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):K("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(ye(typeof r.token=="string"),this.R=r.token,new nA(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gb{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=iA(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function fe(t,e){return t<e?-1:t>e?1:0}function bi(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new W(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new W(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new W(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ke.fromMillis(Date.now())}static fromDate(e){return Ke.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new Ke(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Ke(0,0))}static max(){return new ne(new Ke(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,r,n){r===void 0?r=0:r>e.length&&re(),n===void 0?n=e.length-r:n>e.length-r&&re(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return ro.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof ro?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),o=r.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Ee extends ro{construct(e,r,n){return new Ee(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new W(F.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Ee(r)}static emptyPath(){return new Ee([])}}const aA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends ro{construct(e,r,n){return new it(e,r,n)}static isValidIdentifier(e){return aA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new it(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new W(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;s<e.length;){const c=e[s];if(c==="\\"){if(s+1===e.length)throw new W(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new W(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,s+=2}else c==="`"?(o=!o,s++):c!=="."||o?(n+=c,s++):(i(),s++)}if(i(),o)throw new W(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new it(r)}static emptyPath(){return new it([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{constructor(e){this.path=e}static fromPath(e){return new Y(Ee.fromString(e))}static fromName(e){return new Y(Ee.fromString(e).popFirst(5))}static empty(){return new Y(Ee.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ee.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Ee.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new Ee(e.slice()))}}function oA(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=ne.fromTimestamp(n===1e9?new Ke(r+1,0):new Ke(r,n));return new Un(s,Y.empty(),e)}function lA(t){return new Un(t.readTime,t.key,-1)}class Un{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Un(ne.min(),Y.empty(),-1)}static max(){return new Un(ne.max(),Y.empty(),-1)}}function cA(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Y.comparator(t.documentKey,e.documentKey),r!==0?r:fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ko(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==uA)throw t;K("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&re(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new $((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof $?r:$.resolve(r)}catch(r){return $.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):$.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):$.reject(r)}static resolve(e){return new $((r,n)=>{r(e)})}static reject(e){return new $((r,n)=>{n(e)})}static waitFor(e){return new $((r,n)=>{let s=0,i=0,o=!1;e.forEach(c=>{++s,c.next(()=>{++i,o&&i===s&&r()},u=>n(u))}),o=!0,i===s&&r()})}static or(e){let r=$.resolve(!1);for(const n of e)r=r.next(s=>s?$.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new $((n,s)=>{const i=e.length,o=new Array(i);let c=0;for(let u=0;u<i;u++){const d=u;r(e[d]).next(f=>{o[d]=f,++c,c===i&&n(o)},f=>s(f))}})}static doWhile(e,r){return new $((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function hA(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function No(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}yf.oe=-1;function su(t){return t==null}function _c(t){return t===0&&1/t==-1/0}function mA(t){return typeof t=="number"&&Number.isInteger(t)&&!_c(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function js(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function pb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e,r){this.comparator=e,this.root=r||st.EMPTY}insert(e,r){return new Re(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,st.BLACK,null,null))}remove(e){return new Re(this.comparator,this.root.remove(e,this.comparator).copy(null,null,st.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xl(this.root,e,this.comparator,!1)}getReverseIterator(){return new xl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xl(this.root,e,this.comparator,!0)}}class xl{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class st{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??st.RED,this.left=s??st.EMPTY,this.right=i??st.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new st(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return st.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return st.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,st.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,st.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw re();const e=this.left.check();if(e!==this.right.check())throw re();return e+(this.isRed()?0:1)}}st.EMPTY=null,st.RED=!0,st.BLACK=!1;st.EMPTY=new class{constructor(){this.size=0}get key(){throw re()}get value(){throw re()}get color(){throw re()}get left(){throw re()}get right(){throw re()}copy(e,r,n,s,i){return this}insert(e,r,n){return new st(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.comparator=e,this.data=new Re(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new ry(this.data.getIterator())}getIteratorFrom(e){return new ry(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof ot)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new ot(this.comparator);return r.data=e,r}}class ry{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new Ht([])}unionWith(e){let r=new ot(it.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ht(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return bi(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new yb("Invalid base64 string: "+i):i}}(e);return new ct(r)}static fromUint8Array(e){const r=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ct(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ct.EMPTY_BYTE_STRING=new ct("");const fA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $n(t){if(ye(!!t),typeof t=="string"){let e=0;const r=fA.exec(t);if(ye(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:$e(t.seconds),nanos:$e(t.nanos)}}function $e(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ws(t){return typeof t=="string"?ct.fromBase64String(t):ct.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xf(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function vf(t){const e=t.mapValue.fields.__previous_value__;return xf(e)?vf(e):e}function no(t){const e=$n(t.mapValue.fields.__local_write_time__.timestampValue);return new Ke(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,r,n,s,i,o,c,u,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d}}class so{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new so("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof so&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vl={mapValue:{}};function bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?xf(t)?4:yA(t)?9007199254740991:pA(t)?10:11:re()}function jr(t,e){if(t===e)return!0;const r=bs(t);if(r!==bs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return no(t).isEqual(no(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=$n(s.timestampValue),c=$n(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ws(s.bytesValue).isEqual(ws(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return $e(s.geoPointValue.latitude)===$e(i.geoPointValue.latitude)&&$e(s.geoPointValue.longitude)===$e(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return $e(s.integerValue)===$e(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=$e(s.doubleValue),c=$e(i.doubleValue);return o===c?_c(o)===_c(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return bi(t.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},c=i.mapValue.fields||{};if(ty(o)!==ty(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!jr(o[u],c[u])))return!1;return!0}(t,e);default:return re()}}function io(t,e){return(t.values||[]).find(r=>jr(r,e))!==void 0}function _i(t,e){if(t===e)return 0;const r=bs(t),n=bs(e);if(r!==n)return fe(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return fe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=$e(i.integerValue||i.doubleValue),u=$e(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return ny(t.timestampValue,e.timestampValue);case 4:return ny(no(t),no(e));case 5:return fe(t.stringValue,e.stringValue);case 6:return function(i,o){const c=ws(i),u=ws(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),u=o.split("/");for(let d=0;d<c.length&&d<u.length;d++){const f=fe(c[d],u[d]);if(f!==0)return f}return fe(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=fe($e(i.latitude),$e(o.latitude));return c!==0?c:fe($e(i.longitude),$e(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return sy(t.arrayValue,e.arrayValue);case 10:return function(i,o){var c,u,d,f;const m=i.fields||{},v=o.fields||{},y=(c=m.value)===null||c===void 0?void 0:c.arrayValue,j=(u=v.value)===null||u===void 0?void 0:u.arrayValue,A=fe(((d=y==null?void 0:y.values)===null||d===void 0?void 0:d.length)||0,((f=j==null?void 0:j.values)===null||f===void 0?void 0:f.length)||0);return A!==0?A:sy(y,j)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===vl.mapValue&&o===vl.mapValue)return 0;if(i===vl.mapValue)return 1;if(o===vl.mapValue)return-1;const c=i.fields||{},u=Object.keys(c),d=o.fields||{},f=Object.keys(d);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){const v=fe(u[m],f[m]);if(v!==0)return v;const y=_i(c[u[m]],d[f[m]]);if(y!==0)return y}return fe(u.length,f.length)}(t.mapValue,e.mapValue);default:throw re()}}function ny(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return fe(t,e);const r=$n(t),n=$n(e),s=fe(r.seconds,n.seconds);return s!==0?s:fe(r.nanos,n.nanos)}function sy(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=_i(r[s],n[s]);if(i)return i}return fe(r.length,n.length)}function ki(t){return Fh(t)}function Fh(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=$n(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return ws(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Y.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=Fh(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const o of n)i?i=!1:s+=",",s+=`${o}:${Fh(r.fields[o])}`;return s+"}"}(t.mapValue):re()}function iy(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Uh(t){return!!t&&"integerValue"in t}function wf(t){return!!t&&"arrayValue"in t}function ay(t){return!!t&&"nullValue"in t}function oy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fl(t){return!!t&&"mapValue"in t}function pA(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Ca(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return js(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Ca(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Ca(t.arrayValue.values[r]);return e}return Object.assign({},t)}function yA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.value=e}static empty(){return new Pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Fl(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ca(r)}setAll(e){let r=it.emptyPath(),n={},s=[];e.forEach((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,s),n={},s=[],r=c.popLast()}o?n[c.lastSegment()]=Ca(o):s.push(c.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());Fl(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];Fl(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){js(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Pt(Ca(this.value))}}function xb(t){const e=[];return js(t.fields,(r,n)=>{const s=new it([r]);if(Fl(n)){const i=xb(n.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Ht(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e,r,n,s,i,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new vt(e,0,ne.min(),ne.min(),ne.min(),Pt.empty(),0)}static newFoundDocument(e,r,n,s){return new vt(e,1,r,ne.min(),n,s,0)}static newNoDocument(e,r){return new vt(e,2,r,ne.min(),ne.min(),Pt.empty(),0)}static newUnknownDocument(e,r){return new vt(e,3,r,ne.min(),ne.min(),Pt.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof vt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new vt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e,r){this.position=e,this.inclusive=r}}function ly(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?n=Y.comparator(Y.fromName(o.referenceValue),r.key):n=_i(o,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function cy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!jr(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(e,r="asc"){this.field=e,this.dir=r}}function xA(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vb=class{};class Ge extends vb{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new wA(e,r,n):r==="array-contains"?new kA(e,n):r==="in"?new NA(e,n):r==="not-in"?new EA(e,n):r==="array-contains-any"?new jA(e,n):new Ge(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new bA(e,n):new _A(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(_i(r,this.value)):r!==null&&bs(this.value)===bs(r)&&this.matchesComparison(_i(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return re()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mr extends vb{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new mr(e,r)}matches(e){return wb(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function wb(t){return t.op==="and"}function bb(t){return vA(t)&&wb(t)}function vA(t){for(const e of t.filters)if(e instanceof mr)return!1;return!0}function $h(t){if(t instanceof Ge)return t.field.canonicalString()+t.op.toString()+ki(t.value);if(bb(t))return t.filters.map(e=>$h(e)).join(",");{const e=t.filters.map(r=>$h(r)).join(",");return`${t.op}(${e})`}}function _b(t,e){return t instanceof Ge?function(n,s){return s instanceof Ge&&n.op===s.op&&n.field.isEqual(s.field)&&jr(n.value,s.value)}(t,e):t instanceof mr?function(n,s){return s instanceof mr&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,o,c)=>i&&_b(o,s.filters[c]),!0):!1}(t,e):void re()}function kb(t){return t instanceof Ge?function(r){return`${r.field.canonicalString()} ${r.op} ${ki(r.value)}`}(t):t instanceof mr?function(r){return r.op.toString()+" {"+r.getFilters().map(kb).join(" ,")+"}"}(t):"Filter"}class wA extends Ge{constructor(e,r,n){super(e,r,n),this.key=Y.fromName(n.referenceValue)}matches(e){const r=Y.comparator(e.key,this.key);return this.matchesComparison(r)}}class bA extends Ge{constructor(e,r){super(e,"in",r),this.keys=Nb("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class _A extends Ge{constructor(e,r){super(e,"not-in",r),this.keys=Nb("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function Nb(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Y.fromName(n.referenceValue))}class kA extends Ge{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return wf(r)&&io(r.arrayValue,this.value)}}class NA extends Ge{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&io(this.value.arrayValue,r)}}class EA extends Ge{constructor(e,r){super(e,"not-in",r)}matches(e){if(io(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!io(this.value.arrayValue,r)}}class jA extends Ge{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!wf(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>io(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{constructor(e,r=null,n=[],s=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=o,this.endAt=c,this.ue=null}}function uy(t,e=null,r=[],n=[],s=null,i=null,o=null){return new TA(t,e,r,n,s,i,o)}function bf(t){const e=se(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>$h(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),su(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>ki(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>ki(n)).join(",")),e.ue=r}return e.ue}function _f(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!xA(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!_b(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!cy(t.startAt,e.startAt)&&cy(t.endAt,e.endAt)}function zh(t){return Y.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e,r=null,n=[],s=[],i=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function SA(t,e,r,n,s,i,o,c){return new Fi(t,e,r,n,s,i,o,c)}function iu(t){return new Fi(t)}function dy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Eb(t){return t.collectionGroup!==null}function Pa(t){const e=se(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new ot(it.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new ao(i,n))}),r.has(it.keyField().canonicalString())||e.ce.push(new ao(it.keyField(),n))}return e.ce}function Nr(t){const e=se(t);return e.le||(e.le=AA(e,Pa(t))),e.le}function AA(t,e){if(t.limitType==="F")return uy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ao(s.field,i)});const r=t.endAt?new kc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new kc(t.startAt.position,t.startAt.inclusive):null;return uy(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Bh(t,e){const r=t.filters.concat([e]);return new Fi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Nc(t,e,r){return new Fi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function au(t,e){return _f(Nr(t),Nr(e))&&t.limitType===e.limitType}function jb(t){return`${bf(Nr(t))}|lt:${t.limitType}`}function Ls(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>kb(s)).join(", ")}]`),su(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>ki(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>ki(s)).join(",")),`Target(${n})`}(Nr(t))}; limitType=${t.limitType})`}function ou(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):Y.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of Pa(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(o,c,u){const d=ly(o,c,u);return o.inclusive?d<=0:d<0}(n.startAt,Pa(n),s)||n.endAt&&!function(o,c,u){const d=ly(o,c,u);return o.inclusive?d>=0:d>0}(n.endAt,Pa(n),s))}(t,e)}function IA(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Tb(t){return(e,r)=>{let n=!1;for(const s of Pa(t)){const i=CA(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function CA(t,e,r){const n=t.field.isKeyField()?Y.comparator(e.key,r.key):function(i,o,c){const u=o.data.field(i),d=c.data.field(i);return u!==null&&d!==null?_i(u,d):re()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return re()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){js(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return pb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PA=new Re(Y.comparator);function Jr(){return PA}const Sb=new Re(Y.comparator);function xa(...t){let e=Sb;for(const r of t)e=e.insert(r.key,r);return e}function Ab(t){let e=Sb;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function is(){return Ra()}function Ib(){return Ra()}function Ra(){return new Ui(t=>t.toString(),(t,e)=>t.isEqual(e))}const RA=new Re(Y.comparator),DA=new ot(Y.comparator);function oe(...t){let e=DA;for(const r of t)e=e.add(r);return e}const MA=new ot(fe);function LA(){return MA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_c(e)?"-0":e}}function Cb(t){return{integerValue:""+t}}function Pb(t,e){return mA(e)?Cb(e):kf(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(){this._=void 0}}function OA(t,e,r){return t instanceof oo?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&xf(i)&&(i=vf(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(r,e):t instanceof Ni?Db(t,e):t instanceof Ei?Mb(t,e):function(s,i){const o=Rb(s,i),c=hy(o)+hy(s.Pe);return Uh(o)&&Uh(s.Pe)?Cb(c):kf(s.serializer,c)}(t,e)}function VA(t,e,r){return t instanceof Ni?Db(t,e):t instanceof Ei?Mb(t,e):r}function Rb(t,e){return t instanceof lo?function(n){return Uh(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class oo extends lu{}class Ni extends lu{constructor(e){super(),this.elements=e}}function Db(t,e){const r=Lb(e);for(const n of t.elements)r.some(s=>jr(s,n))||r.push(n);return{arrayValue:{values:r}}}class Ei extends lu{constructor(e){super(),this.elements=e}}function Mb(t,e){let r=Lb(e);for(const n of t.elements)r=r.filter(s=>!jr(s,n));return{arrayValue:{values:r}}}class lo extends lu{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function hy(t){return $e(t.integerValue||t.doubleValue)}function Lb(t){return wf(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,r){this.field=e,this.transform=r}}function FA(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Ni&&s instanceof Ni||n instanceof Ei&&s instanceof Ei?bi(n.elements,s.elements,jr):n instanceof lo&&s instanceof lo?jr(n.Pe,s.Pe):n instanceof oo&&s instanceof oo}(t.transform,e.transform)}class UA{constructor(e,r){this.version=e,this.transformResults=r}}class Ot{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Ot}static exists(e){return new Ot(void 0,e)}static updateTime(e){return new Ot(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ul(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class uu{}function Ob(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Nf(t.key,Ot.none()):new Eo(t.key,t.data,Ot.none());{const r=t.data,n=Pt.empty();let s=new ot(it.comparator);for(let i of e.fields)if(!s.has(i)){let o=r.field(i);o===null&&i.length>1&&(i=i.popLast(),o=r.field(i)),o===null?n.delete(i):n.set(i,o),s=s.add(i)}return new Gn(t.key,n,new Ht(s.toArray()),Ot.none())}}function $A(t,e,r){t instanceof Eo?function(s,i,o){const c=s.value.clone(),u=fy(s.fieldTransforms,i,o.transformResults);c.setAll(u),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Gn?function(s,i,o){if(!Ul(s.precondition,i))return void i.convertToUnknownDocument(o.version);const c=fy(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(Vb(s)),u.setAll(c),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function Da(t,e,r,n){return t instanceof Eo?function(i,o,c,u){if(!Ul(i.precondition,o))return c;const d=i.value.clone(),f=gy(i.fieldTransforms,u,o);return d.setAll(f),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Gn?function(i,o,c,u){if(!Ul(i.precondition,o))return c;const d=gy(i.fieldTransforms,u,o),f=o.data;return f.setAll(Vb(i)),f.setAll(d),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,r,n):function(i,o,c){return Ul(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,r)}function zA(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=Rb(n.transform,s||null);i!=null&&(r===null&&(r=Pt.empty()),r.set(n.field,i))}return r||null}function my(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&bi(n,s,(i,o)=>FA(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Eo extends uu{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Gn extends uu{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Vb(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function fy(t,e,r){const n=new Map;ye(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],o=i.transform,c=e.data.field(i.field);n.set(i.field,VA(o,c,r[s]))}return n}function gy(t,e,r){const n=new Map;for(const s of t){const i=s.transform,o=r.data.field(s.field);n.set(s.field,OA(i,o,e))}return n}class Nf extends uu{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BA extends uu{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&$A(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Da(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Da(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=Ib();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=r.has(s.key)?null:c;const u=Ob(o,c);u!==null&&n.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(ne.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),oe())}isEqual(e){return this.batchId===e.batchId&&bi(this.mutations,e.mutations,(r,n)=>my(r,n))&&bi(this.baseMutations,e.baseMutations,(r,n)=>my(r,n))}}class Ef{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){ye(e.mutations.length===n.length);let s=function(){return RA}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,n[o].version);return new Ef(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HA{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WA{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be,ce;function GA(t){switch(t){default:return re();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function Fb(t){if(t===void 0)return Yr("GRPC error has no .code"),F.UNKNOWN;switch(t){case Be.OK:return F.OK;case Be.CANCELLED:return F.CANCELLED;case Be.UNKNOWN:return F.UNKNOWN;case Be.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Be.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Be.INTERNAL:return F.INTERNAL;case Be.UNAVAILABLE:return F.UNAVAILABLE;case Be.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Be.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Be.NOT_FOUND:return F.NOT_FOUND;case Be.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Be.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Be.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Be.ABORTED:return F.ABORTED;case Be.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Be.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Be.DATA_LOSS:return F.DATA_LOSS;default:return re()}}(ce=Be||(Be={}))[ce.OK=0]="OK",ce[ce.CANCELLED=1]="CANCELLED",ce[ce.UNKNOWN=2]="UNKNOWN",ce[ce.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ce[ce.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ce[ce.NOT_FOUND=5]="NOT_FOUND",ce[ce.ALREADY_EXISTS=6]="ALREADY_EXISTS",ce[ce.PERMISSION_DENIED=7]="PERMISSION_DENIED",ce[ce.UNAUTHENTICATED=16]="UNAUTHENTICATED",ce[ce.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ce[ce.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ce[ce.ABORTED=10]="ABORTED",ce[ce.OUT_OF_RANGE=11]="OUT_OF_RANGE",ce[ce.UNIMPLEMENTED=12]="UNIMPLEMENTED",ce[ce.INTERNAL=13]="INTERNAL",ce[ce.UNAVAILABLE=14]="UNAVAILABLE",ce[ce.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QA=new cs([4294967295,4294967295],0);function py(t){const e=KA().encode(t),r=new lb;return r.update(e),new Uint8Array(r.digest())}function yy(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new cs([r,n],0),new cs([s,i],0)]}class jf{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new va(`Invalid padding: ${r}`);if(n<0)throw new va(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new va(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new va(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=cs.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(cs.fromNumber(n)));return s.compare(QA)===1&&(s=new cs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=py(e),[n,s]=yy(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);if(!this.de(o))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new jf(i,s,r);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.Ie===0)return;const r=py(e),[n,s]=yy(r);for(let i=0;i<this.hashCount;i++){const o=this.Ee(n,s,i);this.Ae(o)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class va extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,jo.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new du(ne.min(),s,new Re(fe),Jr(),oe())}}class jo{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new jo(n,r,oe(),oe(),oe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $l{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class Ub{constructor(e,r){this.targetId=e,this.me=r}}class $b{constructor(e,r,n=ct.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class xy{constructor(){this.fe=0,this.ge=wy(),this.pe=ct.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=oe(),r=oe(),n=oe();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:re()}}),new jo(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=wy()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ye(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class YA{constructor(e){this.Le=e,this.Be=new Map,this.ke=Jr(),this.qe=vy(),this.Qe=new Re(fe)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:re()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(zh(i))if(n===0){const o=new Y(i.path);this.Ue(r,o,vt.newNoDocument(o,ne.min()))}else ye(n===1);else{const o=this.Ye(r);if(o!==n){const c=this.Ze(e),u=c?this.Xe(c,e,o):1;if(u!==0){this.je(r);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,d)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let o,c;try{o=ws(n).toUint8Array()}catch(u){if(u instanceof yb)return wi("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new jf(o,s,i)}catch(u){return wi(u instanceof va?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const o=this.Le.tt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,o)=>{const c=this.Je(o);if(c){if(i.current&&zh(c.target)){const u=new Y(c.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,vt.newNoDocument(u,e))}i.be&&(r.set(o,i.ve()),i.Ce())}});let n=oe();this.qe.forEach((i,o)=>{let c=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new du(e,r,this.Qe,this.ke,n);return this.ke=Jr(),this.qe=vy(),this.Qe=new Re(fe),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new xy,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new ot(fe),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||K("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new xy),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function vy(){return new Re(Y.comparator)}function wy(){return new Re(Y.comparator)}const JA={asc:"ASCENDING",desc:"DESCENDING"},XA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ZA={and:"AND",or:"OR"};class eI{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function qh(t,e){return t.useProto3Json||su(e)?e:{value:e}}function Ec(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function tI(t,e){return Ec(t,e.toTimestamp())}function Er(t){return ye(!!t),ne.fromTimestamp(function(r){const n=$n(r);return new Ke(n.seconds,n.nanos)}(t))}function Tf(t,e){return Hh(t,e).canonicalString()}function Hh(t,e){const r=function(s){return new Ee(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Bb(t){const e=Ee.fromString(t);return ye(Kb(e)),e}function Wh(t,e){return Tf(t.databaseId,e.path)}function Td(t,e){const r=Bb(e);if(r.get(1)!==t.databaseId.projectId)throw new W(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new W(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Y(Hb(r))}function qb(t,e){return Tf(t.databaseId,e)}function rI(t){const e=Bb(t);return e.length===4?Ee.emptyPath():Hb(e)}function Gh(t){return new Ee(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Hb(t){return ye(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function by(t,e,r){return{name:Wh(t,e),fields:r.value.mapValue.fields}}function nI(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:re()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,f){return d.useProto3Json?(ye(f===void 0||typeof f=="string"),ct.fromBase64String(f||"")):(ye(f===void 0||f instanceof Buffer||f instanceof Uint8Array),ct.fromUint8Array(f||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(d){const f=d.code===void 0?F.UNKNOWN:Fb(d.code);return new W(f,d.message||"")}(o);r=new $b(n,s,i,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=Td(t,n.document.name),i=Er(n.document.updateTime),o=n.document.createTime?Er(n.document.createTime):ne.min(),c=new Pt({mapValue:{fields:n.document.fields}}),u=vt.newFoundDocument(s,i,o,c),d=n.targetIds||[],f=n.removedTargetIds||[];r=new $l(d,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=Td(t,n.document),i=n.readTime?Er(n.readTime):ne.min(),o=vt.newNoDocument(s,i),c=n.removedTargetIds||[];r=new $l([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=Td(t,n.document),i=n.removedTargetIds||[];r=new $l([],i,s,null)}else{if(!("filter"in e))return re();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,o=new WA(s,i),c=n.targetId;r=new Ub(c,o)}}return r}function sI(t,e){let r;if(e instanceof Eo)r={update:by(t,e.key,e.value)};else if(e instanceof Nf)r={delete:Wh(t,e.key)};else if(e instanceof Gn)r={update:by(t,e.key,e.data),updateMask:mI(e.fieldMask)};else{if(!(e instanceof BA))return re();r={verify:Wh(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,o){const c=o.transform;if(c instanceof oo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ni)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ei)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof lo)return{fieldPath:o.field.canonicalString(),increment:c.Pe};throw re()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:tI(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:re()}(t,e.precondition)),r}function iI(t,e){return t&&t.length>0?(ye(e!==void 0),t.map(r=>function(s,i){let o=s.updateTime?Er(s.updateTime):Er(i);return o.isEqual(ne.min())&&(o=Er(i)),new UA(o,s.transformResults||[])}(r,e))):[]}function aI(t,e){return{documents:[qb(t,e.path)]}}function oI(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=qb(t,s);const i=function(d){if(d.length!==0)return Gb(mr.create(d,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(f=>function(v){return{field:Os(v.field),direction:uI(v.dir)}}(f))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=qh(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:r,parent:s}}function lI(t){let e=rI(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){ye(n===1);const f=r.from[0];f.allDescendants?s=f.collectionId:e=e.child(f.collectionId)}let i=[];r.where&&(i=function(m){const v=Wb(m);return v instanceof mr&&bb(v)?v.getFilters():[v]}(r.where));let o=[];r.orderBy&&(o=function(m){return m.map(v=>function(j){return new ao(Vs(j.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(j.direction))}(v))}(r.orderBy));let c=null;r.limit&&(c=function(m){let v;return v=typeof m=="object"?m.value:m,su(v)?null:v}(r.limit));let u=null;r.startAt&&(u=function(m){const v=!!m.before,y=m.values||[];return new kc(y,v)}(r.startAt));let d=null;return r.endAt&&(d=function(m){const v=!m.before,y=m.values||[];return new kc(y,v)}(r.endAt)),SA(e,s,o,i,c,"F",u,d)}function cI(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return re()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function Wb(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Vs(r.unaryFilter.field);return Ge.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Vs(r.unaryFilter.field);return Ge.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Vs(r.unaryFilter.field);return Ge.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Vs(r.unaryFilter.field);return Ge.create(o,"!=",{nullValue:"NULL_VALUE"});default:return re()}}(t):t.fieldFilter!==void 0?function(r){return Ge.create(Vs(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return re()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return mr.create(r.compositeFilter.filters.map(n=>Wb(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return re()}}(r.compositeFilter.op))}(t):re()}function uI(t){return JA[t]}function dI(t){return XA[t]}function hI(t){return ZA[t]}function Os(t){return{fieldPath:t.canonicalString()}}function Vs(t){return it.fromServerFormat(t.fieldPath)}function Gb(t){return t instanceof Ge?function(r){if(r.op==="=="){if(oy(r.value))return{unaryFilter:{field:Os(r.field),op:"IS_NAN"}};if(ay(r.value))return{unaryFilter:{field:Os(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(oy(r.value))return{unaryFilter:{field:Os(r.field),op:"IS_NOT_NAN"}};if(ay(r.value))return{unaryFilter:{field:Os(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Os(r.field),op:dI(r.op),value:r.value}}}(t):t instanceof mr?function(r){const n=r.getFilters().map(s=>Gb(s));return n.length===1?n[0]:{compositeFilter:{op:hI(r.op),filters:n}}}(t):re()}function mI(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Kb(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,r,n,s,i=ne.min(),o=ne.min(),c=ct.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new Nn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Nn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e){this.ct=e}}function gI(t){const e=lI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Nc(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(){this.un=new yI}addToCollectionParentIndex(e,r){return this.un.add(r),$.resolve()}getCollectionParents(e,r){return $.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return $.resolve()}deleteFieldIndex(e,r){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,r){return $.resolve()}getDocumentsMatchingTarget(e,r){return $.resolve(null)}getIndexType(e,r){return $.resolve(0)}getFieldIndexes(e,r){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,r){return $.resolve(Un.min())}getMinOffsetFromCollectionGroup(e,r){return $.resolve(Un.min())}updateCollectionGroup(e,r,n){return $.resolve()}updateIndexEntries(e,r){return $.resolve()}}class yI{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new ot(Ee.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new ot(Ee.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ji(0)}static kn(){return new ji(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(){this.changes=new Ui(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?$.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Da(n.mutation,s,Ht.empty(),Ke.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,oe()).next(()=>n))}getLocalViewOfDocuments(e,r,n=oe()){const s=is();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let o=xa();return i.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=is();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,oe()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,c)=>{r.set(o,c)})})}computeViews(e,r,n,s){let i=Jr();const o=Ra(),c=function(){return Ra()}();return r.forEach((u,d)=>{const f=n.get(d.key);s.has(d.key)&&(f===void 0||f.mutation instanceof Gn)?i=i.insert(d.key,d):f!==void 0?(o.set(d.key,f.mutation.getFieldMask()),Da(f.mutation,d,f.mutation.getFieldMask(),Ke.now())):o.set(d.key,Ht.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,f)=>o.set(d,f)),r.forEach((d,f)=>{var m;return c.set(d,new vI(f,(m=o.get(d))!==null&&m!==void 0?m:null))}),c))}recalculateAndSaveOverlays(e,r){const n=Ra();let s=new Re((o,c)=>o-c),i=oe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const c of o)c.keys().forEach(u=>{const d=r.get(u);if(d===null)return;let f=n.get(u)||Ht.empty();f=c.applyToLocalView(d,f),n.set(u,f);const m=(s.get(c.batchId)||oe()).add(u);s=s.insert(c.batchId,m)})}).next(()=>{const o=[],c=s.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),d=u.key,f=u.value,m=Ib();f.forEach(v=>{if(!i.has(v)){const y=Ob(r.get(v),n.get(v));y!==null&&m.set(v,y),i=i.add(v)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return $.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(o){return Y.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Eb(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):$.resolve(is());let c=-1,u=i;return o.next(d=>$.forEach(d,(f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(f)?$.resolve():this.remoteDocumentCache.getEntry(e,f).next(v=>{u=u.insert(f,v)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,oe())).next(f=>({batchId:c,changes:Ab(f)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Y(r)).next(n=>{let s=xa();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let o=xa();return this.indexManager.getCollectionParents(e,i).next(c=>$.forEach(c,u=>{const d=function(m,v){return new Fi(v,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(r,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,n,s).next(f=>{f.forEach((m,v)=>{o=o.insert(m,v)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(o=>{i.forEach((u,d)=>{const f=d.getKey();o.get(f)===null&&(o=o.insert(f,vt.newInvalidDocument(f)))});let c=xa();return o.forEach((u,d)=>{const f=i.get(u);f!==void 0&&Da(f.mutation,d,Ht.empty(),Ke.now()),ou(r,d)&&(c=c.insert(u,d))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return $.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Er(s.createTime)}}(r)),$.resolve()}getNamedQuery(e,r){return $.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:gI(s.bundledQuery),readTime:Er(s.readTime)}}(r)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(){this.overlays=new Re(Y.comparator),this.Ir=new Map}getOverlay(e,r){return $.resolve(this.overlays.get(r))}getOverlays(e,r){const n=is();return $.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),$.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),$.resolve()}getOverlaysForCollection(e,r,n){const s=is(),i=r.length+1,o=new Y(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,d=u.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>n&&s.set(u.getKey(),u)}return $.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Re((d,f)=>d-f);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let f=i.get(d.largestBatchId);f===null&&(f=is(),i=i.insert(d.largestBatchId,f)),f.set(d.getKey(),d)}}const c=is(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,f)=>c.set(d,f)),!(c.size()>=s)););return $.resolve(c)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new HA(r,n));let i=this.Ir.get(r);i===void 0&&(i=oe(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(){this.sessionToken=ct.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(){this.Tr=new ot(Je.Er),this.dr=new ot(Je.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new Je(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new Je(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new Y(new Ee([])),n=new Je(r,e),s=new Je(r,e+1),i=[];return this.dr.forEachInRange([n,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new Y(new Ee([])),n=new Je(r,e),s=new Je(r,e+1);let i=oe();return this.dr.forEachInRange([n,s],o=>{i=i.add(o.key)}),i}containsKey(e){const r=new Je(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Je{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return Y.comparator(e.key,r.key)||fe(e.wr,r.wr)}static Ar(e,r){return fe(e.wr,r.wr)||Y.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NI{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new ot(Je.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new qA(i,r,n,s);this.mutationQueue.push(o);for(const c of s)this.br=this.br.add(new Je(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,r){return $.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Je(r,0),s=new Je(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],o=>{const c=this.Dr(o.wr);i.push(c)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new ot(fe);return r.forEach(s=>{const i=new Je(s,0),o=new Je(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],c=>{n=n.add(c.wr)})}),$.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;Y.isDocumentKey(i)||(i=i.child(""));const o=new Je(new Y(i),0);let c=new ot(fe);return this.br.forEachWhile(u=>{const d=u.key.path;return!!n.isPrefixOf(d)&&(d.length===s&&(c=c.add(u.wr)),!0)},o),$.resolve(this.Cr(c))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){ye(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return $.forEach(r.mutations,s=>{const i=new Je(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new Je(r,0),s=this.br.firstAfterOrEqual(n);return $.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EI{constructor(e){this.Mr=e,this.docs=function(){return new Re(Y.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,o=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return $.resolve(n?n.document.mutableCopy():vt.newInvalidDocument(r))}getEntries(e,r){let n=Jr();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():vt.newInvalidDocument(s))}),$.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Jr();const o=r.path,c=new Y(o.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:d,value:{document:f}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||cA(lA(f),n)<=0||(s.has(f.key)||ou(r,f))&&(i=i.insert(f.key,f.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,r,n,s){re()}Or(e,r){return $.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new jI(this)}getSize(e){return $.resolve(this.size)}}class jI extends xI{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),$.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(e){this.persistence=e,this.Nr=new Ui(r=>bf(r),_f),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Sf,this.targetCount=0,this.kr=ji.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),$.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new ji(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,$.resolve()}updateTargetData(e,r){return this.Kn(r),$.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),s++)}),$.waitFor(i).next(()=>s)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return $.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),$.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),$.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return $.resolve(n)}containsKey(e,r){return $.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,r){this.qr={},this.overlays={},this.Qr=new yf(0),this.Kr=!1,this.Kr=!0,this.$r=new kI,this.referenceDelegate=e(this),this.Ur=new TI(this),this.indexManager=new pI,this.remoteDocumentCache=function(s){return new EI(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new fI(r),this.Gr=new bI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new _I,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new NI(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){K("MemoryPersistence","Starting transaction:",e);const s=new AI(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return $.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class AI extends dA{constructor(e){super(),this.currentSequenceNumber=e}}class Af{constructor(e){this.persistence=e,this.Jr=new Sf,this.Yr=null}static Zr(e){return new Af(e)}get Xr(){if(this.Yr)return this.Yr;throw re()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),$.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),$.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),$.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,n=>{const s=Y.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,ne.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return $.or([()=>$.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=oe(),s=oe();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new If(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return wE()?8:hA(_t())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new II;return this.Xi(e,r,o).next(c=>{if(i.result=c,this.zi)return this.es(e,r,o,c.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(ua()<=le.DEBUG&&K("QueryEngine","SDK will not create cache indexes for query:",Ls(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):(ua()<=le.DEBUG&&K("QueryEngine","Query:",Ls(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(ua()<=le.DEBUG&&K("QueryEngine","The SDK decides to create cache indexes for query:",Ls(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Nr(r))):$.resolve())}Yi(e,r){if(dy(r))return $.resolve(null);let n=Nr(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=Nc(r,null,"F"),n=Nr(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const o=oe(...i);return this.Ji.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const d=this.ts(r,c);return this.ns(r,d,o,u.readTime)?this.Yi(e,Nc(r,null,"F")):this.rs(e,d,r,u)}))})))}Zi(e,r,n,s){return dy(r)||s.isEqual(ne.min())?$.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const o=this.ts(r,i);return this.ns(r,o,n,s)?$.resolve(null):(ua()<=le.DEBUG&&K("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ls(r)),this.rs(e,o,r,oA(s,-1)).next(c=>c))})}ts(e,r){let n=new ot(Tb(e));return r.forEach((s,i)=>{ou(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return ua()<=le.DEBUG&&K("QueryEngine","Using full collection scan to execute query:",Ls(r)),this.Ji.getDocumentsMatchingQuery(e,r,Un.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Re(fe),this._s=new Ui(i=>bf(i),_f),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new wI(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function RI(t,e,r,n){return new PI(t,e,r,n)}async function Qb(t,e){const r=se(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const o=[],c=[];let u=oe();for(const d of s){o.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}for(const d of i){c.push(d.batchId);for(const f of d.mutations)u=u.add(f.key)}return r.localDocuments.getDocuments(n,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:c}))})})}function DI(t,e){const r=se(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,f){const m=d.batch,v=m.keys();let y=$.resolve();return v.forEach(j=>{y=y.next(()=>f.getEntry(u,j)).next(A=>{const R=d.docVersions.get(j);ye(R!==null),A.version.compareTo(R)<0&&(m.applyToRemoteDocument(A,d),A.isValidDocument()&&(A.setReadTime(d.commitVersion),f.addEntry(A)))})}),y.next(()=>c.mutationQueue.removeMutationBatch(u,m))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=oe();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function Yb(t){const e=se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function MI(t,e){const r=se(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const c=[];e.targetChanges.forEach((f,m)=>{const v=s.get(m);if(!v)return;c.push(r.Ur.removeMatchingKeys(i,f.removedDocuments,m).next(()=>r.Ur.addMatchingKeys(i,f.addedDocuments,m)));let y=v.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?y=y.withResumeToken(ct.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):f.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(f.resumeToken,n)),s=s.insert(m,y),function(A,R,_){return A.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(v,y,f)&&c.push(r.Ur.updateTargetData(i,y))});let u=Jr(),d=oe();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(i,f))}),c.push(LI(i,o,e.documentUpdates).next(f=>{u=f.Ps,d=f.Is})),!n.isEqual(ne.min())){const f=r.Ur.getLastRemoteSnapshotVersion(i).next(m=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));c.push(f)}return $.waitFor(c).next(()=>o.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(r.os=s,i))}function LI(t,e,r){let n=oe(),s=oe();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let o=Jr();return r.forEach((c,u)=>{const d=i.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(c)),u.isNoDocument()&&u.version.isEqual(ne.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):K("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function OI(t,e){const r=se(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function VI(t,e){const r=se(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,$.resolve(s)):r.Ur.allocateTargetId(n).next(o=>(s=new Nn(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Kh(t,e,r){const n=se(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,o=>n.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!No(o))throw o;K("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function _y(t,e,r){const n=se(t);let s=ne.min(),i=oe();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,f){const m=se(u),v=m._s.get(f);return v!==void 0?$.resolve(m.os.get(v)):m.Ur.getTargetData(d,f)}(n,o,Nr(e)).next(c=>{if(c)return s=c.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(o,c.targetId).next(u=>{i=u})}).next(()=>n.ss.getDocumentsMatchingQuery(o,e,r?s:ne.min(),r?i:oe())).next(c=>(FI(n,IA(e),c),{documents:c,Ts:i})))}function FI(t,e,r){let n=t.us.get(e)||ne.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class ky{constructor(){this.activeTargetIds=LA()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class UI{constructor(){this.so=new ky,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ky,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){K("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){K("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wl=null;function Sd(){return wl===null?wl=function(){return 268435456+Math.round(2147483648*Math.random())}():wl++,"0x"+wl.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gt="WebChannelConnection";class qI extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,o){const c=Sd(),u=this.xo(r,n.toUriEncodedString());K("RestConnection",`Sending RPC '${r}' ${c}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(r,u,d,s).then(f=>(K("RestConnection",`Received RPC '${r}' ${c}: `,f),f),f=>{throw wi("RestConnection",`RPC '${r}' ${c} failed with error: `,f,"url: ",u,"request:",s),f})}Lo(r,n,s,i,o,c){return this.Mo(r,n,s,i,o)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vi}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,o)=>r[o]=i),s&&s.headers.forEach((i,o)=>r[o]=i)}xo(r,n){const s=zI[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=Sd();return new Promise((o,c)=>{const u=new cb;u.setWithCredentials(!0),u.listenOnce(ub.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Vl.NO_ERROR:const f=u.getResponseJson();K(gt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(f)),o(f);break;case Vl.TIMEOUT:K(gt,`RPC '${e}' ${i} timed out`),c(new W(F.DEADLINE_EXCEEDED,"Request time out"));break;case Vl.HTTP_ERROR:const m=u.getStatus();if(K(gt,`RPC '${e}' ${i} failed with status:`,m,"response text:",u.getResponseText()),m>0){let v=u.getResponseJson();Array.isArray(v)&&(v=v[0]);const y=v==null?void 0:v.error;if(y&&y.status&&y.message){const j=function(R){const _=R.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(_)>=0?_:F.UNKNOWN}(y.status);c(new W(j,y.message))}else c(new W(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new W(F.UNAVAILABLE,"Connection failed."));break;default:re()}}finally{K(gt,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);K(gt,`RPC '${e}' ${i} sending request:`,s),u.send(r,"POST",d,n,15)})}Bo(e,r,n){const s=Sd(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=mb(),c=hb(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const f=i.join("");K(gt,`Creating RPC '${e}' stream ${s}: ${f}`,u);const m=o.createWebChannel(f,u);let v=!1,y=!1;const j=new BI({Io:R=>{y?K(gt,`Not sending because RPC '${e}' stream ${s} is closed:`,R):(v||(K(gt,`Opening RPC '${e}' stream ${s} transport.`),m.open(),v=!0),K(gt,`RPC '${e}' stream ${s} sending:`,R),m.send(R))},To:()=>m.close()}),A=(R,_,N)=>{R.listen(_,I=>{try{N(I)}catch(P){setTimeout(()=>{throw P},0)}})};return A(m,ya.EventType.OPEN,()=>{y||(K(gt,`RPC '${e}' stream ${s} transport opened.`),j.yo())}),A(m,ya.EventType.CLOSE,()=>{y||(y=!0,K(gt,`RPC '${e}' stream ${s} transport closed`),j.So())}),A(m,ya.EventType.ERROR,R=>{y||(y=!0,wi(gt,`RPC '${e}' stream ${s} transport errored:`,R),j.So(new W(F.UNAVAILABLE,"The operation could not be completed")))}),A(m,ya.EventType.MESSAGE,R=>{var _;if(!y){const N=R.data[0];ye(!!N);const I=N,P=I.error||((_=I[0])===null||_===void 0?void 0:_.error);if(P){K(gt,`RPC '${e}' stream ${s} received error:`,P);const O=P.status;let D=function(g){const k=Be[g];if(k!==void 0)return Fb(k)}(O),w=P.message;D===void 0&&(D=F.INTERNAL,w="Unknown error status: "+O+" with message "+P.message),y=!0,j.So(new W(D,w)),m.close()}else K(gt,`RPC '${e}' stream ${s} received:`,N),j.bo(N)}}),A(c,db.STAT_EVENT,R=>{R.stat===Vh.PROXY?K(gt,`RPC '${e}' stream ${s} detected buffering proxy`):R.stat===Vh.NOPROXY&&K(gt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{j.wo()},0),j}}function Ad(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hu(t){return new eI(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&K("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e,r,n,s,i,o,c,u){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Jb(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===F.RESOURCE_EXHAUSTED?(Yr(r.toString()),Yr("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new W(F.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return K("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(K("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class HI extends Xb{constructor(e,r,n,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=nI(this.serializer,e),n=function(i){if(!("targetChange"in i))return ne.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?Er(o.readTime):ne.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Gh(this.serializer),r.addTarget=function(i,o){let c;const u=o.target;if(c=zh(u)?{documents:aI(i,u)}:{query:oI(i,u)._t},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=zb(i,o.resumeToken);const d=qh(i,o.expectedCount);d!==null&&(c.expectedCount=d)}else if(o.snapshotVersion.compareTo(ne.min())>0){c.readTime=Ec(i,o.snapshotVersion.toTimestamp());const d=qh(i,o.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);const n=cI(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Gh(this.serializer),r.removeTarget=e,this.a_(r)}}class WI extends Xb{constructor(e,r,n,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return ye(!!e.streamToken),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ye(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=iI(e.writeResults,e.commitTime),n=Er(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Gh(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>sI(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new W(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Hh(r,n),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(F.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Lo(e,Hh(r,n),s,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class KI{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Yr(r),this.D_=!1):K("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{n.enqueueAndForget(async()=>{Ts(this)&&(K("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=se(u);d.L_.add(4),await To(d),d.q_.set("Unknown"),d.L_.delete(4),await mu(d)}(this))})}),this.q_=new KI(n,s)}}async function mu(t){if(Ts(t))for(const e of t.B_)await e(!0)}async function To(t){for(const e of t.B_)await e(!1)}function Zb(t,e){const r=se(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),Df(r)?Rf(r):$i(r).r_()&&Pf(r,e))}function Cf(t,e){const r=se(t),n=$i(r);r.N_.delete(e),n.r_()&&e_(r,e),r.N_.size===0&&(n.r_()?n.o_():Ts(r)&&r.q_.set("Unknown"))}function Pf(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}$i(t).A_(e)}function e_(t,e){t.Q_.xe(e),$i(t).R_(e)}function Rf(t){t.Q_=new YA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),$i(t).start(),t.q_.v_()}function Df(t){return Ts(t)&&!$i(t).n_()&&t.N_.size>0}function Ts(t){return se(t).L_.size===0}function t_(t){t.Q_=void 0}async function YI(t){t.q_.set("Online")}async function JI(t){t.N_.forEach((e,r)=>{Pf(t,e)})}async function XI(t,e){t_(t),Df(t)?(t.q_.M_(e),Rf(t)):t.q_.set("Unknown")}async function ZI(t,e,r){if(t.q_.set("Online"),e instanceof $b&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const c of i.targetIds)s.N_.has(c)&&(await s.remoteSyncer.rejectListen(c,o),s.N_.delete(c),s.Q_.removeTarget(c))}(t,e)}catch(n){K("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await jc(t,n)}else if(e instanceof $l?t.Q_.Ke(e):e instanceof Ub?t.Q_.He(e):t.Q_.We(e),!r.isEqual(ne.min()))try{const n=await Yb(t.localStore);r.compareTo(n)>=0&&await function(i,o){const c=i.Q_.rt(o);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const f=i.N_.get(d);f&&i.N_.set(d,f.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,d)=>{const f=i.N_.get(u);if(!f)return;i.N_.set(u,f.withResumeToken(ct.EMPTY_BYTE_STRING,f.snapshotVersion)),e_(i,u);const m=new Nn(f.target,u,d,f.sequenceNumber);Pf(i,m)}),i.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){K("RemoteStore","Failed to raise snapshot:",n),await jc(t,n)}}async function jc(t,e,r){if(!No(e))throw e;t.L_.add(1),await To(t),t.q_.set("Offline"),r||(r=()=>Yb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{K("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await mu(t)})}function r_(t,e){return e().catch(r=>jc(t,r,e))}async function fu(t){const e=se(t),r=zn(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;eC(e);)try{const s=await OI(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,tC(e,s)}catch(s){await jc(e,s)}n_(e)&&s_(e)}function eC(t){return Ts(t)&&t.O_.length<10}function tC(t,e){t.O_.push(e);const r=zn(t);r.r_()&&r.V_&&r.m_(e.mutations)}function n_(t){return Ts(t)&&!zn(t).n_()&&t.O_.length>0}function s_(t){zn(t).start()}async function rC(t){zn(t).p_()}async function nC(t){const e=zn(t);for(const r of t.O_)e.m_(r.mutations)}async function sC(t,e,r){const n=t.O_.shift(),s=Ef.from(n,e,r);await r_(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await fu(t)}async function iC(t,e){e&&zn(t).V_&&await async function(n,s){if(function(o){return GA(o)&&o!==F.ABORTED}(s.code)){const i=n.O_.shift();zn(n).s_(),await r_(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await fu(n)}}(t,e),n_(t)&&s_(t)}async function Ey(t,e){const r=se(t);r.asyncQueue.verifyOperationInProgress(),K("RemoteStore","RemoteStore received new credentials");const n=Ts(r);r.L_.add(3),await To(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await mu(r)}async function aC(t,e){const r=se(t);e?(r.L_.delete(2),await mu(r)):e||(r.L_.add(2),await To(r),r.q_.set("Unknown"))}function $i(t){return t.K_||(t.K_=function(r,n,s){const i=se(r);return i.w_(),new HI(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:YI.bind(null,t),Ro:JI.bind(null,t),mo:XI.bind(null,t),d_:ZI.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Df(t)?Rf(t):t.q_.set("Unknown")):(await t.K_.stop(),t_(t))})),t.K_}function zn(t){return t.U_||(t.U_=function(r,n,s){const i=se(r);return i.w_(),new WI(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:rC.bind(null,t),mo:iC.bind(null,t),f_:nC.bind(null,t),g_:sC.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await fu(t)):(await t.U_.stop(),t.O_.length>0&&(K("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new Br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const o=Date.now()+n,c=new Mf(e,r,o,s,i);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lf(t,e){if(Yr("AsyncQueue",`${e}: ${t}`),No(t))return new W(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e){this.comparator=e?(r,n)=>e(r,n)||Y.comparator(r.key,n.key):(r,n)=>Y.comparator(r.key,n.key),this.keyedMap=xa(),this.sortedSet=new Re(this.comparator)}static emptySet(e){return new li(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof li)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new li;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.W_=new Re(Y.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):re():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ti{constructor(e,r,n,s,i,o,c,u,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,s,i){const o=[];return r.forEach(c=>{o.push({type:0,doc:c})}),new Ti(e,r,li.emptySet(r),o,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&au(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class lC{constructor(){this.queries=Ty(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=se(r),i=s.queries;s.queries=Ty(),i.forEach((o,c)=>{for(const u of c.j_)u.onError(n)})})(this,new W(F.ABORTED,"Firestore shutting down"))}}function Ty(){return new Ui(t=>jb(t),au)}async function Of(t,e){const r=se(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new oC,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(o){const c=Lf(o,`Initialization of query '${Ls(e.query)}' failed`);return void e.onError(c)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&Ff(r)}async function Vf(t,e){const r=se(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function cC(t,e){const r=se(t);let n=!1;for(const s of e){const i=s.query,o=r.queries.get(i);if(o){for(const c of o.j_)c.X_(s)&&(n=!0);o.z_=s}}n&&Ff(r)}function uC(t,e,r){const n=se(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function Ff(t){t.Y_.forEach(e=>{e.next()})}var Qh,Sy;(Sy=Qh||(Qh={})).ea="default",Sy.Cache="cache";class Uf{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Ti(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Ti.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Qh.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(e){this.key=e}}class a_{constructor(e){this.key=e}}class dC{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=oe(),this.mutatedKeys=oe(),this.Aa=Tb(e),this.Ra=new li(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new jy,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,o=s,c=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((f,m)=>{const v=s.get(f),y=ou(this.query,m)?m:null,j=!!v&&this.mutatedKeys.has(v.key),A=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let R=!1;v&&y?v.data.isEqual(y.data)?j!==A&&(n.track({type:3,doc:y}),R=!0):this.ga(v,y)||(n.track({type:2,doc:y}),R=!0,(u&&this.Aa(y,u)>0||d&&this.Aa(y,d)<0)&&(c=!0)):!v&&y?(n.track({type:0,doc:y}),R=!0):v&&!y&&(n.track({type:1,doc:v}),R=!0,(u||d)&&(c=!0)),R&&(y?(o=o.add(y),i=A?i.add(f):i.delete(f)):(o=o.delete(f),i=i.delete(f)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),i=i.delete(f.key),n.track({type:1,doc:f})}return{Ra:o,fa:n,ns:c,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((f,m)=>function(y,j){const A=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return re()}};return A(y)-A(j)}(f.type,m.type)||this.Aa(f.doc,m.doc)),this.pa(n),s=s!=null&&s;const c=r&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new Ti(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new jy,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=oe(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new a_(n))}),this.da.forEach(n=>{e.has(n)||r.push(new i_(n))}),r}ba(e){this.Ta=e.Ts,this.da=oe();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Ti.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class hC{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class mC{constructor(e){this.key=e,this.va=!1}}class fC{constructor(e,r,n,s,i,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ui(c=>jb(c),au),this.Ma=new Map,this.xa=new Set,this.Oa=new Re(Y.comparator),this.Na=new Map,this.La=new Sf,this.Ba={},this.ka=new Map,this.qa=ji.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function gC(t,e,r=!0){const n=h_(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await o_(n,e,r,!0),s}async function pC(t,e){const r=h_(t);await o_(r,e,!0,!1)}async function o_(t,e,r,n){const s=await VI(t.localStore,Nr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,r);let c;return n&&(c=await yC(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&r&&Zb(t.remoteStore,s),c}async function yC(t,e,r,n,s){t.Ka=(m,v,y)=>async function(A,R,_,N){let I=R.view.ma(_);I.ns&&(I=await _y(A.localStore,R.query,!1).then(({documents:w})=>R.view.ma(w,I)));const P=N&&N.targetChanges.get(R.targetId),O=N&&N.targetMismatches.get(R.targetId)!=null,D=R.view.applyChanges(I,A.isPrimaryClient,P,O);return Iy(A,R.targetId,D.wa),D.snapshot}(t,m,v,y);const i=await _y(t.localStore,e,!0),o=new dC(e,i.Ts),c=o.ma(i.documents),u=jo.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),d=o.applyChanges(c,t.isPrimaryClient,u);Iy(t,r,d.wa);const f=new hC(e,r,o);return t.Fa.set(e,f),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),d.snapshot}async function xC(t,e,r){const n=se(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(o=>!au(o,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Kh(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&Cf(n.remoteStore,s.targetId),Yh(n,s.targetId)}).catch(ko)):(Yh(n,s.targetId),await Kh(n.localStore,s.targetId,!0))}async function vC(t,e){const r=se(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Cf(r.remoteStore,n.targetId))}async function wC(t,e,r){const n=TC(t);try{const s=await function(o,c){const u=se(o),d=Ke.now(),f=c.reduce((y,j)=>y.add(j.key),oe());let m,v;return u.persistence.runTransaction("Locally write mutations","readwrite",y=>{let j=Jr(),A=oe();return u.cs.getEntries(y,f).next(R=>{j=R,j.forEach((_,N)=>{N.isValidDocument()||(A=A.add(_))})}).next(()=>u.localDocuments.getOverlayedDocuments(y,j)).next(R=>{m=R;const _=[];for(const N of c){const I=zA(N,m.get(N.key).overlayedDocument);I!=null&&_.push(new Gn(N.key,I,xb(I.value.mapValue),Ot.exists(!0)))}return u.mutationQueue.addMutationBatch(y,d,_,c)}).next(R=>{v=R;const _=R.applyToLocalDocumentSet(m,A);return u.documentOverlayCache.saveOverlays(y,R.batchId,_)})}).then(()=>({batchId:v.batchId,changes:Ab(m)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(o,c,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new Re(fe)),d=d.insert(c,u),o.Ba[o.currentUser.toKey()]=d}(n,s.batchId,r),await So(n,s.changes),await fu(n.remoteStore)}catch(s){const i=Lf(s,"Failed to persist write");r.reject(i)}}async function l_(t,e){const r=se(t);try{const n=await MI(r.localStore,e);e.targetChanges.forEach((s,i)=>{const o=r.Na.get(i);o&&(ye(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?ye(o.va):s.removedDocuments.size>0&&(ye(o.va),o.va=!1))}),await So(r,n,e)}catch(n){await ko(n)}}function Ay(t,e,r){const n=se(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,o)=>{const c=o.view.Z_(e);c.snapshot&&s.push(c.snapshot)}),function(o,c){const u=se(o);u.onlineState=c;let d=!1;u.queries.forEach((f,m)=>{for(const v of m.j_)v.Z_(c)&&(d=!0)}),d&&Ff(u)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function bC(t,e,r){const n=se(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let o=new Re(Y.comparator);o=o.insert(i,vt.newNoDocument(i,ne.min()));const c=oe().add(i),u=new du(ne.min(),new Map,new Re(fe),o,c);await l_(n,u),n.Oa=n.Oa.remove(i),n.Na.delete(e),$f(n)}else await Kh(n.localStore,e,!1).then(()=>Yh(n,e,r)).catch(ko)}async function _C(t,e){const r=se(t),n=e.batch.batchId;try{const s=await DI(r.localStore,e);u_(r,n,null),c_(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await So(r,s)}catch(s){await ko(s)}}async function kC(t,e,r){const n=se(t);try{const s=await function(o,c){const u=se(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let f;return u.mutationQueue.lookupMutationBatch(d,c).next(m=>(ye(m!==null),f=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,f,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,f)).next(()=>u.localDocuments.getDocuments(d,f))})}(n.localStore,e);u_(n,e,r),c_(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await So(n,s)}catch(s){await ko(s)}}function c_(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function u_(t,e,r){const n=se(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Yh(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||d_(t,n)})}function d_(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(Cf(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),$f(t))}function Iy(t,e,r){for(const n of r)n instanceof i_?(t.La.addReference(n.key,e),NC(t,n)):n instanceof a_?(K("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||d_(t,n.key)):re()}function NC(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(K("SyncEngine","New document in limbo: "+r),t.xa.add(n),$f(t))}function $f(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new Y(Ee.fromString(e)),n=t.qa.next();t.Na.set(n,new mC(r)),t.Oa=t.Oa.insert(r,n),Zb(t.remoteStore,new Nn(Nr(iu(r.path)),n,"TargetPurposeLimboResolution",yf.oe))}}async function So(t,e,r){const n=se(t),s=[],i=[],o=[];n.Fa.isEmpty()||(n.Fa.forEach((c,u)=>{o.push(n.Ka(u,e,r).then(d=>{var f;if((d||r)&&n.isPrimaryClient){const m=d?!d.fromCache:(f=r==null?void 0:r.targetChanges.get(u.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){s.push(d);const m=If.Wi(u.targetId,d);i.push(m)}}))}),await Promise.all(o),n.Ca.d_(s),await async function(u,d){const f=se(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>$.forEach(d,v=>$.forEach(v.$i,y=>f.persistence.referenceDelegate.addReference(m,v.targetId,y)).next(()=>$.forEach(v.Ui,y=>f.persistence.referenceDelegate.removeReference(m,v.targetId,y)))))}catch(m){if(!No(m))throw m;K("LocalStore","Failed to update sequence numbers: "+m)}for(const m of d){const v=m.targetId;if(!m.fromCache){const y=f.os.get(v),j=y.snapshotVersion,A=y.withLastLimboFreeSnapshotVersion(j);f.os=f.os.insert(v,A)}}}(n.localStore,i))}async function EC(t,e){const r=se(t);if(!r.currentUser.isEqual(e)){K("SyncEngine","User change. New user:",e.toKey());const n=await Qb(r.localStore,e);r.currentUser=e,function(i,o){i.ka.forEach(c=>{c.forEach(u=>{u.reject(new W(F.CANCELLED,o))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await So(r,n.hs)}}function jC(t,e){const r=se(t),n=r.Na.get(e);if(n&&n.va)return oe().add(n.key);{let s=oe();const i=r.Ma.get(e);if(!i)return s;for(const o of i){const c=r.Fa.get(o);s=s.unionWith(c.view.Va)}return s}}function h_(t){const e=se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=l_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=jC.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bC.bind(null,e),e.Ca.d_=cC.bind(null,e.eventManager),e.Ca.$a=uC.bind(null,e.eventManager),e}function TC(t){const e=se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_C.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kC.bind(null,e),e}class Tc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=hu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return RI(this.persistence,new CI,e.initialUser,this.serializer)}Ga(e){return new SI(Af.Zr,this.serializer)}Wa(e){return new UI}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Tc.provider={build:()=>new Tc};class Jh{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>Ay(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=EC.bind(null,this.syncEngine),await aC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new lC}()}createDatastore(e){const r=hu(e.databaseInfo.databaseId),n=function(i){return new qI(i)}(e.databaseInfo);return function(i,o,c,u){return new GI(i,o,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,o,c){return new QI(n,s,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,r=>Ay(this.syncEngine,r,0),function(){return Ny.D()?new Ny:new $I}())}createSyncEngine(e,r){return function(s,i,o,c,u,d,f){const m=new fC(s,i,o,c,u,d);return f&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=se(s);K("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await To(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Jh.provider={build:()=>new Jh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Yr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=yt.UNAUTHENTICATED,this.clientId=gb.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async o=>{K("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(K("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Lf(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Id(t,e){t.asyncQueue.verifyOperationInProgress(),K("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await Qb(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Cy(t,e){t.asyncQueue.verifyOperationInProgress();const r=await AC(t);K("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>Ey(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>Ey(e.remoteStore,s)),t._onlineComponents=e}async function AC(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){K("FirestoreClient","Using user provided OfflineComponentProvider");try{await Id(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===F.FAILED_PRECONDITION||s.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;wi("Error using user provided cache. Falling back to memory cache: "+r),await Id(t,new Tc)}}else K("FirestoreClient","Using default OfflineComponentProvider"),await Id(t,new Tc);return t._offlineComponents}async function m_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(K("FirestoreClient","Using user provided OnlineComponentProvider"),await Cy(t,t._uninitializedComponentsProvider._online)):(K("FirestoreClient","Using default OnlineComponentProvider"),await Cy(t,new Jh))),t._onlineComponents}function IC(t){return m_(t).then(e=>e.syncEngine)}async function Sc(t){const e=await m_(t),r=e.eventManager;return r.onListen=gC.bind(null,e.syncEngine),r.onUnlisten=xC.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=pC.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=vC.bind(null,e.syncEngine),r}function CC(t,e,r={}){const n=new Br;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new zf({next:v=>{f.Za(),o.enqueueAndForget(()=>Vf(i,m));const y=v.docs.has(c);!y&&v.fromCache?d.reject(new W(F.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&v.fromCache&&u&&u.source==="server"?d.reject(new W(F.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(v)},error:v=>d.reject(v)}),m=new Uf(iu(c.path),f,{includeMetadataChanges:!0,_a:!0});return Of(i,m)}(await Sc(t),t.asyncQueue,e,r,n)),n.promise}function PC(t,e,r={}){const n=new Br;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,u,d){const f=new zf({next:v=>{f.Za(),o.enqueueAndForget(()=>Vf(i,m)),v.fromCache&&u.source==="server"?d.reject(new W(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(v)},error:v=>d.reject(v)}),m=new Uf(c,f,{includeMetadataChanges:!0,_a:!0});return Of(i,m)}(await Sc(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Py=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(t,e,r){if(!r)throw new W(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function RC(t,e,r,n){if(e===!0&&n===!0)throw new W(F.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Ry(t){if(!Y.isDocumentKey(t))throw new W(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Dy(t){if(Y.isDocumentKey(t))throw new W(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function gu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":re()}function Vt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=gu(t);throw new W(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class My{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new W(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new W(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}RC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=f_((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new W(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new W(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new W(F.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pu{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new My({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new My(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new XS;switch(n.type){case"firstParty":return new rA(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new W(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=Py.get(r);n&&(K("ComponentProvider","Removing Datastore"),Py.delete(r),n.terminate())}(this),Promise.resolve()}}function DC(t,e,r,n={}){var s;const i=(t=Vt(t,pu))._getSettings(),o=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&wi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),n.mockUserToken){let c,u;if(typeof n.mockUserToken=="string")c=n.mockUserToken,u=yt.MOCK_USER;else{c=mE(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=n.mockUserToken.sub||n.mockUserToken.user_id;if(!d)throw new W(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new yt(d)}t._authCredentials=new ZS(new fb(c,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new an(this.firestore,e,this._query)}}class wt{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new On(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new wt(this.firestore,e,this._key)}}class On extends an{constructor(e,r,n){super(e,r,iu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new wt(this.firestore,null,new Y(e))}withConverter(e){return new On(this.firestore,e,this._path)}}function ie(t,e,...r){if(t=Fe(t),g_("collection","path",e),t instanceof pu){const n=Ee.fromString(e,...r);return Dy(n),new On(t,null,n)}{if(!(t instanceof wt||t instanceof On))throw new W(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ee.fromString(e,...r));return Dy(n),new On(t.firestore,null,n)}}function Q(t,e,...r){if(t=Fe(t),arguments.length===1&&(e=gb.newId()),g_("doc","path",e),t instanceof pu){const n=Ee.fromString(e,...r);return Ry(n),new wt(t,null,new Y(n))}{if(!(t instanceof wt||t instanceof On))throw new W(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Ee.fromString(e,...r));return Ry(n),new wt(t.firestore,t instanceof On?t.converter:null,new Y(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Jb(this,"async_queue_retry"),this.Vu=()=>{const n=Ad();n&&K("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=Ad();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=Ad();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new Br;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!No(e))throw e;K("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(o){let c=o.message||"";return o.stack&&(c=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),c}(n);throw Yr("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=Mf.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&re()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function Oy(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class Xr extends pu{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new Ly,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Ly(e),this._firestoreClient=void 0,await e}}}function MC(t,e){const r=typeof t=="object"?t:kw(),n=typeof t=="string"?t:"(default)",s=af(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=dE("firestore");i&&DC(s,...i)}return s}function Ao(t){if(t._terminated)throw new W(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||LC(t),t._firestoreClient}function LC(t){var e,r,n;const s=t._freezeSettings(),i=function(c,u,d,f){return new gA(c,u,d,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,f_(f.experimentalLongPollingOptions),f.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new SC(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(c){const u=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Si(ct.fromBase64String(e))}catch(r){throw new W(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Si(ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new W(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new W(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new W(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qf{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=/^__.*__$/;class VC{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Gn(e,this.data,this.fieldMask,r,this.fieldTransforms):new Eo(e,this.data,r,this.fieldTransforms)}}class p_{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Gn(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function y_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw re()}}class yu{constructor(e,r,n,s,i,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new yu(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ac(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(y_(this.Cu)&&OC.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class FC{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||hu(e)}Qu(e,r,n,s=!1){return new yu({Cu:e,methodName:r,qu:n,path:it.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Co(t){const e=t._freezeSettings(),r=hu(t._databaseId);return new FC(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Hf(t,e,r,n,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);Yf("Data must be an object, but it was:",o,n);const c=b_(n,o);let u,d;if(i.merge)u=new Ht(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const f=[];for(const m of i.mergeFields){const v=Xh(e,m,r);if(!o.contains(v))throw new W(F.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);k_(f,v)||f.push(v)}u=new Ht(f),d=o.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=o.fieldTransforms;return new VC(new Pt(c),u,d)}class xu extends Ss{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof xu}}function x_(t,e,r){return new yu({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:r},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Wf extends Ss{_toFieldTransform(e){return new cu(e.path,new oo)}isEqual(e){return e instanceof Wf}}class Gf extends Ss{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=x_(this,e,!0),n=this.Ku.map(i=>As(i,r)),s=new Ni(n);return new cu(e.path,s)}isEqual(e){return e instanceof Gf&&yi(this.Ku,e.Ku)}}class Kf extends Ss{constructor(e,r){super(e),this.Ku=r}_toFieldTransform(e){const r=x_(this,e,!0),n=this.Ku.map(i=>As(i,r)),s=new Ei(n);return new cu(e.path,s)}isEqual(e){return e instanceof Kf&&yi(this.Ku,e.Ku)}}class Qf extends Ss{constructor(e,r){super(e),this.$u=r}_toFieldTransform(e){const r=new lo(e.serializer,Pb(e.serializer,this.$u));return new cu(e.path,r)}isEqual(e){return e instanceof Qf&&this.$u===e.$u}}function v_(t,e,r,n){const s=t.Qu(1,e,r);Yf("Data must be an object, but it was:",s,n);const i=[],o=Pt.empty();js(n,(u,d)=>{const f=Jf(e,u,r);d=Fe(d);const m=s.Nu(f);if(d instanceof xu)i.push(f);else{const v=As(d,m);v!=null&&(i.push(f),o.set(f,v))}});const c=new Ht(i);return new p_(o,c,s.fieldTransforms)}function w_(t,e,r,n,s,i){const o=t.Qu(1,e,r),c=[Xh(e,n,r)],u=[s];if(i.length%2!=0)throw new W(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<i.length;v+=2)c.push(Xh(e,i[v])),u.push(i[v+1]);const d=[],f=Pt.empty();for(let v=c.length-1;v>=0;--v)if(!k_(d,c[v])){const y=c[v];let j=u[v];j=Fe(j);const A=o.Nu(y);if(j instanceof xu)d.push(y);else{const R=As(j,A);R!=null&&(d.push(y),f.set(y,R))}}const m=new Ht(d);return new p_(f,m,o.fieldTransforms)}function UC(t,e,r,n=!1){return As(r,t.Qu(n?4:3,e))}function As(t,e){if(__(t=Fe(t)))return Yf("Unsupported field value:",e,t),b_(t,e);if(t instanceof Ss)return function(n,s){if(!y_(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let o=0;for(const c of n){let u=As(c,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=Fe(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Pb(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=Ke.fromDate(n);return{timestampValue:Ec(s.serializer,i)}}if(n instanceof Ke){const i=new Ke(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ec(s.serializer,i)}}if(n instanceof Bf)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Si)return{bytesValue:zb(s.serializer,n._byteString)};if(n instanceof wt){const i=s.databaseId,o=n.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Tf(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof qf)return function(o,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return kf(c.serializer,u)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${gu(n)}`)}(t,e)}function b_(t,e){const r={};return pb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):js(t,(n,s)=>{const i=As(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function __(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ke||t instanceof Bf||t instanceof Si||t instanceof wt||t instanceof Ss||t instanceof qf)}function Yf(t,e,r){if(!__(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=gu(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Xh(t,e,r){if((e=Fe(e))instanceof Io)return e._internalPath;if(typeof e=="string")return Jf(t,e);throw Ac("Field path arguments must be of type string or ",t,!1,void 0,r)}const $C=new RegExp("[~\\*/\\[\\]]");function Jf(t,e,r){if(e.search($C)>=0)throw Ac(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Io(...e.split("."))._internalPath}catch{throw Ac(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Ac(t,e,r,n,s){const i=n&&!n.isEmpty(),o=s!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${n}`),o&&(u+=` in document ${s}`),u+=")"),new W(F.INVALID_ARGUMENT,c+t+u)}function k_(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new wt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(vu("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class zC extends N_{data(){return super.data()}}function vu(t,e){return typeof e=="string"?Jf(t,e):e instanceof Io?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Xf{}class Zf extends Xf{}function Le(t,e,...r){let n=[];e instanceof Xf&&n.push(e),n=n.concat(r),function(i){const o=i.filter(u=>u instanceof eg).length,c=i.filter(u=>u instanceof wu).length;if(o>1||o>0&&c>0)throw new W(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class wu extends Zf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new wu(e,r,n)}_apply(e){const r=this._parse(e);return j_(e._query,r),new an(e.firestore,e.converter,Bh(e._query,r))}_parse(e){const r=Co(e.firestore);return function(i,o,c,u,d,f,m){let v;if(d.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new W(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){Fy(m,f);const y=[];for(const j of m)y.push(Vy(u,i,j));v={arrayValue:{values:y}}}else v=Vy(u,i,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||Fy(m,f),v=UC(c,o,m,f==="in"||f==="not-in");return Ge.create(d,f,v)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function qe(t,e,r){const n=e,s=vu("where",t);return wu._create(s,n,r)}class eg extends Xf{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new eg(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:mr.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let o=s;const c=i.getFlattenedFilters();for(const u of c)j_(o,u),o=Bh(o,u)}(e._query,r),new an(e.firestore,e.converter,Bh(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class tg extends Zf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new tg(e,r)}_apply(e){const r=function(s,i,o){if(s.startAt!==null)throw new W(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new W(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ao(i,o)}(e._query,this._field,this._direction);return new an(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Fi(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function xr(t,e="asc"){const r=e,n=vu("orderBy",t);return tg._create(n,r)}class rg extends Zf{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new rg(e,r,n)}_apply(e){return new an(e.firestore,e.converter,Nc(e._query,this._limit,this._limitType))}}function BC(t){return rg._create("limit",t,"F")}function Vy(t,e,r){if(typeof(r=Fe(r))=="string"){if(r==="")throw new W(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eb(e)&&r.indexOf("/")!==-1)throw new W(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Ee.fromString(r));if(!Y.isDocumentKey(n))throw new W(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return iy(t,new Y(n))}if(r instanceof wt)return iy(t,r._key);throw new W(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${gu(r)}.`)}function Fy(t,e){if(!Array.isArray(t)||t.length===0)throw new W(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function j_(t,e){const r=function(s,i){for(const o of s)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new W(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class qC{convertValue(e,r="none"){switch(bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(ws(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw re()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return js(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(o=>$e(o.doubleValue));return new qf(i)}convertGeoPoint(e){return new Bf($e(e.latitude),$e(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=vf(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(no(e));default:return null}}convertTimestamp(e){const r=$n(e);return new Ke(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Ee.fromString(e);ye(Kb(n));const s=new so(n.get(1),n.get(3)),i=new Y(n.popFirst(5));return s.isEqual(r)||Yr(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ng(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class T_ extends N_{constructor(e,r,n,s,i,o){super(e,r,n,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new zl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(vu("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class zl extends T_{data(e={}){return super.data(e)}}class S_{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new wa(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new zl(this._firestore,this._userDataWriter,n.key,n,new wa(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new W(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(c=>{const u=new zl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new wa(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const u=new zl(s._firestore,s._userDataWriter,c.doc.key,c.doc,new wa(s._snapshot.mutatedKeys.has(c.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,f=-1;return c.type!==0&&(d=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:HC(c.type),doc:u,oldIndex:d,newIndex:f}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function HC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return re()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(t){t=Vt(t,wt);const e=Vt(t.firestore,Xr);return CC(Ao(e),t._key).then(r=>A_(e,t,r))}class sg extends qC{constructor(e){super(),this.firestore=e}convertBytes(e){return new Si(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new wt(this.firestore,null,r)}}function He(t){t=Vt(t,an);const e=Vt(t.firestore,Xr),r=Ao(e),n=new sg(e);return E_(t._query),PC(r,t._query).then(s=>new S_(e,n,t,s))}function Zh(t,e,r){t=Vt(t,wt);const n=Vt(t.firestore,Xr),s=ng(t.converter,e,r);return bu(n,[Hf(Co(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,Ot.none())])}function zt(t,e,r,...n){t=Vt(t,wt);const s=Vt(t.firestore,Xr),i=Co(s);let o;return o=typeof(e=Fe(e))=="string"||e instanceof Io?w_(i,"updateDoc",t._key,e,r,n):v_(i,"updateDoc",t._key,e),bu(s,[o.toMutation(t._key,Ot.exists(!0))])}function ts(t,e){const r=Vt(t.firestore,Xr),n=Q(t),s=ng(t.converter,e);return bu(r,[Hf(Co(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,Ot.exists(!1))]).then(()=>n)}function Ms(t,...e){var r,n,s;t=Fe(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||Oy(e[o])||(i=e[o],o++);const c={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(Oy(e[o])){const m=e[o];e[o]=(r=m.next)===null||r===void 0?void 0:r.bind(m),e[o+1]=(n=m.error)===null||n===void 0?void 0:n.bind(m),e[o+2]=(s=m.complete)===null||s===void 0?void 0:s.bind(m)}let u,d,f;if(t instanceof wt)d=Vt(t.firestore,Xr),f=iu(t._key.path),u={next:m=>{e[o]&&e[o](A_(d,t,m))},error:e[o+1],complete:e[o+2]};else{const m=Vt(t,an);d=Vt(m.firestore,Xr),f=m._query;const v=new sg(d);u={next:y=>{e[o]&&e[o](new S_(d,v,m,y))},error:e[o+1],complete:e[o+2]},E_(t._query)}return function(v,y,j,A){const R=new zf(A),_=new Uf(y,R,j);return v.asyncQueue.enqueueAndForget(async()=>Of(await Sc(v),_)),()=>{R.Za(),v.asyncQueue.enqueueAndForget(async()=>Vf(await Sc(v),_))}}(Ao(d),f,c,u)}function bu(t,e){return function(n,s){const i=new Br;return n.asyncQueue.enqueueAndForget(async()=>wC(await IC(n),s,i)),i.promise}(Ao(t),e)}function A_(t,e,r){const n=r.docs.get(e._key),s=new sg(t);return new T_(t,s,e._key,n,new wa(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Co(e)}set(e,r,n){this._verifyNotCommitted();const s=Cd(e,this._firestore),i=ng(s.converter,r,n),o=Hf(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(o.toMutation(s._key,Ot.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=Cd(e,this._firestore);let o;return o=typeof(r=Fe(r))=="string"||r instanceof Io?w_(this._dataReader,"WriteBatch.update",i._key,r,n,s):v_(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(o.toMutation(i._key,Ot.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=Cd(e,this._firestore);return this._mutations=this._mutations.concat(new Nf(r._key,Ot.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new W(F.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Cd(t,e){if((t=Fe(t)).firestore!==e)throw new W(F.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Z(){return new Wf("serverTimestamp")}function hn(...t){return new Gf("arrayUnion",t)}function bl(...t){return new Kf("arrayRemove",t)}function pt(t){return new Qf("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $t(t){return Ao(t=Vt(t,Xr)),new WC(t,e=>bu(t,e))}(function(e,r=!0){(function(s){Vi=s})(Li),xi(new ps("firestore",(n,{instanceIdentifier:s,options:i})=>{const o=n.getProvider("app").getImmediate(),c=new Xr(new eA(n.getProvider("auth-internal")),new sA(n.getProvider("app-check-internal")),function(d,f){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new W(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new so(d.options.projectId,f)}(o,s),o);return i=Object.assign({useFetchStreams:r},i),c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),Ln(ey,"4.7.3",e),Ln(ey,"4.7.3","esm2017")})();const GC={apiKey:"AIzaSyAcIrPFrbI7qjbntE_wTed5JQjZZELSlRU",authDomain:"sorted-80b0b.firebaseapp.com",projectId:"sorted-80b0b",storageBucket:"sorted-80b0b.firebasestorage.app",messagingSenderId:"146176482882",appId:"1:146176482882:web:6e06d96027b587b61f97db",measurementId:"G-H4TLBCY6YC"},I_=_w(GC),Xs=KS(I_),U=MC(I_);class KC{async initializeUserProfile(e,r){var n,s;try{const i=Q(U,"users",e),o=await jt(i);if(o.exists()){console.log(" User profile already exists:",e);const c=o.data();return(!c.enrolledClasses||c.enrolledClasses.length===0)&&await this.autoEnrollStudentInClasses(e,((n=c.profile)==null?void 0:n.grade)||"12",((s=c.profile)==null?void 0:s.section)||"A"),o.data()}else{const c={...r,studentId:r.studentId||`STU-${Date.now()}`,rollNumber:`R${Math.floor(Math.random()*1e3).toString().padStart(3,"0")}`,joinedCommunities:[],eventRegistrations:[],assignmentSubmissions:[],attendanceRecords:[],gradeRecords:[],messageGroups:[],learningProgress:{},createdAt:Z(),lastActive:Z(),profile:{bio:"",interests:[],academicYear:"Year 12",department:"Science",avatar:"",grade:"12",section:"A",parentContact:`+1-${Math.floor(Math.random()*9e9)+1e9}`},stats:{communitiesJoined:0,eventsAttended:0,eventsCreated:0,certificatesEarned:0,assignmentsSubmitted:0,attendancePercentage:0,currentGPA:0},preferences:{notifications:!0,emailUpdates:!0,theme:"light"},isActive:!0,enrolledClasses:[]};return await Zh(i,c),console.log(" User profile initialized in Firestore:",e),await this.autoEnrollStudentInClasses(e,c.profile.grade,c.profile.section),await this.initializeAttendanceRecords(e),await this.initializeAssignmentSubmissions(e),await this.initializeGradeRecords(e),c}}catch(i){throw console.error(" Error initializing user profile:",i),i}}async autoEnrollStudentInClasses(e,r,n){try{console.log(` Auto-enrolling student ${e} in Grade ${r}-${n} classes...`);const s=Le(ie(U,"classes"),qe("grade","==",r),qe("isActive","==",!0)),i=await He(s),o=$t(U),c=[];for(const u of i.docs){const d=u.data();if(!(d.students||[]).includes(e)){const m=Q(U,"classes",u.id);o.update(m,{students:hn(e),lastUpdated:Z()}),c.push(u.id),console.log(` Enrolling student ${e} in class: ${d.name}`)}}if(c.length>0){const u=Q(U,"users",e);o.update(u,{enrolledClasses:hn(...c),lastActive:Z()}),await o.commit(),console.log(` Student auto-enrolled in ${c.length} classes`)}else console.log(" Student already enrolled in available classes");return c}catch(s){return console.error(" Error auto-enrolling student:",s),[]}}subscribeToAllStudents(e){console.log(" Setting up real-time subscription to all students...");const r=Le(ie(U,"users"),qe("isActive","==",!0),xr("createdAt","desc"),BC(100));return Ms(r,n=>{const s=n.docs.map(i=>{var c,u,d;const o=i.data();return{id:i.id,name:o.name||"Unknown Student",email:o.email||"",studentId:o.studentId||"N/A",rollNumber:o.rollNumber||"N/A",avatar:o.avatar||"",parentContact:o.parentContact||((c=o.profile)==null?void 0:c.parentContact)||"",isActive:o.isActive!==!1,profile:o.profile||{},enrolledClasses:o.enrolledClasses||[],createdAt:((u=o.createdAt)==null?void 0:u.toDate())||new Date,lastActive:((d=o.lastActive)==null?void 0:d.toDate())||new Date}});console.log(` Real-time students update: ${s.length} students found`),e(s)},n=>{console.error(" Error in students subscription:",n),e([])})}subscribeToClassStudents(e,r){console.log(` Setting up real-time subscription to class ${e} students...`);const n=Q(U,"classes",e);return Ms(n,async s=>{if(s.exists()){const o=s.data().students||[];if(console.log(` Class ${e} has ${o.length} enrolled students`),o.length>0)try{const c=[];for(let d=0;d<o.length;d+=10){const f=o.slice(d,d+10),m=Le(ie(U,"users"),qe("__name__","in",f)),y=(await He(m)).docs.map(j=>{var R,_,N;const A=j.data();return{id:j.id,name:A.name||"Unknown Student",email:A.email||"",studentId:A.studentId||"N/A",rollNumber:A.rollNumber||"N/A",avatar:A.avatar||"",parentContact:A.parentContact||((R=A.profile)==null?void 0:R.parentContact)||"",isActive:A.isActive!==!1,profile:A.profile||{},createdAt:((_=A.createdAt)==null?void 0:_.toDate())||new Date,lastActive:((N=A.lastActive)==null?void 0:N.toDate())||new Date}});c.push(...y)}console.log(` Found ${c.length} student details for class ${e}`),r(c)}catch(c){console.error(" Error fetching student details:",c),r([])}else console.log(` Class ${e} has no students enrolled yet`),r([])}else console.log(` Class ${e} not found`),r([])},s=>{console.error(" Error in class students subscription:",s),r([])})}async createAssignmentForClass(e,r){try{console.log(` Creating assignment for class ${e.classId}...`);const n=await jt(Q(U,"classes",e.classId));if(!n.exists())throw new Error("Class not found");const i=n.data().students||[];console.log(` Assignment will be created for ${i.length} students`);const o=await ts(ie(U,"assignments"),{...e,teacherId:r,studentIds:i,createdAt:Z(),isActive:!0,stats:{totalSubmissions:0,averageGrade:0,submissionRate:0,totalStudents:i.length}}),c=$t(U);for(const u of i){const d=Q(ie(U,"assignments",o.id,"submissions"));c.set(d,{studentId:u,assignmentId:o.id,status:"pending",submittedAt:null,content:null,grade:null,feedback:null,createdAt:Z()});const f=Q(U,"users",u);c.update(f,{assignmentSubmissions:hn(o.id),lastActive:Z()})}return await c.commit(),console.log(` Assignment created for ${i.length} students in class ${e.classId}`),o.id}catch(n){throw console.error(" Error creating assignment for class:",n),n}}async markClassAttendance(e,r,n){try{console.log(` Marking attendance for ${n.length} students on ${r}...`);const s=$t(U);for(const{studentId:i,status:o}of n){const c=Q(ie(U,"attendance"));s.set(c,{studentId:i,classId:e,date:r,status:o,markedAt:Z(),markedBy:"teacher"});try{const u=Q(U,"users",i),d=await jt(u);if(d.exists()){const v=[...(d.data().attendanceRecords||[]).filter(A=>A.date!==r),{date:r,status:o}],y=v.filter(A=>A.status==="present").length,j=Math.round(y/v.length*100);s.update(u,{attendanceRecords:v,"stats.attendancePercentage":j,lastActive:Z()})}}catch(u){console.warn(` Could not update attendance for student ${i}:`,u)}}await s.commit(),console.log(` Attendance marked for ${n.length} students on ${r}`)}catch(s){throw console.error(" Error marking class attendance:",s),s}}async updateStudentMarks(e,r,n){try{console.log(` Updating marks for ${n.length} students in ${r}...`);const s=$t(U);for(const{studentId:i,marks:o,maxMarks:c,examType:u}of n){const d=Q(ie(U,"grades"));s.set(d,{studentId:i,classId:e,subject:r,marks:o,maxMarks:c,examType:u,recordedAt:Z(),recordedBy:"teacher"});try{const f=Q(U,"users",i),m=await jt(f);if(m.exists()){const y=m.data().gradeRecords||[],j=y.findIndex(N=>N.name===r);j>=0?y[j]={name:r,marks:o,maxMarks:c}:y.push({name:r,marks:o,maxMarks:c});const R=y.reduce((N,I)=>N+I.marks/I.maxMarks*100,0)/y.length,_=R>=90?10:Math.floor(R/10)+1;s.update(f,{gradeRecords:y,"stats.currentGPA":_,lastActive:Z()})}}catch(f){console.warn(` Could not update grades for student ${i}:`,f)}}await s.commit(),console.log(` Marks updated for ${n.length} students in ${r}`)}catch(s){throw console.error(" Error updating student marks:",s),s}}subscribeToClassAttendance(e,r,n){console.log(` Setting up real-time attendance subscription for class ${e} on ${r}...`);const s=Le(ie(U,"attendance"),qe("classId","==",e),qe("date","==",r));return Ms(s,i=>{const o=i.docs.map(c=>{var u;return{id:c.id,...c.data(),markedAt:(u=c.data().markedAt)==null?void 0:u.toDate()}});console.log(` Real-time attendance update for ${e} on ${r}: ${o.length} records`),n(o)},i=>{console.error(" Error in attendance subscription:",i),n([])})}subscribeToAssignmentSubmissions(e,r){console.log(` Setting up real-time submissions subscription for assignment ${e}...`);const n=Le(ie(U,"assignments",e,"submissions"),xr("createdAt","desc"));return Ms(n,async s=>{const i=s.docs.map(c=>{var u,d;return{id:c.id,...c.data(),submittedAt:(u=c.data().submittedAt)==null?void 0:u.toDate(),createdAt:(d=c.data().createdAt)==null?void 0:d.toDate()}}),o=await Promise.all(i.map(async c=>{try{const u=await jt(Q(U,"users",c.studentId)),d=u.exists()?u.data():{};return{...c,studentName:d.name||"Unknown Student",studentId:d.studentId||"N/A",rollNumber:d.rollNumber||"N/A"}}catch{return console.warn(` Could not fetch student data for submission ${c.id}`),{...c,studentName:"Unknown Student",studentId:"N/A",rollNumber:"N/A"}}}));console.log(` Real-time submissions update for assignment ${e}: ${o.length} submissions`),r(o)},s=>{console.error(" Error in submissions subscription:",s),r([])})}async initializeAttendanceRecords(e){try{const r=ie(U,"attendance"),n=$t(U),s=new Date,i=[];for(let c=0;c<30;c++){const u=new Date(s);if(u.setDate(u.getDate()-c),u.getDay()===0||u.getDay()===6)continue;const d=Math.random()>.1?"present":Math.random()>.5?"absent":"late",f=u.toISOString().split("T")[0],m=Q(r);n.set(m,{userId:e,date:f,status:d,subject:"General",markedAt:Ke.fromDate(u),markedBy:"system"}),i.push({date:f,status:d})}await n.commit();const o=Q(U,"users",e);await zt(o,{attendanceRecords:i,"stats.attendancePercentage":Math.round(i.filter(c=>c.status==="present").length/i.length*100)}),console.log(" Attendance records initialized for user:",e)}catch(r){console.error(" Error initializing attendance records:",r)}}async initializeAssignmentSubmissions(e){try{const r=ie(U,"assignments"),n=$t(U),s=["Mathematics","Physics","Chemistry","English","History","Computer Science"],i=[];s.forEach((c,u)=>{const d=Q(r),f={subject:c,title:`${c} Assignment #${u+1}`,description:`Complete the ${c.toLowerCase()} assignment covering recent topics.`,dueDate:new Date(Date.now()+(u+1)*7*24*60*60*1e3).toISOString().split("T")[0],maxMarks:100,difficulty:["easy","medium","hard"][Math.floor(Math.random()*3)],createdAt:Z(),createdBy:"system",submissions:[],stats:{totalSubmissions:0,averageGrade:0}};n.set(d,f),i.push({id:d.id,...f});const m=Q(ie(U,"assignments",d.id,"submissions")),v={userId:e,submittedAt:Z(),content:`Submitted assignment for ${c}`,grade:Math.floor(Math.random()*30)+70,feedback:"Good work! Keep it up.",status:Math.random()>.3?"submitted":"pending"};n.set(m,v)}),await n.commit();const o=Q(U,"users",e);await zt(o,{assignmentSubmissions:i.map(c=>c.id),"stats.assignmentsSubmitted":i.length}),console.log(" Assignment submissions initialized for user:",e)}catch(r){console.error(" Error initializing assignment submissions:",r)}}async initializeGradeRecords(e){try{const r=ie(U,"grades"),n=$t(U),s=[{name:"Mathematics",marks:85,maxMarks:100},{name:"Physics",marks:78,maxMarks:100},{name:"Chemistry",marks:92,maxMarks:100},{name:"English",marks:88,maxMarks:100},{name:"Computer Science",marks:95,maxMarks:100},{name:"History",marks:82,maxMarks:100}];s.forEach(d=>{const f=Q(r);n.set(f,{userId:e,subject:d.name,marks:d.marks,maxMarks:d.maxMarks,semester:"Semester 1",examType:"Final",recordedAt:Z(),recordedBy:"system"})}),await n.commit();const o=s.reduce((d,f)=>d+f.marks/f.maxMarks*100,0)/s.length,c=o>=90?10:Math.floor(o/10)+1,u=Q(U,"users",e);await zt(u,{gradeRecords:s,"stats.currentGPA":c}),console.log(" Grade records initialized for user:",e)}catch(r){console.error(" Error initializing grade records:",r)}}async createCommunity(e,r){try{const n=await ts(ie(U,"communities"),{...e,memberCount:1,members:[r],createdAt:Z(),createdBy:r,isActive:!0,settings:{isPublic:!0,allowMemberPosts:!0,requireApproval:!1},stats:{totalEvents:0,totalPosts:0,totalMembers:1}});return await this.joinCommunity(n.id,r),console.log(" Community created with ID:",n.id),n.id}catch(n){throw console.error(" Error creating community:",n),n}}async joinCommunity(e,r){try{const n=$t(U),s=Q(U,"users",r);n.update(s,{joinedCommunities:hn(e),"stats.communitiesJoined":pt(1),lastActive:Z()});const i=Q(U,"communities",e);n.update(i,{members:hn(r),memberCount:pt(1),"stats.totalMembers":pt(1),lastActivity:Z()});const o=Q(U,"communities",e,"memberships",r);n.set(o,{userId:r,joinedAt:Z(),role:"member",isActive:!0}),await n.commit(),console.log(" User joined community successfully:",{communityId:e,userId:r})}catch(n){throw console.error(" Error joining community:",n),n}}async leaveCommunity(e,r){try{const n=$t(U),s=Q(U,"users",r);n.update(s,{joinedCommunities:bl(e),"stats.communitiesJoined":pt(-1),lastActive:Z()});const i=Q(U,"communities",e);n.update(i,{members:bl(r),memberCount:pt(-1),"stats.totalMembers":pt(-1),lastActivity:Z()});const o=Q(U,"communities",e,"memberships",r);n.update(o,{isActive:!1,leftAt:Z()}),await n.commit(),console.log(" User left community successfully:",{communityId:e,userId:r})}catch(n){throw console.error(" Error leaving community:",n),n}}async createEvent(e,r){try{const n=await ts(ie(U,"events"),{...e,currentParticipants:0,registrations:[],createdAt:Z(),createdBy:r,isActive:!0,settings:{requireApproval:!1,allowWaitlist:!0,sendReminders:!0},stats:{totalRegistrations:0,totalAttendees:0,totalCertificatesIssued:0}});if(e.communityId){const i=Q(U,"communities",e.communityId);await zt(i,{"stats.totalEvents":pt(1),lastActivity:Z()})}const s=Q(U,"users",r);return await zt(s,{"stats.eventsCreated":pt(1),lastActive:Z()}),console.log(" Event created with ID:",n.id),n.id}catch(n){throw console.error(" Error creating event:",n),n}}async registerForEvent(e,r){try{const n=$t(U),s=Q(U,"events",e,"registrations",r);n.set(s,{userId:r,registeredAt:Z(),status:"registered",attendanceStatus:"pending",paymentStatus:"not_required"});const i=Q(U,"events",e);n.update(i,{registrations:hn(r),currentParticipants:pt(1),"stats.totalRegistrations":pt(1),lastActivity:Z()});const o=Q(U,"users",r);n.update(o,{eventRegistrations:hn(e),lastActive:Z()}),await n.commit(),console.log(" User registered for event successfully:",{eventId:e,userId:r})}catch(n){throw console.error(" Error registering for event:",n),n}}async unregisterFromEvent(e,r){try{const n=$t(U),s=Q(U,"events",e,"registrations",r);n.update(s,{status:"cancelled",cancelledAt:Z()});const i=Q(U,"events",e);n.update(i,{registrations:bl(r),currentParticipants:pt(-1),"stats.totalRegistrations":pt(-1),lastActivity:Z()});const o=Q(U,"users",r);n.update(o,{eventRegistrations:bl(e),lastActive:Z()}),await n.commit(),console.log(" User unregistered from event successfully:",{eventId:e,userId:r})}catch(n){throw console.error(" Error unregistering from event:",n),n}}async submitAssignment(e,r,n){try{const s=$t(U),i=Q(U,"assignments",e,"submissions",r);s.set(i,{userId:r,...n,submittedAt:Z(),status:"submitted",grade:null,feedback:null});const o=Q(U,"assignments",e);s.update(o,{"stats.totalSubmissions":pt(1),lastActivity:Z()});const c=Q(U,"users",r);s.update(c,{assignmentSubmissions:hn(e),"stats.assignmentsSubmitted":pt(1),lastActive:Z()}),await s.commit(),console.log(" Assignment submitted successfully:",{assignmentId:e,userId:r})}catch(s){throw console.error(" Error submitting assignment:",s),s}}async markAttendance(e,r,n,s){try{const i=await ts(ie(U,"attendance"),{userId:e,date:r,status:n,subject:s||"General",markedAt:Z(),markedBy:"system"}),o=Q(U,"users",e),c=await jt(o);if(c.exists()){const f=[...c.data().attendanceRecords||[],{date:r,status:n}],m=f.filter(y=>y.status==="present").length,v=Math.round(m/f.length*100);await zt(o,{attendanceRecords:f,"stats.attendancePercentage":v,lastActive:Z()})}return console.log(" Attendance marked successfully:",{userId:e,date:r,status:n}),i.id}catch(i){throw console.error(" Error marking attendance:",i),i}}async updateGrade(e,r,n,s){try{const i=await ts(ie(U,"grades"),{userId:e,subject:r,marks:n,maxMarks:s,semester:"Current",examType:"Assessment",recordedAt:Z(),recordedBy:"system"}),o=Q(U,"users",e),c=await jt(o);if(c.exists()){const d=c.data().gradeRecords||[],f=d.findIndex(j=>j.name===r);f>=0?d[f]={name:r,marks:n,maxMarks:s}:d.push({name:r,marks:n,maxMarks:s});const v=d.reduce((j,A)=>j+A.marks/A.maxMarks*100,0)/d.length,y=v>=90?10:Math.floor(v/10)+1;await zt(o,{gradeRecords:d,"stats.currentGPA":y,lastActive:Z()})}return console.log(" Grade updated successfully:",{userId:e,subject:r,marks:n,maxMarks:s}),i.id}catch(i){throw console.error(" Error updating grade:",i),i}}async trackLearningProgress(e,r,n){try{const s=Q(U,"learningProgress",`${e}_${r}`);await Zh(s,{userId:e,resourceId:r,...n,viewedAt:n.viewedAt||Z(),lastUpdated:Z()},{merge:!0});const i=Q(U,"users",e);await zt(i,{[`learningProgress.${r}`]:n,lastActive:Z()}),console.log(" Learning progress tracked:",{userId:e,resourceId:r})}catch(s){throw console.error(" Error tracking learning progress:",s),s}}async issueCertificate(e,r,n){try{const s=await ts(ie(U,"certificates"),{eventId:e,userId:r,...n,issuedAt:Z(),certificateId:`CERT-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,isValid:!0,downloadCount:0}),i=Q(U,"events",e);await zt(i,{"stats.totalCertificatesIssued":pt(1)});const o=Q(U,"users",r);return await zt(o,{"stats.certificatesEarned":pt(1),lastActive:Z()}),console.log(" Certificate issued with ID:",s.id),s.id}catch(s){throw console.error(" Error issuing certificate:",s),s}}subscribeToUserCommunities(e,r){const n=Q(U,"users",e);return Ms(n,async s=>{if(s.exists()){const o=s.data().joinedCommunities||[];if(o.length>0){const c=Le(ie(U,"communities"),qe("__name__","in",o)),d=(await He(c)).docs.map(f=>{var m;return{id:f.id,...f.data(),createdAt:((m=f.data().createdAt)==null?void 0:m.toDate())||new Date}});r(d)}else r([])}})}subscribeToUserEvents(e,r){const n=Q(U,"users",e);return Ms(n,async s=>{if(s.exists()){const o=s.data().eventRegistrations||[];if(o.length>0){const c=Le(ie(U,"events"),qe("__name__","in",o)),d=(await He(c)).docs.map(f=>({id:f.id,...f.data()}));r(d)}else r([])}})}async getUserCompleteData(e){try{console.log(" Fetching complete user data for:",e);const r=await jt(Q(U,"users",e)),n=r.exists()?r.data():null,s=Le(ie(U,"attendance"),qe("userId","==",e),xr("date","desc")),o=(await He(s)).docs.map(_=>_.data()),c=Le(ie(U,"assignments")),u=await He(c),d=[];for(const _ of u.docs){const N=await jt(Q(U,"assignments",_.id,"submissions",e));N.exists()&&d.push({assignment:{id:_.id,..._.data()},submission:N.data()})}const f=Le(ie(U,"grades"),qe("userId","==",e)),v=(await He(f)).docs.map(_=>_.data()),y=Le(ie(U,"certificates"),qe("userId","==",e)),A=(await He(y)).docs.map(_=>_.data()),R={profile:n,attendance:o,assignments:d,grades:v,certificates:A,summary:{totalAttendanceRecords:o.length,totalAssignments:d.length,totalGrades:v.length,totalCertificates:A.length}};return console.log(" Complete user data:",R),R}catch(r){throw console.error(" Error fetching complete user data:",r),r}}async refreshUserData(e){try{console.log(" Refreshing all user data for:",e),await this.initializeAttendanceRecords(e),await this.initializeAssignmentSubmissions(e),await this.initializeGradeRecords(e),console.log(" User data refreshed successfully")}catch(r){throw console.error(" Error refreshing user data:",r),r}}}const we=new KC,C_=C.createContext(void 0),tt=()=>{const t=C.useContext(C_);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},QC=({children:t})=>{const[e,r]=C.useState(null),[n,s]=C.useState(!0),i=async(d,f,m)=>{const v=await Yw(Xs,d,f);await RT(v.user,{displayName:m}),await we.initializeUserProfile(v.user.uid,{name:m,email:d,studentId:`STU-${Date.now()}`})},o=(d,f)=>Jw(Xs,d,f),c=()=>OT(Xs);C.useEffect(()=>LT(Xs,async f=>{if(r(f),f)try{await we.initializeUserProfile(f.uid,{name:f.displayName||"Student",email:f.email||"",studentId:`STU-${Date.now()}`})}catch(m){console.error("Error initializing user profile:",m)}s(!1)}),[]);const u={currentUser:e,login:o,register:i,logout:c,loading:n};return a.jsx(C_.Provider,{value:u,children:!n&&t})},P_=C.createContext(void 0),R_=()=>{const t=C.useContext(P_);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t},YC=({children:t})=>{const[e,r]=C.useState(()=>{const s=localStorage.getItem("theme");return s==="dark"||!s&&window.matchMedia("(prefers-color-scheme: dark)").matches});C.useEffect(()=>{e?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[e]);const n=()=>{r(!e)};return a.jsx(P_.Provider,{value:{isDark:e,toggleTheme:n},children:t})},JC=({children:t})=>{const{currentUser:e}=tt();return e?a.jsx(a.Fragment,{children:t}):a.jsx(rf,{to:"/login"})};class XC{async initializeTeacherProfile(e,r){try{const n=Q(U,"faculty",e),s=await jt(n);if(s.exists())return{id:e,...s.data()};{const i={...r,classes:[],qualifications:[],experience:0,joinedAt:new Date,isActive:!0,permissions:{canCreateAssignments:!0,canGradeAssignments:!0,canMarkAttendance:!0,canViewReports:!0,canManageClasses:!0}};return await Zh(n,{...i,joinedAt:Z(),createdAt:Z()}),console.log(" Teacher profile initialized:",e),{id:e,...i}}}catch(n){throw console.error(" Error initializing teacher profile:",n),n}}async getTeacherProfile(e){var r,n;try{const s=await jt(Q(U,"faculty",e));if(s.exists()){const i=s.data();return{id:e,...i,joinedAt:((r=i.joinedAt)==null?void 0:r.toDate())||new Date,lastLogin:(n=i.lastLogin)==null?void 0:n.toDate()}}return null}catch(s){return console.error(" Error getting teacher profile:",s),null}}async updateLastLogin(e){try{await zt(Q(U,"faculty",e),{lastLogin:Z()})}catch(r){console.error(" Error updating last login:",r)}}async createClass(e){try{console.log(" Creating new class:",e);const r=await ts(ie(U,"classes"),{...e,students:[],createdAt:Z(),isActive:!0,lastUpdated:Z()}),n=Q(U,"faculty",e.teacherId),s=await jt(n);if(s.exists()){const o=s.data().classes||[];await zt(n,{classes:[...o,r.id],lastUpdated:Z()})}return console.log(" Class created with ID:",r.id),r.id}catch(r){throw console.error(" Error creating class:",r),r}}async getTeacherClasses(e){try{const r=Le(ie(U,"classes"),qe("teacherId","==",e),qe("isActive","==",!0));return(await He(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(r){return console.error(" Error getting teacher classes:",r),[]}}async getClassStudents(e){try{const r=await jt(Q(U,"classes",e));if(!r.exists())return[];const n=r.data(),s=n.students||[];if(s.length===0)return[];const i=Le(ie(U,"users"),qe("__name__","in",s));return(await He(i)).docs.map(c=>{var u;return{id:c.id,name:c.data().name,email:c.data().email,studentId:c.data().studentId,class:n.name,rollNumber:c.data().rollNumber||`R${Math.floor(Math.random()*100)}`,avatar:c.data().avatar,parentContact:c.data().parentContact||((u=c.data().profile)==null?void 0:u.parentContact),isActive:c.data().isActive!==!1}})}catch(r){return console.error(" Error getting class students:",r),[]}}subscribeToClassStudents(e,r){return we.subscribeToClassStudents(e,n=>{const s=n.map(i=>{var o,c,u;return{id:i.id,name:i.name,email:i.email,studentId:i.studentId,class:`Grade ${((o=i.profile)==null?void 0:o.grade)||"12"}-${((c=i.profile)==null?void 0:c.section)||"A"}`,rollNumber:i.rollNumber||"N/A",avatar:i.avatar,parentContact:i.parentContact||((u=i.profile)==null?void 0:u.parentContact),isActive:i.isActive!==!1}});r(s)})}async createAssignment(e,r){try{return await we.createAssignmentForClass(e,r)}catch(n){throw console.error(" Error creating assignment:",n),n}}async getTeacherAssignments(e){try{const r=Le(ie(U,"assignments"),qe("teacherId","==",e),xr("createdAt","desc"));return(await He(r)).docs.map(s=>{var o,c,u,d,f;const i=s.data();return{id:s.id,...i,createdAt:(o=i.createdAt)==null?void 0:o.toDate(),dueDate:i.dueDate,stats:{totalSubmissions:((c=i.stats)==null?void 0:c.totalSubmissions)||0,averageGrade:((u=i.stats)==null?void 0:u.averageGrade)||0,submissionRate:((d=i.stats)==null?void 0:d.submissionRate)||0,totalStudents:((f=i.stats)==null?void 0:f.totalStudents)||0}}})}catch(r){return console.error(" Error getting teacher assignments:",r),[]}}async getAssignmentSubmissions(e){try{const r=Le(ie(U,"assignments",e,"submissions"),xr("createdAt","desc")),s=(await He(r)).docs.map(o=>{var c,u;return{id:o.id,...o.data(),submittedAt:(c=o.data().submittedAt)==null?void 0:c.toDate(),createdAt:(u=o.data().createdAt)==null?void 0:u.toDate()}});return await Promise.all(s.map(async o=>{const c=await jt(Q(U,"users",o.studentId)),u=c.exists()?c.data():{};return{...o,studentName:u.name||"Unknown Student",studentId:u.studentId||"N/A",rollNumber:u.rollNumber||"N/A"}}))}catch(r){return console.error(" Error getting assignment submissions:",r),[]}}subscribeToAssignmentSubmissions(e,r){return we.subscribeToAssignmentSubmissions(e,r)}async gradeSubmission(e,r,n){try{const s=Q(U,"assignments",e,"submissions",r);await zt(s,{...n,gradedAt:Z(),status:"graded"}),console.log(" Submission graded successfully")}catch(s){throw console.error(" Error grading submission:",s),s}}async markClassAttendance(e,r,n){try{await we.markClassAttendance(e,r,n),console.log(` Attendance marked for ${n.length} students`)}catch(s){throw console.error(" Error marking class attendance:",s),s}}async getClassAttendance(e,r){try{const n=Le(ie(U,"attendance"),qe("classId","==",e),qe("date","==",r));return(await He(n)).docs.map(i=>({id:i.id,...i.data()}))}catch(n){return console.error(" Error getting class attendance:",n),[]}}subscribeToClassAttendance(e,r,n){return we.subscribeToClassAttendance(e,r,n)}async updateStudentMarks(e,r,n){try{await we.updateStudentMarks(e,r,n),console.log(` Marks updated for ${n.length} students`)}catch(s){throw console.error(" Error updating student marks:",s),s}}async getAllStudents(){try{const e=Le(ie(U,"users"),qe("isActive","==",!0),xr("createdAt","desc"));return(await He(e)).docs.map(n=>{var i,o;const s=n.data();return{id:n.id,name:s.name,email:s.email,studentId:s.studentId,class:(i=s.profile)!=null&&i.grade?`Grade ${s.profile.grade}-${s.profile.section}`:"Not Assigned",rollNumber:s.rollNumber||"N/A",avatar:s.avatar,parentContact:s.parentContact||((o=s.profile)==null?void 0:o.parentContact),isActive:s.isActive!==!1}})}catch(e){return console.error(" Error getting all students:",e),[]}}subscribeToAllStudents(e){return we.subscribeToAllStudents(r=>{const n=r.map(s=>{var i,o;return{id:s.id,name:s.name,email:s.email,studentId:s.studentId,class:(i=s.profile)!=null&&i.grade?`Grade ${s.profile.grade}-${s.profile.section}`:"Not Assigned",rollNumber:s.rollNumber||"N/A",avatar:s.avatar,parentContact:s.parentContact||((o=s.profile)==null?void 0:o.parentContact),isActive:s.isActive!==!1}});e(n)})}async getStudentPerformanceData(e){try{const r=Le(ie(U,"attendance"),qe("studentId","==",e),xr("date","desc")),s=(await He(r)).docs.map(m=>m.data()),i=Le(ie(U,"grades"),qe("studentId","==",e),xr("recordedAt","desc")),c=(await He(i)).docs.map(m=>m.data()),u=Le(ie(U,"assignments")),d=await He(u),f=[];for(const m of d.docs){const v=await jt(Q(U,"assignments",m.id,"submissions",e));v.exists()&&f.push({assignment:{id:m.id,...m.data()},submission:v.data()})}return{attendance:s,grades:c,assignments:f,summary:{attendanceRate:s.length>0?s.filter(m=>m.status==="present").length/s.length*100:0,averageGrade:c.length>0?c.reduce((m,v)=>m+v.marks/v.maxMarks*100,0)/c.length:0,assignmentSubmissionRate:f.length>0?f.filter(m=>m.submission.status==="submitted").length/f.length*100:0}}}catch(r){return console.error(" Error getting student performance data:",r),null}}async checkAndSeedFacultyData(){try{const e=await He(ie(U,"faculty"));return e.empty?(console.log(" No faculty data found, seeding initial teacher accounts..."),await this.seedTeacherData(),!0):(console.log(" Faculty collection exists with",e.size,"teachers"),!1)}catch(e){return console.error(" Error checking faculty data:",e),!1}}async seedTeacherData(){try{const e=[{id:"demo-teacher-001",name:"Dr. Sarah Johnson",email:"teacher@demo.com",employeeId:"EMP001",department:"Mathematics",subjects:["Mathematics","Statistics"],experience:8,qualifications:["PhD Mathematics","M.Sc Statistics"]},{id:"teacher-demo-2",name:"Prof. Michael Chen",email:"michael.chen@demo.com",employeeId:"EMP002",department:"Science",subjects:["Physics","Chemistry"],experience:12,qualifications:["PhD Physics","M.Sc Chemistry"]},{id:"teacher-demo-3",name:"Ms. Emily Rodriguez",email:"emily.rodriguez@demo.com",employeeId:"EMP003",department:"Languages",subjects:["English","Literature"],experience:6,qualifications:["MA English Literature","B.Ed"]}],r=[{id:"class-12a-math",name:"Class 12-A Mathematics",subject:"Mathematics",grade:"12",section:"A",teacherId:"demo-teacher-001",students:[],schedule:[{day:"Monday",startTime:"09:00",endTime:"10:00"},{day:"Wednesday",startTime:"10:00",endTime:"11:00"},{day:"Friday",startTime:"11:00",endTime:"12:00"}],isActive:!0},{id:"class-12b-physics",name:"Class 12-B Physics",subject:"Physics",grade:"12",section:"B",teacherId:"teacher-demo-2",students:[],schedule:[{day:"Tuesday",startTime:"09:00",endTime:"10:00"},{day:"Thursday",startTime:"10:00",endTime:"11:00"}],isActive:!0},{id:"class-11a-english",name:"Class 11-A English",subject:"English",grade:"11",section:"A",teacherId:"teacher-demo-3",students:[],schedule:[{day:"Monday",startTime:"14:00",endTime:"15:00"},{day:"Friday",startTime:"14:00",endTime:"15:00"}],isActive:!0}],n=$t(U);for(const s of e){const i=Q(U,"faculty",s.id);n.set(i,{name:s.name,email:s.email,employeeId:s.employeeId,department:s.department,subjects:s.subjects,classes:r.filter(o=>o.teacherId===s.id).map(o=>o.id),qualifications:s.qualifications,experience:s.experience,joinedAt:Z(),isActive:!0,permissions:{canCreateAssignments:!0,canGradeAssignments:!0,canMarkAttendance:!0,canViewReports:!0,canManageClasses:!0}})}for(const s of r){const i=Q(U,"classes",s.id);n.set(i,{...s,createdAt:Z()})}return await n.commit(),console.log(" Teacher and class data seeded successfully"),e}catch(e){throw console.error(" Error seeding teacher data:",e),e}}async createDemoTeacherAccount(){try{const e={name:"Demo Teacher",email:"teacher@demo.com",employeeId:"DEMO001",department:"General",subjects:["Mathematics","Science"]},r="demo-teacher-001";return await this.initializeTeacherProfile(r,e),console.log(" Demo teacher account created with ID:",r),console.log(" Use this email to test: teacher@demo.com"),r}catch(e){throw console.error(" Error creating demo teacher account:",e),e}}}const ge=new XC,ZC=({children:t})=>{const{currentUser:e}=tt(),[r,n]=C.useState(null),[s,i]=C.useState(!0);return C.useEffect(()=>{(async()=>{if(!e){n(!1),i(!1);return}try{const c=await ge.getTeacherProfile(e.uid);n(!!c)}catch(c){console.error("Error checking teacher status:",c),n(!1)}finally{i(!1)}})()},[e]),s?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full"})}):!e||!r?a.jsx(rf,{to:"/teacher-login"}):a.jsx(a.Fragment,{children:t})};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),J=(t,e)=>{const r=C.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,className:c="",children:u,...d},f)=>C.createElement("svg",{ref:f,...eP,width:s,height:s,stroke:n,strokeWidth:o?Number(i)*24/Number(s):i,className:["lucide",`lucide-${tP(t)}`,c].join(" "),...d},[...e.map(([m,v])=>C.createElement(m,v)),...Array.isArray(u)?u:[u]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D_=J("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=J("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=J("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=J("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M_=J("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=J("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pd=J("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=J("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=J("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=J("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fr=J("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=J("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pc=J("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=J("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=J("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=J("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=J("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=J("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=J("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=J("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L_=J("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iP=J("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=J("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dc=J("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O_=J("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=J("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=J("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=J("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F_=J("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=J("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U_=J("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aP=J("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=J("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tr=J("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uo=J("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=J("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=J("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $_=J("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z_=J("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=J("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B_=J("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=J("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=J("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cP=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q_=J("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=J("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=J("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=J("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const im=J("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),uP=({isOpen:t,onToggle:e})=>{const{logout:r}=tt(),n=Ns(),s=async()=>{try{await r(),n("/login")}catch(o){console.error("Failed to log out:",o)}},i=[{to:"/dashboard",icon:L_,text:"Dashboard"},{to:"/dashboard/ai-hub",icon:ur,text:"AI Hub",isNew:!0},{to:"/dashboard/communities",icon:de,text:"Communities",isNew:!0},{to:"/dashboard/events",icon:nm,text:"Events",isNew:!0},{to:"/dashboard/attendance",icon:Ve,text:"Attendance"},{to:"/dashboard/assignments",icon:et,text:"Assignments"},{to:"/dashboard/gpa-predictor",icon:Ft,text:"GPA Predictor"},{to:"/dashboard/messages",icon:ag,text:"Messages"},{to:"/dashboard/learncenter",icon:Gt,text:"LearnCenter"}];return a.jsxs(a.Fragment,{children:[t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:e}),a.jsxs("div",{className:`fixed left-0 top-0 h-full w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 ease-in-out z-50 ${t?"translate-x-0":"-translate-x-full"} lg:translate-x-0 lg:static lg:z-auto`,children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"SortED Student"}),a.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:a.jsx(Ai,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto",children:a.jsx("div",{className:"px-4 py-6 space-y-2",children:i.map(o=>a.jsxs(mw,{to:o.to,className:({isActive:c})=>`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors relative ${c?"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 border-r-2 border-blue-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,onClick:()=>window.innerWidth<1024&&e(),children:[a.jsx(o.icon,{className:"w-5 h-5 mr-3"}),o.text,o.isNew&&a.jsx("span",{className:"ml-auto px-2 py-1 text-xs bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-full",children:"NEW"})]},o.to))})}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:a.jsxs("button",{onClick:s,className:"flex items-center w-full px-4 py-3 text-sm font-medium text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[a.jsx(O_,{className:"w-5 h-5 mr-3"}),"Logout"]})})]})]})},dP=({onSidebarToggle:t})=>{var s;const{isDark:e,toggleTheme:r}=R_(),{currentUser:n}=tt();return a.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 mr-2",children:a.jsx(V_,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),a.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:["Welcome back, ",(n==null?void 0:n.displayName)||"Student","!"]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 relative",children:[a.jsx(M_,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center",children:"3"})]}),a.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e?a.jsx(z_,{className:"w-5 h-5 text-yellow-500"}):a.jsx(U_,{className:"w-5 h-5 text-gray-600"})}),a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-semibold",children:((s=n==null?void 0:n.displayName)==null?void 0:s.charAt(0))||"S"})]})]})})},hP=()=>{const[t,e]=C.useState(!1),r=()=>{e(!t)};return a.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[a.jsx(uP,{isOpen:t,onToggle:r}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden lg:ml-64",children:[a.jsx(dP,{onSidebarToggle:r}),a.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:a.jsx(dw,{})})]})]})},mP=({isOpen:t,onToggle:e})=>{const{logout:r}=tt(),n=Ns(),s=async()=>{try{await r(),n("/teacher-login")}catch(o){console.error("Failed to log out:",o)}},i=[{to:"/teacher-dashboard",icon:L_,text:"Dashboard"},{to:"/teacher-dashboard/classes",icon:as,text:"My Classes"},{to:"/teacher-dashboard/students",icon:de,text:"Students"},{to:"/teacher-dashboard/attendance",icon:Ve,text:"Attendance"},{to:"/teacher-dashboard/assignments",icon:et,text:"Assignments"},{to:"/teacher-dashboard/marks",icon:Ft,text:"Marks"},{to:"/teacher-dashboard/reports",icon:ur,text:"AI Reports",isNew:!0},{to:"/teacher-dashboard/messages",icon:ag,text:"Messages"}];return a.jsxs(a.Fragment,{children:[t&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:e}),a.jsxs("div",{className:`fixed left-0 top-0 h-full w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 ease-in-out z-50 ${t?"translate-x-0":"-translate-x-full"} lg:translate-x-0 lg:static lg:z-auto`,children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[a.jsx("h1",{className:"text-xl font-bold text-emerald-600 dark:text-emerald-400",children:"Teacher Portal"}),a.jsx("button",{onClick:e,className:"lg:hidden p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700",children:a.jsx(Ai,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})]}),a.jsx("nav",{className:"flex-1 overflow-y-auto",children:a.jsx("div",{className:"px-4 py-6 space-y-2",children:i.map(o=>a.jsxs(mw,{to:o.to,className:({isActive:c})=>`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors relative ${c?"bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300 border-r-2 border-emerald-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700"}`,onClick:()=>window.innerWidth<1024&&e(),children:[a.jsx(o.icon,{className:"w-5 h-5 mr-3"}),o.text,o.isNew&&a.jsx("span",{className:"ml-auto px-2 py-1 text-xs bg-gradient-to-r from-emerald-500 to-blue-500 text-white rounded-full",children:"NEW"})]},o.to))})}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:a.jsxs("button",{onClick:s,className:"flex items-center w-full px-4 py-3 text-sm font-medium text-red-600 dark:text-red-400 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[a.jsx(O_,{className:"w-5 h-5 mr-3"}),"Logout"]})})]})]})},fP=({onSidebarToggle:t})=>{var c;const{isDark:e,toggleTheme:r}=R_(),{currentUser:n}=tt(),[s,i]=C.useState(null);C.useEffect(()=>{n&&o()},[n]);const o=async()=>{if(n)try{const u=await ge.getTeacherProfile(n.uid);i(u)}catch(u){console.error("Error loading teacher profile:",u)}};return a.jsx("header",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("button",{onClick:t,className:"lg:hidden p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700 mr-2",children:a.jsx(V_,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})}),a.jsxs("div",{children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:["Welcome back, ",(s==null?void 0:s.name)||"Teacher","!"]}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[s==null?void 0:s.department," Department"]})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 relative",children:[a.jsx(M_,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}),a.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center",children:"2"})]}),a.jsx("button",{onClick:r,className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e?a.jsx(z_,{className:"w-5 h-5 text-yellow-500"}):a.jsx(U_,{className:"w-5 h-5 text-gray-600"})}),a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-emerald-500 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold",children:((c=s==null?void 0:s.name)==null?void 0:c.charAt(0))||"T"})]})]})})},gP=()=>{const[t,e]=C.useState(!1),r=()=>{e(!t)};return a.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[a.jsx(mP,{isOpen:t,onToggle:r}),a.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden lg:ml-64",children:[a.jsx(fP,{onSidebarToggle:r}),a.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:a.jsx(dw,{})})]})]})},pP=()=>{const[t,e]=C.useState(""),[r,n]=C.useState(""),[s,i]=C.useState(!1),[o,c]=C.useState(""),[u,d]=C.useState(!1),{login:f}=tt(),m=Ns(),v=async y=>{y.preventDefault();try{c(""),d(!0),await f(t,r),m("/dashboard")}catch{c("Failed to log in. Please check your credentials.")}finally{d(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-3 rounded-full",children:a.jsx(as,{className:"w-8 h-8 text-white"})})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"SortED Student"}),a.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Sign in to your student account"})]}),a.jsx("form",{className:"mt-8 space-y-6",onSubmit:v,children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700",children:[o&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-300 text-sm",children:o}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(_u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"email",type:"email",required:!0,value:t,onChange:y=>e(y.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter your email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Dc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"password",type:s?"text":"password",required:!0,value:r,onChange:y=>n(y.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter your password"}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:s?a.jsx(Rc,{className:"w-5 h-5"}):a.jsx(Zr,{className:"w-5 h-5"})})]})]})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full mt-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:u?"Signing In...":"Sign In"}),a.jsxs("div",{className:"mt-6 text-center space-y-2",children:[a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Don't have an account?"," ",a.jsx(gs,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300",children:"Sign up"})]}),a.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-4",children:a.jsxs(gs,{to:"/teacher-login",className:"inline-flex items-center px-4 py-2 bg-emerald-100 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300 rounded-lg hover:bg-emerald-200 dark:hover:bg-emerald-900/30 transition-colors text-sm font-medium",children:[a.jsx(de,{className:"w-4 h-4 mr-2"}),"Login as Teacher"]})})]})]})})]})})},yP=()=>{const[t,e]=C.useState("teacher@demo.com"),[r,n]=C.useState("demo123"),[s,i]=C.useState(!1),[o,c]=C.useState(""),[u,d]=C.useState(!1),[f,m]=C.useState(!1),[v,y]=C.useState(!1),j=Ns();C.useEffect(()=>{A()},[]);const A=async()=>{try{await ge.checkAndSeedFacultyData()&&y(!0)}catch(N){console.error("Error checking faculty data:",N)}},R=async()=>{m(!0);try{try{await Yw(Xs,"teacher@demo.com","demo123"),console.log(" Demo teacher Firebase Auth account created")}catch(N){if(N.code==="auth/email-already-in-use")console.log(" Demo teacher account already exists in Firebase Auth");else throw N}await ge.createDemoTeacherAccount(),y(!1),c(""),alert(` Demo teacher account setup complete! You can now login with:
Email: teacher@demo.com
Password: demo123`)}catch(N){console.error("Error setting up demo account:",N),c("Failed to setup demo account: "+N.message)}finally{m(!1)}},_=async N=>{N.preventDefault();try{c(""),d(!0);const I=await Jw(Xs,t,r);if(console.log(" Firebase Auth successful for:",I.user.uid),!await ge.getTeacherProfile(I.user.uid))if(t==="teacher@demo.com"){console.log(" Creating demo teacher profile..."),await ge.initializeTeacherProfile(I.user.uid,{name:"Demo Teacher",email:"teacher@demo.com",employeeId:"DEMO001",department:"General",subjects:["Mathematics","Science"]}),await ge.updateLastLogin(I.user.uid),console.log(" Demo teacher profile created and logged in"),j("/teacher-dashboard");return}else throw new Error("Access denied. Teacher account not found.");await ge.updateLastLogin(I.user.uid),console.log(" Teacher login successful"),j("/teacher-dashboard")}catch(I){console.error(" Login error:",I),I.code==="auth/user-not-found"||I.code==="auth/wrong-password"?c("Invalid email or password."):I.code==="auth/invalid-email"?c("Invalid email address."):I.code==="auth/invalid-credential"?c("Invalid credentials. Please check your email and password."):c(I.message||"Failed to log in. Please try again.")}finally{d(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-emerald-50 via-white to-blue-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"bg-gradient-to-r from-emerald-600 to-blue-600 p-3 rounded-full",children:a.jsx(de,{className:"w-8 h-8 text-white"})})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Teacher Portal"}),a.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Sign in to your teacher account"})]}),v&&a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6 mb-6",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(Cc,{className:"w-6 h-6 text-blue-600 dark:text-blue-400 mt-1"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-2",children:"Setup Required"}),a.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mb-4",children:"No teacher accounts found. Click below to create a demo teacher account for testing."}),a.jsxs("button",{onClick:R,disabled:f,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[a.jsx(Cc,{className:"w-4 h-4 mr-2"}),f?"Setting up...":"Setup Demo Account"]})]})]})}),a.jsx("form",{className:"mt-8 space-y-6",onSubmit:_,children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700",children:[o&&a.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-300 text-sm flex items-start",children:[a.jsx(D_,{className:"w-4 h-4 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:o})]}),a.jsxs("div",{className:"mb-4 p-3 bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-lg",children:[a.jsx("h4",{className:"text-sm font-semibold text-emerald-900 dark:text-emerald-100 mb-2",children:" Demo Credentials"}),a.jsxs("div",{className:"text-xs text-emerald-700 dark:text-emerald-300 space-y-1",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Email:"})," teacher@demo.com"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Password:"})," demo123"]}),a.jsx("p",{className:"text-emerald-600 dark:text-emerald-400",children:"These credentials are pre-filled for easy testing."})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(_u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"email",type:"email",required:!0,value:t,onChange:N=>e(N.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter your email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Dc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"password",type:s?"text":"password",required:!0,value:r,onChange:N=>n(N.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter your password"}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:s?a.jsx(Rc,{className:"w-5 h-5"}):a.jsx(Zr,{className:"w-5 h-5"})})]})]})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full mt-6 bg-gradient-to-r from-emerald-600 to-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:from-emerald-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:u?"Signing In...":"Sign In as Teacher"}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Student?"," ",a.jsx(gs,{to:"/login",className:"font-medium text-emerald-600 hover:text-emerald-500 dark:text-emerald-400 dark:hover:text-emerald-300",children:"Student Login"})]})})]})})]})})},xP=()=>{const[t,e]=C.useState({name:"",email:"",password:"",confirmPassword:""}),[r,n]=C.useState(!1),[s,i]=C.useState(!1),[o,c]=C.useState(""),[u,d]=C.useState(!1),{register:f}=tt(),m=Ns(),v=j=>{e({...t,[j.target.name]:j.target.value})},y=async j=>{if(j.preventDefault(),t.password!==t.confirmPassword)return c("Passwords do not match");if(t.password.length<6)return c("Password must be at least 6 characters long");try{c(""),d(!0),await f(t.email,t.password,t.name),m("/dashboard")}catch{c("Failed to create account. Please try again.")}finally{d(!1)}};return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center px-4",children:a.jsxs("div",{className:"max-w-md w-full space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-3 rounded-full",children:a.jsx(as,{className:"w-8 h-8 text-white"})})}),a.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Join SortED Student"}),a.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Create your student account"})]}),a.jsx("form",{className:"mt-8 space-y-6",onSubmit:y,children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 p-8 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700",children:[o&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-300 text-sm",children:o}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Full Name"}),a.jsxs("div",{className:"relative",children:[a.jsx(q_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"name",name:"name",type:"text",required:!0,value:t.name,onChange:v,className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter your full name"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx(_u,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:t.email,onChange:v,className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter your email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Dc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"password",name:"password",type:r?"text":"password",required:!0,value:t.password,onChange:v,className:"w-full pl-10 pr-12 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Create a password"}),a.jsx("button",{type:"button",onClick:()=>n(!r),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:r?a.jsx(Rc,{className:"w-5 h-5"}):a.jsx(Zr,{className:"w-5 h-5"})})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirm Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(Dc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:s?"text":"password",required:!0,value:t.confirmPassword,onChange:v,className:"w-full pl-10 pr-12 py-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Confirm your password"}),a.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:s?a.jsx(Rc,{className:"w-5 h-5"}):a.jsx(Zr,{className:"w-5 h-5"})})]})]})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full mt-6 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-3 px-4 rounded-lg font-medium hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:u?"Creating Account...":"Create Account"}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Already have an account?"," ",a.jsx(gs,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300",children:"Sign in"})]})})]})})]})})},Ro=()=>{const{currentUser:t}=tt();return C.useEffect(()=>{(async()=>{if(t)try{await we.initializeUserProfile(t.uid,{name:t.displayName||"Student",email:t.email||"",studentId:`STU-${Date.now()}`})}catch(r){console.error("Error initializing user profile:",r)}})()},[t]),{currentUser:t}},vP=()=>{var v,y,j,A,R,_,N,I,P,O,D,w,x,g,k,b,S,T,V,ee,be,De,H,X;const{currentUser:t}=Ro(),[e,r]=C.useState(null),[n,s]=C.useState(!1),[i,o]=C.useState(!1);C.useEffect(()=>{t&&c()},[t]);const c=async()=>{if(t)try{const B=await we.getUserCompleteData(t.uid);r(B)}catch(B){console.error("Error loading user stats:",B)}},u=async()=>{if(t){s(!0);try{await we.refreshUserData(t.uid),await c(),alert(" All user data has been refreshed! Check your Firebase console.")}catch(B){console.error("Error refreshing data:",B),alert(" Error refreshing data. Check console for details.")}finally{s(!1)}}},d=[{title:"Attendance Rate",value:(y=(v=e==null?void 0:e.profile)==null?void 0:v.stats)!=null&&y.attendancePercentage?`${e.profile.stats.attendancePercentage}%`:"92%",change:"+2%",changeType:"positive",icon:Ve,color:"bg-green-500",dbCount:((j=e==null?void 0:e.summary)==null?void 0:j.totalAttendanceRecords)||0},{title:"Assignments",value:((A=e==null?void 0:e.summary)==null?void 0:A.totalAssignments)||"6",change:(R=e==null?void 0:e.summary)!=null&&R.totalAssignments?`${e.summary.totalAssignments} in DB`:"Mock data",changeType:"neutral",icon:et,color:"bg-orange-500",dbCount:((_=e==null?void 0:e.summary)==null?void 0:_.totalAssignments)||0},{title:"Current GPA",value:(I=(N=e==null?void 0:e.profile)==null?void 0:N.stats)!=null&&I.currentGPA?e.profile.stats.currentGPA.toFixed(1):"8.7",change:"+0.2",changeType:"positive",icon:Ft,color:"bg-blue-500",dbCount:((P=e==null?void 0:e.summary)==null?void 0:P.totalGrades)||0},{title:"Communities",value:((D=(O=e==null?void 0:e.profile)==null?void 0:O.stats)==null?void 0:D.communitiesJoined)||"2",change:(x=(w=e==null?void 0:e.profile)==null?void 0:w.joinedCommunities)!=null&&x.length?`${e.profile.joinedCommunities.length} joined`:"Mock data",changeType:"neutral",icon:de,color:"bg-purple-500",dbCount:((k=(g=e==null?void 0:e.profile)==null?void 0:g.joinedCommunities)==null?void 0:k.length)||0}],f=[{type:"assignment",title:"Mathematics Assignment #5 submitted",time:"2 hours ago",icon:fr,color:"text-green-500",inDb:((b=e==null?void 0:e.summary)==null?void 0:b.totalAssignments)>0},{type:"attendance",title:"Attendance marked for today",time:"4 hours ago",icon:Ve,color:"text-blue-500",inDb:((S=e==null?void 0:e.summary)==null?void 0:S.totalAttendanceRecords)>0},{type:"community",title:"Joined Technology Club",time:"1 day ago",icon:de,color:"text-purple-500",inDb:((V=(T=e==null?void 0:e.profile)==null?void 0:T.joinedCommunities)==null?void 0:V.length)>0},{type:"grade",title:"New grade recorded for Physics",time:"2 days ago",icon:Ft,color:"text-emerald-500",inDb:((ee=e==null?void 0:e.summary)==null?void 0:ee.totalGrades)>0}],m=[{title:"View Attendance",link:"/dashboard/attendance",icon:Ve,color:"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300 hover:bg-green-100 dark:hover:bg-green-900/30"},{title:"Submit Assignment",link:"/dashboard/assignments",icon:et,color:"bg-orange-50 text-orange-700 dark:bg-orange-900/20 dark:text-orange-300 hover:bg-orange-100 dark:hover:bg-orange-900/30"},{title:"Check GPA",link:"/dashboard/gpa-predictor",icon:Ft,color:"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-900/30"},{title:"Join Communities",link:"/dashboard/communities",icon:de,color:"bg-purple-50 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300 hover:bg-purple-100 dark:hover:bg-purple-900/30"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Dashboard Overview"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last updated: ",new Date().toLocaleDateString(),t&&a.jsxs("span",{className:"ml-2 text-blue-600 dark:text-blue-400",children:[" User ID: ",t.uid.slice(0,8),"..."]})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:()=>o(!i),className:"flex items-center px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors text-sm",children:[a.jsx(Cc,{className:"w-4 h-4 mr-2"}),i?"Hide":"Show"," DB Info"]}),a.jsxs("button",{onClick:u,disabled:n,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[a.jsx(uo,{className:`w-4 h-4 mr-2 ${n?"animate-spin":""}`}),n?"Refreshing...":"Refresh Data"]})]})]}),i&&a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-3 flex items-center",children:[a.jsx(Cc,{className:"w-5 h-5 mr-2"}),"Firebase Database Status"]}),a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Attendance Records:"}),a.jsx("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:((be=e==null?void 0:e.summary)==null?void 0:be.totalAttendanceRecords)||0})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Assignment Submissions:"}),a.jsx("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:((De=e==null?void 0:e.summary)==null?void 0:De.totalAssignments)||0})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Grade Records:"}),a.jsx("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:((H=e==null?void 0:e.summary)==null?void 0:H.totalGrades)||0})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-blue-700 dark:text-blue-300 font-medium",children:"Certificates:"}),a.jsx("span",{className:"ml-2 text-blue-900 dark:text-blue-100",children:((X=e==null?void 0:e.summary)==null?void 0:X.totalCertificates)||0})]})]}),a.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:' Click "Refresh Data" to rebuild all database records. Check your Firebase console to see the data structure.'})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:d.map((B,ue)=>a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:B.title}),a.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1",children:B.value}),a.jsx("p",{className:`text-sm mt-1 ${B.changeType==="positive"?"text-green-600 dark:text-green-400":B.changeType==="negative"?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}`,children:B.change}),i&&a.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:["DB Records: ",B.dbCount]})]}),a.jsx("div",{className:`p-3 rounded-full ${B.color}`,children:a.jsx(B.icon,{className:"w-6 h-6 text-white"})})]})},ue))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),a.jsx("div",{className:"space-y-3",children:m.map((B,ue)=>a.jsxs(gs,{to:B.link,className:`flex items-center p-3 rounded-lg transition-colors ${B.color}`,children:[a.jsx(B.icon,{className:"w-5 h-5 mr-3"}),a.jsx("span",{className:"font-medium",children:B.title})]},ue))})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Activity"}),a.jsx(gs,{to:"/dashboard/messages",className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300",children:"View all"})]}),a.jsx("div",{className:"space-y-4",children:f.map((B,ue)=>a.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[a.jsx(B.icon,{className:`w-5 h-5 mt-0.5 ${B.color}`}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:B.title}),a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[a.jsx(St,{className:"w-3 h-3 mr-1"}),B.time]}),i&&a.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full ${B.inDb?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300"}`,children:B.inDb?"In DB":"Mock"})]})]})]},ue))})]})})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Upcoming Deadlines"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{subject:"Physics",title:"Lab Report",due:"2 days",priority:"high"},{subject:"Mathematics",title:"Problem Set #8",due:"5 days",priority:"medium"},{subject:"Chemistry",title:"Research Paper",due:"1 week",priority:"low"}].map((B,ue)=>a.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:B.subject}),a.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${B.priority==="high"?"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300":B.priority==="medium"?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300"}`,children:B.priority})]}),a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:B.title}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Due in ",B.due]})]},ue))})]})]})},wP=()=>{const{currentUser:t}=Ro(),[e,r]=C.useState(new Date().getMonth()),[n,s]=C.useState(new Date().getFullYear()),[i,o]=C.useState([]),[c,u]=C.useState(!1);C.useEffect(()=>{t&&d()},[t,e,n]);const d=async()=>{if(t)try{const w=await we.getUserCompleteData(t.uid);if(w.attendance&&w.attendance.length>0){const x=w.attendance.map(g=>({date:g.date,status:g.status}));o(x)}else o(v)}catch(w){console.error("Error loading attendance data:",w),o(v)}},f=async(w,x)=>{if(t){u(!0);try{await we.markAttendance(t.uid,w,x),o(g=>g.find(b=>b.date===w)?g.map(b=>b.date===w?{...b,status:x}:b):[...g,{date:w,status:x}]),console.log(" Attendance marked successfully")}catch(g){console.error(" Error marking attendance:",g)}finally{u(!1)}}},m=async()=>{if(t){u(!0);try{await we.refreshUserData(t.uid),await d(),alert(" Attendance data refreshed! Check your Firebase console.")}catch(w){console.error("Error refreshing attendance data:",w),alert(" Error refreshing data. Check console for details.")}finally{u(!1)}}},v=[{date:"2024-01-15",status:"present"},{date:"2024-01-16",status:"present"},{date:"2024-01-17",status:"absent"},{date:"2024-01-18",status:"present"},{date:"2024-01-19",status:"late"},{date:"2024-01-22",status:"present"},{date:"2024-01-23",status:"present"},{date:"2024-01-24",status:"present"},{date:"2024-01-25",status:"present"},{date:"2024-01-26",status:"absent"}],y=i.length,j=i.filter(w=>w.status==="present").length,A=i.filter(w=>w.status==="absent").length,R=i.filter(w=>w.status==="late").length,_=y>0?Math.round(j/y*100):0,N=["January","February","March","April","May","June","July","August","September","October","November","December"],I=(w,x)=>new Date(x,w+1,0).getDate(),P=(w,x)=>new Date(x,w,1).getDay(),O=()=>{const w=I(e,n),x=P(e,n),g=[];for(let k=0;k<x;k++)g.push(a.jsx("div",{className:"h-10"},`empty-${k}`));for(let k=1;k<=w;k++){const b=`${n}-${String(e+1).padStart(2,"0")}-${String(k).padStart(2,"0")}`,S=i.find(V=>V.date===b),T=b===new Date().toISOString().split("T")[0];g.push(a.jsxs("div",{className:`h-10 flex items-center justify-center rounded-lg text-sm font-medium cursor-pointer transition-colors relative ${S?S.status==="present"?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":S.status==="absent"?"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300":T?"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300 hover:bg-blue-200 dark:hover:bg-blue-900/30":"hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,onClick:()=>{if(T&&!S){const V=window.confirm("Mark attendance as Present?")?"present":window.confirm("Mark as Absent?")?"absent":"late";f(b,V)}},children:[k,T&&!S&&a.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full"})]},k))}return g},D=[{title:"Overall Attendance",value:`${_}%`,icon:Ft,color:_>=90?"text-green-600":_>=75?"text-yellow-600":"text-red-600",bgColor:_>=90?"bg-green-50 dark:bg-green-900/20":_>=75?"bg-yellow-50 dark:bg-yellow-900/20":"bg-red-50 dark:bg-red-900/20"},{title:"Present Days",value:j,icon:fr,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Absent Days",value:A,icon:sm,color:"text-red-600",bgColor:"bg-red-50 dark:bg-red-900/20"},{title:"Late Days",value:R,icon:D_,color:"text-yellow-600",bgColor:"bg-yellow-50 dark:bg-yellow-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Attendance"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Track your attendance records  ",i.length," records in database"]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("button",{onClick:m,disabled:c,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[a.jsx(uo,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),"Refresh Data"]}),a.jsx("select",{value:e,onChange:w=>r(parseInt(w.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:N.map((w,x)=>a.jsx("option",{value:x,children:w},x))}),a.jsxs("select",{value:n,onChange:w=>s(parseInt(w.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:2024,children:"2024"}),a.jsx("option",{value:2023,children:"2023"})]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:D.map((w,x)=>a.jsx("div",{className:`${w.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:w.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${w.color}`,children:w.value})]}),a.jsx(w.icon,{className:`w-8 h-8 ${w.color}`})]})},x))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ve,{className:"w-6 h-6 text-gray-600 dark:text-gray-400 mr-3"}),a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[N[e]," ",n]})]}),a.jsxs("button",{onClick:()=>{const w=new Date().toISOString().split("T")[0];f(w,"present")},disabled:c,className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors text-sm",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Mark Today"]})]}),a.jsx("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(w=>a.jsx("div",{className:"h-10 flex items-center justify-center text-sm font-medium text-gray-500 dark:text-gray-400",children:w},w))}),a.jsx("div",{className:"grid grid-cols-7 gap-2",children:O()}),a.jsxs("div",{className:"flex items-center justify-center space-x-6 mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-4 h-4 bg-green-100 dark:bg-green-900/20 rounded mr-2"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Present"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-4 h-4 bg-red-100 dark:bg-red-900/20 rounded mr-2"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Absent"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-4 h-4 bg-yellow-100 dark:bg-yellow-900/20 rounded mr-2"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Late"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-4 h-4 bg-blue-100 dark:bg-blue-900/20 rounded mr-2"}),a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Today"})]})]})]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Monthly Progress"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Attendance Rate"}),a.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[_,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full ${_>=90?"bg-green-500":_>=75?"bg-yellow-500":"bg-red-500"}`,style:{width:`${_}%`}})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:j}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Present"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:A}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Absent"})]})]})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Stats"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Classes"}),a.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:y})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Classes Attended"}),a.jsx("span",{className:"text-sm font-medium text-green-600 dark:text-green-400",children:j})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Classes Missed"}),a.jsx("span",{className:"text-sm font-medium text-red-600 dark:text-red-400",children:A})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Late Arrivals"}),a.jsx("span",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400",children:R})]})]})]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" Database Info"}),a.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:'Your attendance is automatically saved to Firebase. Click "Refresh Data" to rebuild records or check your Firebase console.'})]})]})]})]})},bP=()=>{const{currentUser:t}=Ro(),[e,r]=C.useState("all"),[n,s]=C.useState("dueDate"),[i,o]=C.useState([]),[c,u]=C.useState([]),[d,f]=C.useState(!1);C.useEffect(()=>{t&&m()},[t]);const m=async()=>{if(t)try{const P=await we.getUserCompleteData(t.uid);if(P.assignments&&P.assignments.length>0){const O=P.assignments.map(D=>{var w;return{id:D.assignment.id,subject:D.assignment.subject,title:D.assignment.title,dueDate:D.assignment.dueDate,description:D.assignment.description,status:((w=D.submission)==null?void 0:w.status)==="submitted"?"submitted":new Date(D.assignment.dueDate)<new Date?"overdue":"pending"}});o(O),u(P.assignments.map(D=>D.submission))}else o(j)}catch(P){console.error("Error loading assignments:",P),o(j)}},v=async P=>{if(t){f(!0);try{await we.submitAssignment(P,t.uid,{content:`Assignment submission for ${P}`,attachments:[]}),o(O=>O.map(D=>D.id===P?{...D,status:"submitted"}:D)),alert(" Assignment submitted successfully!")}catch(O){console.error(" Error submitting assignment:",O),alert(" Error submitting assignment. Check console for details.")}finally{f(!1)}}},y=async()=>{if(t){f(!0);try{await we.refreshUserData(t.uid),await m(),alert(" Assignment data refreshed! Check your Firebase console.")}catch(P){console.error("Error refreshing assignments:",P),alert(" Error refreshing data. Check console for details.")}finally{f(!1)}}},j=[{id:"1",subject:"Mathematics",title:"Calculus Problem Set #8",dueDate:"2024-01-25",status:"pending",description:"Complete problems 1-15 from Chapter 8"},{id:"2",subject:"Physics",title:"Lab Report: Motion Analysis",dueDate:"2024-01-22",status:"overdue",description:"Write a detailed report on the motion analysis experiment"},{id:"3",subject:"Chemistry",title:"Research Paper: Organic Compounds",dueDate:"2024-01-30",status:"pending",description:"Research and write about organic compound applications"},{id:"4",subject:"English",title:"Essay: Modern Literature",dueDate:"2024-01-20",status:"submitted",description:"Analyze themes in modern literature"},{id:"5",subject:"History",title:"Timeline Project",dueDate:"2024-01-28",status:"pending",description:"Create a timeline of major historical events"},{id:"6",subject:"Computer Science",title:"Algorithm Implementation",dueDate:"2024-01-26",status:"submitted",description:"Implement sorting algorithms in Python"}],A=i.filter(P=>e==="all"||P.status===e).sort((P,O)=>{switch(n){case"dueDate":return new Date(P.dueDate).getTime()-new Date(O.dueDate).getTime();case"subject":return P.subject.localeCompare(O.subject);case"status":return P.status.localeCompare(O.status);default:return 0}}),R=P=>{switch(P){case"pending":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300";case"submitted":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"overdue":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},_=P=>{switch(P){case"pending":return a.jsx(St,{className:"w-4 h-4"});case"submitted":return a.jsx(fr,{className:"w-4 h-4"});case"overdue":return a.jsx(co,{className:"w-4 h-4"});default:return a.jsx(et,{className:"w-4 h-4"})}},N=P=>{const O=new Date,w=new Date(P).getTime()-O.getTime(),x=Math.ceil(w/(1e3*60*60*24));return x<0?`${Math.abs(x)} days overdue`:x===0?"Due today":x===1?"Due tomorrow":`Due in ${x} days`},I=[{title:"Total Assignments",value:i.length,icon:et,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Pending",value:i.filter(P=>P.status==="pending").length,icon:St,color:"text-yellow-600",bgColor:"bg-yellow-50 dark:bg-yellow-900/20"},{title:"Submitted",value:i.filter(P=>P.status==="submitted").length,icon:fr,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Overdue",value:i.filter(P=>P.status==="overdue").length,icon:co,color:"text-red-600",bgColor:"bg-red-50 dark:bg-red-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Assignments"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Manage your assignments  ",i.length," assignments in database"]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{onClick:y,disabled:d,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 transition-colors",children:[a.jsx(uo,{className:`w-4 h-4 mr-2 ${d?"animate-spin":""}`}),"Refresh Data"]}),a.jsxs("button",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"New Assignment"]})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:I.map((P,O)=>a.jsx("div",{className:`${P.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:P.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${P.color}`,children:P.value})]}),a.jsx(P.icon,{className:`w-8 h-8 ${P.color}`})]})},O))}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Po,{className:"w-5 h-5 text-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filter:"}),a.jsxs("select",{value:e,onChange:P=>r(P.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"pending",children:"Pending"}),a.jsx("option",{value:"submitted",children:"Submitted"}),a.jsx("option",{value:"overdue",children:"Overdue"})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Sort by:"}),a.jsxs("select",{value:n,onChange:P=>s(P.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[a.jsx("option",{value:"dueDate",children:"Due Date"}),a.jsx("option",{value:"subject",children:"Subject"}),a.jsx("option",{value:"status",children:"Status"})]})]})]})}),a.jsx("div",{className:"space-y-4",children:A.map(P=>a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[a.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-300 text-xs font-medium rounded-full",children:P.subject}),a.jsxs("span",{className:`px-3 py-1 text-xs font-medium rounded-full flex items-center space-x-1 ${R(P.status)}`,children:[_(P.status),a.jsx("span",{className:"capitalize",children:P.status})]})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:P.title}),P.description&&a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:P.description}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500 dark:text-gray-400",children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(Ve,{className:"w-4 h-4"}),a.jsxs("span",{children:["Due: ",new Date(P.dueDate).toLocaleDateString()]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[a.jsx(St,{className:"w-4 h-4"}),a.jsx("span",{children:N(P.dueDate)})]})]})]}),a.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[P.status==="pending"&&a.jsxs("button",{onClick:()=>v(P.id),disabled:d,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors text-sm",children:[a.jsx(cP,{className:"w-4 h-4 mr-2"}),"Submit"]}),a.jsx("button",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm",children:"View Details"})]})]})},P.id))}),A.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(et,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No assignments found"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:e==="all"?"You don't have any assignments yet.":`No ${e} assignments found.`})]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4",children:[a.jsx("h4",{className:"text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:" Database Info"}),a.jsx("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:`Assignment submissions are automatically saved to Firebase with grades and feedback. Click "Refresh Data" to rebuild records or check your Firebase console under 'assignments' collection.`})]})]})};var $y={};class _P{constructor(){Wu(this,"baseURL");Wu(this,"apiKey");this.baseURL=$y.REACT_APP_AI_SERVICE_URL||"http://localhost:8000",this.apiKey=$y.REACT_APP_AI_API_KEY||null}async makeRequest(e,r){try{const n={"Content-Type":"application/json"};this.apiKey&&(n.Authorization=`Bearer ${this.apiKey}`);const s=await fetch(`${this.baseURL}${e}`,{method:"POST",headers:n,body:JSON.stringify(r)});if(!s.ok)throw new Error(`AI Service Error: ${s.status} ${s.statusText}`);return await s.json()}catch(n){throw console.error("AI Service request failed:",n),n}}async predictGPA(e){try{return await this.makeRequest("/predict-gpa",e)}catch{return console.warn("Using mock GPA prediction response"),{predictedGPA:8.5,confidence:.85,recommendations:["Focus more on Mathematics - allocate 2 extra hours per week","Join study groups for Physics to improve understanding","Consider getting tutoring for Chemistry concepts"],subjectInsights:e.subjects.map(n=>({subject:n.name,recommendedStudyHours:Math.ceil(n.creditHours*2.5),improvementPotential:Math.random()*.5+.3,riskLevel:n.currentGrade<70?"high":n.currentGrade<80?"medium":"low"}))}}}async getStudyAssistance(e){try{return await this.makeRequest("/study-assistant",e)}catch{return console.warn("Using mock study assistant response"),{response:`I understand you're asking about "${e.message}". Here's what I can help you with based on the context.`,suggestions:["Try breaking down the problem into smaller parts","Review the fundamental concepts first","Practice with similar examples"],resources:[{title:"Khan Academy - Related Topic",type:"video",url:"https://khanacademy.org"}]}}}async getAssignmentHelp(e){try{return await this.makeRequest("/assignment-help",e)}catch{console.warn("Using mock assignment help response");const n=Math.ceil((new Date(e.dueDate).getTime()-new Date().getTime())/(1e3*60*60*24));return{suggestions:["Start with research and outline creation","Break the assignment into manageable sections","Set daily goals to avoid last-minute rush","Review assignment requirements carefully"],studyPlan:[{task:"Research and gather sources",estimatedTime:Math.max(2,Math.floor(n*.3)),priority:"high"},{task:"Create detailed outline",estimatedTime:Math.max(1,Math.floor(n*.2)),priority:"high"},{task:"Write first draft",estimatedTime:Math.max(3,Math.floor(n*.4)),priority:"medium"},{task:"Review and edit",estimatedTime:Math.max(1,Math.floor(n*.1)),priority:"medium"}],resources:[{title:`${e.subject} Study Guide`,type:"article",url:"#"}]}}}async getLearningRecommendations(e){try{return await this.makeRequest("/learning-recommendations",e)}catch{return console.warn("Using mock learning recommendations"),{recommendations:[{title:"Advanced Calculus Concepts",type:"video",subject:"Mathematics",difficulty:"intermediate",estimatedTime:45,relevanceScore:.92,url:"#"},{title:"Physics Problem Solving Techniques",type:"practice",subject:"Physics",difficulty:"beginner",estimatedTime:30,relevanceScore:.88,url:"#"}]}}}async optimizeSchedule(e){try{return await this.makeRequest("/optimize-schedule",e)}catch{return console.warn("Using mock schedule optimization"),{optimizedSchedule:e.assignments.map((n,s)=>({assignmentId:n.id,scheduledDate:new Date(Date.now()+s*24*60*60*1e3).toISOString().split("T")[0],startTime:"14:00",endTime:"16:00",estimatedProductivity:.8+Math.random()*.2})),insights:["Schedule high-priority assignments during your peak productivity hours","Consider grouping similar subjects together for better focus"],warnings:["You have overlapping deadlines next week - consider starting early"]}}}async checkServiceHealth(){try{return(await fetch(`${this.baseURL}/health`)).ok}catch{return!1}}}const Do=new _P,kP=()=>{const[t,e]=C.useState([{name:"Mathematics",marks:85,maxMarks:100},{name:"Physics",marks:78,maxMarks:100},{name:"Chemistry",marks:92,maxMarks:100},{name:"English",marks:88,maxMarks:100},{name:"Computer Science",marks:95,maxMarks:100}]),[r,n]=C.useState({name:"",marks:0,maxMarks:100}),[s,i]=C.useState(9),[o,c]=C.useState(!1),[u,d]=C.useState(null),[f,m]=C.useState(!1),[v,y]=C.useState(20),[j,A]=C.useState(3),R=g=>{if(g.length===0)return 0;const b=g.reduce((S,T)=>S+T.marks/T.maxMarks*100,0)/g.length;return b>=90?10:b>=80?9:b>=70?8:b>=60?7:b>=50?6:b>=40?5:4},_=g=>g>=90?"A+":g>=80?"A":g>=70?"B+":g>=60?"B":g>=50?"C+":g>=40?"C":"F",N=R(t),I=()=>{r.name&&r.marks>=0&&r.maxMarks>0&&(e([...t,{...r}]),n({name:"",marks:0,maxMarks:100}),c(!1))},P=g=>{e(t.filter((k,b)=>b!==g))},O=(g,k,b)=>{const S=t.map((T,V)=>V===g?{...T,[k]:b}:T);e(S)},D=async()=>{m(!0);try{const g={subjects:t.map(b=>({name:b.name,currentGrade:b.marks/b.maxMarks*100,creditHours:3,difficulty:b.name.toLowerCase().includes("math")||b.name.toLowerCase().includes("physics")?"hard":"medium"})),targetGPA:s,currentSemester:j,studyHoursPerWeek:v},k=await Do.predictGPA(g);d(k)}catch(g){console.error("Failed to get AI prediction:",g)}finally{m(!1)}},w=g=>{switch(g){case"low":return"text-green-600 bg-green-100 dark:bg-green-900/20 dark:text-green-300";case"medium":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20 dark:text-yellow-300";case"high":return"text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-300"}},x=[{title:"Current GPA",value:N.toFixed(1),icon:Ft,color:N>=8?"text-green-600":N>=6?"text-yellow-600":"text-red-600",bgColor:N>=8?"bg-green-50 dark:bg-green-900/20":N>=6?"bg-yellow-50 dark:bg-yellow-900/20":"bg-red-50 dark:bg-red-900/20"},{title:"AI Predicted GPA",value:u?u.predictedGPA.toFixed(1):"--",icon:ur,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Total Subjects",value:t.length,icon:Gt,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Target GPA",value:s.toFixed(1),icon:B_,color:"text-emerald-600",bgColor:"bg-emerald-50 dark:bg-emerald-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[a.jsx(ur,{className:"w-8 h-8 mr-3 text-purple-600"}),"AI-Enhanced GPA Predictor"]}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Advanced GPA prediction powered by your custom AI model"})]}),a.jsxs("button",{onClick:()=>c(!o),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Add Subject"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((g,k)=>a.jsx("div",{className:`${g.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:g.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${g.color}`,children:g.value}),g.title==="AI Predicted GPA"&&u&&a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:[Math.round(u.confidence*100),"% confidence"]})]}),a.jsx(g.icon,{className:`w-8 h-8 ${g.color}`})]})},k))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-1",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 mb-6",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center",children:[a.jsx(im,{className:"w-5 h-5 mr-2 text-purple-600"}),"AI Configuration"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Current Semester"}),a.jsx("input",{type:"number",min:"1",max:"8",value:j,onChange:g=>A(parseInt(g.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Study Hours per Week"}),a.jsx("input",{type:"number",min:"1",max:"80",value:v,onChange:g=>y(parseInt(g.target.value)||20),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Target GPA"}),a.jsx("input",{type:"number",min:"4",max:"10",step:"0.1",value:s,onChange:g=>i(parseFloat(g.target.value)||4),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsx("button",{onClick:D,disabled:f||t.length===0,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-4 rounded-lg font-medium hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center",children:f?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"}),"Analyzing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ur,{className:"w-5 h-5 mr-2"}),"Get AI Prediction"]})})]})]}),u&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"AI Insights"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:u.predictedGPA.toFixed(1)}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Predicted GPA (",Math.round(u.confidence*100),"% confidence)"]})]}),u.recommendations.length>0&&a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:"Recommendations"}),a.jsx("div",{className:"space-y-2",children:u.recommendations.map((g,k)=>a.jsx("div",{className:"p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg text-sm text-purple-800 dark:text-purple-300",children:g},k))})]})]})]})]}),a.jsxs("div",{className:"lg:col-span-2 space-y-4",children:[o&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Add New Subject"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx("input",{type:"text",placeholder:"Subject name",value:r.name,onChange:g=>n({...r,name:g.target.value}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("input",{type:"number",placeholder:"Marks obtained",value:r.marks,onChange:g=>n({...r,marks:parseInt(g.target.value)||0}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("input",{type:"number",placeholder:"Maximum marks",value:r.maxMarks,onChange:g=>n({...r,maxMarks:parseInt(g.target.value)||100}),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{className:"flex space-x-3 mt-4",children:[a.jsx("button",{onClick:I,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Add Subject"}),a.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"})]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Subject Grades"}),a.jsx("div",{className:"space-y-4",children:t.map((g,k)=>a.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[a.jsx("div",{className:"flex-1",children:a.jsx("input",{type:"text",value:g.name,onChange:b=>O(k,"name",b.target.value),className:"font-medium text-gray-900 dark:text-white bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 py-1"})}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"number",value:g.marks,onChange:b=>O(k,"marks",parseInt(b.target.value)||0),className:"w-16 px-2 py-1 text-center border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"/"}),a.jsx("input",{type:"number",value:g.maxMarks,onChange:b=>O(k,"maxMarks",parseInt(b.target.value)||100),className:"w-16 px-2 py-1 text-center border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 w-16 text-center",children:[(g.marks/g.maxMarks*100).toFixed(1),"%"]}),a.jsx("div",{className:`text-sm font-bold w-10 text-center ${_(g.marks/g.maxMarks*100)==="A+"?"text-green-600":_(g.marks/g.maxMarks*100)==="A"?"text-blue-600":_(g.marks/g.maxMarks*100).includes("B")?"text-yellow-600":"text-red-600"}`,children:_(g.marks/g.maxMarks*100)}),a.jsx("button",{onClick:()=>P(k),className:"p-1 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded",children:a.jsx(lP,{className:"w-4 h-4"})})]},k))})]}),u&&u.subjectInsights.length>0&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"AI Subject Analysis"}),a.jsx("div",{className:"space-y-3",children:u.subjectInsights.map((g,k)=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:g.subject}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Recommended study hours: ",g.recommendedStudyHours,"h/week"]}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Improvement potential: ",Math.round(g.improvementPotential*100),"%"]})]}),a.jsxs("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${w(g.riskLevel)}`,children:[g.riskLevel," risk"]})]},k))})]})]})]})]})},NP=()=>{const{currentUser:t}=Ro(),[e,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState(""),[c,u]=C.useState("upcoming"),[d,f]=C.useState("all"),[m,v]=C.useState(null),[y,j]=C.useState([]),[A,R]=C.useState(!0),_=[{id:"science-fair-2024",name:"Science Fair 2024",date:"2024-02-15",endDate:"2024-02-16",type:"Inter-school",hostedBy:"Science Department",description:"Annual science fair showcasing student projects and innovations.",fullDescription:"Join us for the most anticipated science event of the year! Students from various schools will present their innovative projects across multiple categories including Physics, Chemistry, Biology, and Environmental Science.",location:"Main Auditorium",maxParticipants:200,currentParticipants:156,registrations:["user1","user2"],rules:["Projects must be original work","Maximum team size of 3 students","Presentation time limit: 10 minutes","All materials must be provided by participants"],schedule:[{time:"09:00 AM",activity:"Registration and Setup"},{time:"10:00 AM",activity:"Opening Ceremony"},{time:"10:30 AM",activity:"Project Presentations Begin"},{time:"12:30 PM",activity:"Lunch Break"},{time:"01:30 PM",activity:"Judging Round"},{time:"04:00 PM",activity:"Results and Awards"}],rounds:[{name:"Preliminary Round",description:"Initial project presentation and screening",date:"2024-02-15"},{name:"Final Round",description:"Top 20 projects compete for awards",date:"2024-02-16"}],status:"upcoming",registrationDeadline:"2024-02-10",tags:["Science","Innovation","Competition"]},{id:"debate-championship",name:"Inter-School Debate Championship",date:"2024-02-20",type:"Inter-school",hostedBy:"Debate Society",communityId:"debate-society",description:"Regional debate competition on current affairs.",fullDescription:"Test your argumentation skills in this prestigious debate championship. Teams will debate on contemporary issues affecting society.",location:"Conference Hall",maxParticipants:64,currentParticipants:48,registrations:["user3"],rules:["Teams of 2 speakers each","Topics announced 30 minutes before debate","Each speaker gets 4 minutes","No electronic devices allowed"],schedule:[{time:"09:00 AM",activity:"Team Registration"},{time:"09:30 AM",activity:"Opening and Rules Briefing"},{time:"10:00 AM",activity:"Preliminary Rounds"},{time:"02:00 PM",activity:"Semi-Finals"},{time:"04:00 PM",activity:"Final Round"},{time:"05:30 PM",activity:"Award Ceremony"}],status:"upcoming",registrationDeadline:"2024-02-18",tags:["Debate","Public Speaking","Competition"]},{id:"cultural-fest",name:"Cultural Fest 2024",date:"2024-03-10",endDate:"2024-03-12",type:"Intra-school",hostedBy:"Cultural Committee",description:"Celebrate diversity with music, dance, and cultural performances.",fullDescription:"A three-day celebration of culture featuring performances, food stalls, art exhibitions, and cultural workshops from around the world.",location:"School Grounds",currentParticipants:89,registrations:[],status:"upcoming",tags:["Culture","Performance","Arts"]},{id:"math-olympiad-2023",name:"Mathematics Olympiad 2023",date:"2024-01-15",type:"Inter-school",hostedBy:"Mathematics Department",description:"Annual mathematics competition completed.",location:"Computer Lab",currentParticipants:120,registrations:["user1","user4"],results:[{position:1,participant:"Alice Johnson",score:95},{position:2,participant:"Bob Smith",score:92},{position:3,participant:"Carol Davis",score:89}],status:"completed",tags:["Mathematics","Competition","Academic"]},{id:"robotics-competition",name:"Robotics Competition",date:"2024-04-05",type:"Inter-school",hostedBy:"Robotics Team",communityId:"robotics-team",description:"Build and program robots to complete challenging tasks.",fullDescription:"Teams will design, build, and program autonomous robots to navigate obstacle courses and complete specific tasks.",location:"Engineering Lab",maxParticipants:40,currentParticipants:28,registrations:[],status:"upcoming",registrationDeadline:"2024-03-25",tags:["Robotics","Engineering","Technology"]}];C.useEffect(()=>{N(),t&&P()},[t]),C.useEffect(()=>{O()},[e,i,c,d]);const N=async()=>{try{const b=ie(U,"events"),S=await He(Le(b,xr("date","asc")));if(S.empty)console.log("No events found, seeding with initial data..."),await I(),r(_);else{const T=S.docs.map(V=>({id:V.id,...V.data()}));r(T)}}catch(b){console.error("Error loading events:",b),r(_)}finally{R(!1)}},I=async()=>{try{for(const b of _)await we.createEvent({name:b.name,date:b.date,endDate:b.endDate,type:b.type,hostedBy:b.hostedBy,communityId:b.communityId,description:b.description,fullDescription:b.fullDescription,location:b.location,maxParticipants:b.maxParticipants,rules:b.rules,schedule:b.schedule,rounds:b.rounds,results:b.results,status:b.status,registrationDeadline:b.registrationDeadline,tags:b.tags},"system");console.log("Events seeded in Firestore")}catch(b){console.error("Error seeding events:",b)}},P=async()=>{if(t)try{return we.subscribeToUserEvents(t.uid,S=>{j(S.map(T=>T.id))})}catch(b){console.error("Error loading user registrations:",b),j(["science-fair-2024","math-olympiad-2023"])}},O=()=>{let b=e.filter(S=>{const T=S.name.toLowerCase().includes(i.toLowerCase())||S.description.toLowerCase().includes(i.toLowerCase())||S.hostedBy.toLowerCase().includes(i.toLowerCase());let V=!0;const ee=new Date(S.date),be=new Date;switch(c){case"upcoming":V=ee>=be;break;case"past":V=ee<be;break;case"registered":V=y.includes(S.id);break}const De=d==="all"||S.hostedBy===d;return T&&V&&De});s(b)},D=async b=>{if(t)try{const S=y.includes(b);S?await we.unregisterFromEvent(b,t.uid):await we.registerForEvent(b,t.uid),console.log(`${S?"Unregistered from":"Registered for"} event successfully`)}catch(S){console.error("Error updating event registration:",S),y.includes(b)?(j(T=>T.filter(V=>V!==b)),r(T=>T.map(V=>V.id===b?{...V,currentParticipants:V.currentParticipants-1,registrations:V.registrations.filter(ee=>ee!==t.uid)}:V))):(j(T=>[...T,b]),r(T=>T.map(V=>V.id===b?{...V,currentParticipants:V.currentParticipants+1,registrations:[...V.registrations,t.uid]}:V)))}},w=b=>{switch(b){case"upcoming":return"text-blue-600 bg-blue-100 dark:bg-blue-900/20 dark:text-blue-300";case"ongoing":return"text-green-600 bg-green-100 dark:bg-green-900/20 dark:text-green-300";case"completed":return"text-gray-600 bg-gray-100 dark:bg-gray-900/20 dark:text-gray-300"}},x=b=>b==="Inter-school"?"text-purple-600 bg-purple-100 dark:bg-purple-900/20 dark:text-purple-300":"text-orange-600 bg-orange-100 dark:bg-orange-900/20 dark:text-orange-300",g=async b=>{if(t)try{await we.issueCertificate(b.id,t.uid,{type:"participation",title:`Certificate of Participation - ${b.name}`,description:`Awarded for participating in ${b.name}`}),alert(`Certificate for ${b.name} has been issued! Check your profile for download.`)}catch(S){console.error("Error generating certificate:",S),alert(`Certificate for ${b.name} would be generated here!`)}},k=Array.from(new Set(e.map(b=>b.hostedBy)));return A?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Events"}),a.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Create Event"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Events"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.length})]}),a.jsx(Ve,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Upcoming"}),a.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:e.filter(b=>new Date(b.date)>=new Date).length})]}),a.jsx(St,{className:"w-8 h-8 text-green-600"})]})}),a.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Registered"}),a.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:y.length})]}),a.jsx(de,{className:"w-8 h-8 text-purple-600"})]})}),a.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Completed"}),a.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:e.filter(b=>b.status==="completed").length})]}),a.jsx(nm,{className:"w-8 h-8 text-orange-600"})]})})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search events...",value:i,onChange:b=>o(b.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Po,{className:"w-5 h-5 text-gray-400"}),a.jsxs("select",{value:c,onChange:b=>u(b.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"all",children:"All Events"}),a.jsx("option",{value:"upcoming",children:"Upcoming"}),a.jsx("option",{value:"past",children:"Past"}),a.jsx("option",{value:"registered",children:"Registered"})]})]}),a.jsxs("select",{value:d,onChange:b=>f(b.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"all",children:"All Hosts"}),k.map(b=>a.jsx("option",{value:b,children:b},b))]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(b=>{const S=y.includes(b.id),T=b.registrationDeadline&&new Date(b.registrationDeadline)<new Date,V=b.maxParticipants&&b.currentParticipants>=b.maxParticipants;return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>v(b),children:[a.jsx("div",{className:"flex items-start justify-between mb-4",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:b.name}),a.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${w(b.status)}`,children:b.status}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x(b.type)}`,children:b.type})]})]})}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-2",children:b.description}),a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[a.jsx(Ve,{className:"w-4 h-4 mr-2"}),new Date(b.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}),b.endDate&&` - ${new Date(b.endDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})}`]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[a.jsx(de,{className:"w-4 h-4 mr-2"}),"Hosted by ",b.hostedBy]}),b.location&&a.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[a.jsx(Uy,{className:"w-4 h-4 mr-2"}),b.location]}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:[a.jsx(de,{className:"w-4 h-4 mr-2"}),b.currentParticipants," participants",b.maxParticipants&&` / ${b.maxParticipants}`]})]}),a.jsxs("div",{className:"flex space-x-2",children:[b.status==="upcoming"&&a.jsx("button",{onClick:ee=>{ee.stopPropagation(),D(b.id)},disabled:!S&&(T||V),className:`flex-1 py-2 px-4 rounded-lg font-medium transition-colors ${S?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-900/30":T||V?"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700"}`,children:S?"Registered":T?"Registration Closed":V?"Event Full":"Register"}),b.status==="completed"&&S&&a.jsxs("button",{onClick:ee=>{ee.stopPropagation(),g(b)},className:"flex-1 py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center",children:[a.jsx(Ic,{className:"w-4 h-4 mr-2"}),"Certificate"]})]})]},b.id)})}),m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:m.name}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${w(m.status)}`,children:m.status}),a.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${x(m.type)}`,children:m.type})]})]}),a.jsx("button",{onClick:()=>v(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a.jsx(Ai,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Event Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(Ve,{className:"w-5 h-5 mr-3"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:new Date(m.date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),m.endDate&&a.jsxs("p",{className:"text-sm",children:["to ",new Date(m.endDate).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})]})]}),a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(de,{className:"w-5 h-5 mr-3"}),a.jsxs("span",{children:["Hosted by ",m.hostedBy]})]}),m.location&&a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(Uy,{className:"w-5 h-5 mr-3"}),a.jsx("span",{children:m.location})]}),a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(de,{className:"w-5 h-5 mr-3"}),a.jsxs("span",{children:[m.currentParticipants," participants",m.maxParticipants&&` / ${m.maxParticipants} max`]})]}),m.registrationDeadline&&a.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-400",children:[a.jsx(St,{className:"w-5 h-5 mr-3"}),a.jsxs("span",{children:["Registration deadline: ",new Date(m.registrationDeadline).toLocaleDateString()]})]})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Registration Status"}),a.jsx("div",{className:"p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:y.includes(m.id)?a.jsxs("div",{className:"text-green-600 dark:text-green-400",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(de,{className:"w-5 h-5 mr-2"}),a.jsx("span",{className:"font-medium",children:"You are registered!"})]}),a.jsx("p",{className:"text-sm",children:"You will receive updates about this event."})]}):a.jsxs("div",{className:"text-gray-600 dark:text-gray-400",children:[a.jsxs("div",{className:"flex items-center mb-2",children:[a.jsx(St,{className:"w-5 h-5 mr-2"}),a.jsx("span",{className:"font-medium",children:"Not registered"})]}),a.jsx("p",{className:"text-sm",children:"Register to participate in this event."})]})})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Description"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:m.fullDescription||m.description})]}),m.rules&&m.rules.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Rules & Guidelines"}),a.jsx("ul",{className:"space-y-2",children:m.rules.map((b,S)=>a.jsxs("li",{className:"flex items-start text-gray-600 dark:text-gray-400",children:[a.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2 mr-3 flex-shrink-0"}),b]},S))})]}),m.schedule&&m.schedule.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Schedule"}),a.jsx("div",{className:"space-y-3",children:m.schedule.map((b,S)=>a.jsxs("div",{className:"flex items-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[a.jsx("div",{className:"w-20 text-sm font-medium text-blue-600 dark:text-blue-400",children:b.time}),a.jsx("div",{className:"flex-1 text-gray-900 dark:text-white",children:b.activity})]},S))})]}),m.rounds&&m.rounds.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Competition Rounds"}),a.jsx("div",{className:"space-y-3",children:m.rounds.map((b,S)=>a.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:b.name}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:b.description}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Date: ",new Date(b.date).toLocaleDateString()]})]},S))})]}),m.results&&m.results.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(nm,{className:"w-5 h-5 mr-2"}),"Results & Leaderboard"]}),a.jsx("div",{className:"space-y-2",children:m.results.map((b,S)=>a.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${b.position===1?"bg-yellow-50 dark:bg-yellow-900/20":b.position===2?"bg-gray-50 dark:bg-gray-700/50":b.position===3?"bg-orange-50 dark:bg-orange-900/20":"bg-gray-50 dark:bg-gray-700/50"}`,children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-3 ${b.position===1?"bg-yellow-500 text-white":b.position===2?"bg-gray-400 text-white":b.position===3?"bg-orange-500 text-white":"bg-gray-300 text-gray-700"}`,children:b.position}),a.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:b.participant})]}),b.score&&a.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Score: ",b.score]})]},S))})]}),a.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-gray-200 dark:border-gray-700",children:[m.status==="upcoming"&&a.jsx("button",{onClick:()=>{D(m.id),v(null)},className:`flex-1 py-3 px-4 rounded-lg font-medium transition-colors ${y.includes(m.id)?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:y.includes(m.id)?"Unregister":"Register Now"}),m.status==="completed"&&y.includes(m.id)&&a.jsxs("button",{onClick:()=>g(m),className:"flex-1 py-3 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center",children:[a.jsx(Pc,{className:"w-5 h-5 mr-2"}),"Download Certificate"]})]})]})]})}),n.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No events found"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:i?`No events match "${i}"`:"No events available for the selected filters."})]})]})},EP=()=>{const{currentUser:t}=Ro(),[e,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState(""),[c,u]=C.useState("all"),[d,f]=C.useState("members"),[m,v]=C.useState(null),[y,j]=C.useState([]),[A,R]=C.useState(!0),_=[{id:"tech-club",name:"Technology Club",description:"Explore the latest in technology, coding, and innovation. Join us for workshops, hackathons, and tech talks.",tags:["Technology","Programming","Innovation"],memberCount:156,members:["user1","user2"],createdAt:new Date("2024-01-01"),upcomingEvents:[{id:"hackathon-2024",name:"Annual Hackathon",date:"2024-02-15",communityId:"tech-club",description:"48-hour coding challenge"}],recentPosts:[{id:"post1",content:"New Python workshop this Friday!",author:"Tech Lead",timestamp:new Date("2024-01-20")}]},{id:"debate-society",name:"Debate Society",description:"Sharpen your argumentation skills and engage in intellectual discussions on current affairs and philosophical topics.",tags:["Debate","Public Speaking","Critical Thinking"],memberCount:89,members:["user3","user4"],createdAt:new Date("2024-01-05"),upcomingEvents:[{id:"debate-championship",name:"Inter-School Debate Championship",date:"2024-02-20",communityId:"debate-society",description:"Regional debate competition"}]},{id:"music-ensemble",name:"Music Ensemble",description:"Express yourself through music! From classical to contemporary, we welcome all musical talents and interests.",tags:["Music","Performance","Arts"],memberCount:124,members:["user5"],createdAt:new Date("2024-01-10"),upcomingEvents:[]},{id:"environmental-club",name:"Environmental Club",description:"Make a difference for our planet. Join environmental initiatives, sustainability projects, and awareness campaigns.",tags:["Environment","Sustainability","Social Impact"],memberCount:67,members:[],createdAt:new Date("2024-01-15"),upcomingEvents:[]},{id:"photography-club",name:"Photography Club",description:"Capture moments and tell stories through the lens. Learn techniques, share work, and explore visual storytelling.",tags:["Photography","Arts","Creative"],memberCount:92,members:[],createdAt:new Date("2024-01-12"),upcomingEvents:[]},{id:"robotics-team",name:"Robotics Team",description:"Build, program, and compete with robots. Perfect for students interested in engineering and automation.",tags:["Robotics","Engineering","Competition"],memberCount:45,members:[],createdAt:new Date("2024-01-08"),upcomingEvents:[]}];C.useEffect(()=>{N(),t&&P()},[t]),C.useEffect(()=>{O()},[e,i,c,d]);const N=async()=>{try{const g=ie(U,"communities"),k=await He(Le(g,xr("memberCount","desc")));if(k.empty)console.log("No communities found, seeding with initial data..."),await I(),r(_);else{const b=k.docs.map(S=>{var T;return{id:S.id,...S.data(),createdAt:((T=S.data().createdAt)==null?void 0:T.toDate())||new Date}});r(b)}}catch(g){console.error("Error loading communities:",g),r(_)}finally{R(!1)}},I=async()=>{try{for(const g of _)await we.createCommunity({name:g.name,description:g.description,tags:g.tags,createdAt:g.createdAt},"system");console.log("Communities seeded in Firestore")}catch(g){console.error("Error seeding communities:",g)}},P=async()=>{if(t)try{return we.subscribeToUserCommunities(t.uid,k=>{j(k.map(b=>b.id))})}catch(g){console.error("Error loading user communities:",g),j(["tech-club","music-ensemble"])}},O=()=>{let g=e.filter(k=>{const b=k.name.toLowerCase().includes(i.toLowerCase())||k.description.toLowerCase().includes(i.toLowerCase()),S=c==="all"||k.tags.includes(c);return b&&S});g.sort((k,b)=>{switch(d){case"name":return k.name.localeCompare(b.name);case"members":return b.memberCount-k.memberCount;case"recent":return b.createdAt.getTime()-k.createdAt.getTime();default:return 0}}),s(g)},D=async g=>{if(t)try{const k=y.includes(g);k?await we.leaveCommunity(g,t.uid):await we.joinCommunity(g,t.uid),console.log(`${k?"Left":"Joined"} community successfully`)}catch(k){console.error("Error updating community membership:",k),y.includes(g)?(j(b=>b.filter(S=>S!==g)),r(b=>b.map(S=>S.id===g?{...S,memberCount:S.memberCount-1}:S))):(j(b=>[...b,g]),r(b=>b.map(S=>S.id===g?{...S,memberCount:S.memberCount+1}:S)))}},w=Array.from(new Set(e.flatMap(g=>g.tags))),x=g=>g.includes("Technology")||g.includes("Programming")?"":g.includes("Music")||g.includes("Arts")?"":g.includes("Debate")||g.includes("Public Speaking")?"":g.includes("Environment")?"":g.includes("Photography")?"":g.includes("Robotics")||g.includes("Engineering")?"":"";return A?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Communities"}),a.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Create Community"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Communities"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:e.length})]}),a.jsx(de,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Your Communities"}),a.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:y.length})]}),a.jsx(oP,{className:"w-8 h-8 text-green-600"})]})}),a.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Members"}),a.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:e.reduce((g,k)=>g+k.memberCount,0)})]}),a.jsx(de,{className:"w-8 h-8 text-purple-600"})]})})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search communities...",value:i,onChange:g=>o(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Po,{className:"w-5 h-5 text-gray-400"}),a.jsxs("select",{value:c,onChange:g=>u(g.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"all",children:"All Tags"}),w.map(g=>a.jsx("option",{value:g,children:g},g))]})]}),a.jsxs("select",{value:d,onChange:g=>f(g.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"members",children:"Most Members"}),a.jsx("option",{value:"name",children:"Name"}),a.jsx("option",{value:"recent",children:"Recently Created"})]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(g=>{const k=y.includes(g.id);return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>v(g),children:[a.jsx("div",{className:"flex items-start justify-between mb-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"text-3xl",children:x(g.tags)}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:g.name}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[g.memberCount," members"]})]})]})}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-3",children:g.description}),a.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[g.tags.slice(0,3).map(b=>a.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-full",children:b},b)),g.tags.length>3&&a.jsxs("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs rounded-full",children:["+",g.tags.length-3]})]}),a.jsx("button",{onClick:b=>{b.stopPropagation(),D(g.id)},className:`w-full py-2 px-4 rounded-lg font-medium transition-colors ${k?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-900/30":"bg-blue-600 text-white hover:bg-blue-700"}`,children:k?"Joined":"Join Community"})]},g.id)})}),m&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"text-4xl",children:x(m.tags)}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:m.name}),a.jsxs("p",{className:"text-gray-500 dark:text-gray-400",children:[m.memberCount," members"]})]})]}),a.jsx("button",{onClick:()=>v(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a.jsx(Ai,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"About"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:m.description})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Tags"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:m.tags.map(g=>a.jsx("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/20 text-blue-800 dark:text-blue-300 text-sm rounded-full",children:g},g))})]}),m.upcomingEvents&&m.upcomingEvents.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Upcoming Events"}),a.jsx("div",{className:"space-y-2",children:m.upcomingEvents.map(g=>a.jsxs("div",{className:"p-3 border border-gray-200 dark:border-gray-600 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Ve,{className:"w-4 h-4 text-blue-600"}),a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:g.name})]}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:new Date(g.date).toLocaleDateString()})]},g.id))})]}),m.recentPosts&&m.recentPosts.length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Recent Updates"}),a.jsx("div",{className:"space-y-3",children:m.recentPosts.map(g=>a.jsxs("div",{className:"p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[a.jsx("p",{className:"text-gray-900 dark:text-white",children:g.content}),a.jsxs("div",{className:"flex items-center justify-between mt-2 text-sm text-gray-500 dark:text-gray-400",children:[a.jsxs("span",{children:["By ",g.author]}),a.jsx("span",{children:g.timestamp.toLocaleDateString()})]})]},g.id))})]}),a.jsx("button",{onClick:()=>{D(m.id),v(null)},className:`w-full py-3 px-4 rounded-lg font-medium transition-colors ${y.includes(m.id)?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:y.includes(m.id)?"Leave Community":"Join Community"})]})]})}),n.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No communities found"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:i?`No communities match "${i}"`:"No communities available at the moment."})]})]})},jP=()=>{const{currentUser:t}=tt(),[e,r]=C.useState(null),[n,s]=C.useState(""),[i,o]=C.useState(""),[c]=C.useState([{id:"class-12a",name:"Class 12-A",description:"General discussions for Class 12-A students",members:["student1","student2","teacher1"],lastMessage:"Hey everyone, don't forget about tomorrow's exam!",lastMessageTime:new Date("2024-01-20T10:30:00")},{id:"physics-study",name:"Physics Study Group",description:"Physics discussions and doubt clearing",members:["student1","student2","student3","physics-teacher"],lastMessage:"Can someone explain electromagnetic induction?",lastMessageTime:new Date("2024-01-20T14:15:00")},{id:"math-club",name:"Mathematics Club",description:"Advanced mathematics discussions",members:["student1","student4","math-teacher"],lastMessage:"The integration problem was challenging!",lastMessageTime:new Date("2024-01-19T16:45:00")},{id:"science-fair",name:"Science Fair Committee",description:"Planning and coordination for Science Fair 2024",members:["student1","student2","student3","coordinator"],lastMessage:"Project submission deadline is next week",lastMessageTime:new Date("2024-01-19T09:20:00")}]),[u,d]=C.useState([{id:"1",text:"Hey everyone, don't forget about tomorrow's physics exam!",senderId:"teacher1",senderName:"Prof. Anderson",timestamp:new Date("2024-01-20T10:30:00"),groupId:"class-12a"},{id:"2",text:"Thanks for the reminder! What chapters should we focus on?",senderId:"student2",senderName:"Alice Johnson",timestamp:new Date("2024-01-20T10:32:00"),groupId:"class-12a"},{id:"3",text:"Chapters 8-12 are the most important. Make sure to review the formulas.",senderId:"teacher1",senderName:"Prof. Anderson",timestamp:new Date("2024-01-20T10:35:00"),groupId:"class-12a"},{id:"4",text:"Can someone explain electromagnetic induction? I'm having trouble with Faraday's law.",senderId:"student3",senderName:"Bob Smith",timestamp:new Date("2024-01-20T14:15:00"),groupId:"physics-study"},{id:"5",text:"Sure! Faraday's law states that the induced EMF is proportional to the rate of change of magnetic flux.",senderId:"physics-teacher",senderName:"Dr. Rodriguez",timestamp:new Date("2024-01-20T14:20:00"),groupId:"physics-study"}]),f=c.filter(A=>A.name.toLowerCase().includes(i.toLowerCase())||A.description.toLowerCase().includes(i.toLowerCase())),m=c.find(A=>A.id===e),v=u.filter(A=>A.groupId===e),y=()=>{if(n.trim()&&e&&t){const A={id:Date.now().toString(),text:n.trim(),senderId:t.uid,senderName:t.displayName||"You",timestamp:new Date,groupId:e};d([...u,A]),s("")}},j=A=>{A.key==="Enter"&&!A.shiftKey&&(A.preventDefault(),y())};return a.jsxs("div",{className:"h-[calc(100vh-8rem)] flex bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[a.jsxs("div",{className:"w-80 border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Messages"}),a.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a.jsx(Tr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"relative",children:[a.jsx(zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search groups...",value:i,onChange:A=>o(A.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:f.map(A=>a.jsx("div",{onClick:()=>r(A.id),className:`p-4 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors ${e===A.id?"bg-blue-50 dark:bg-blue-900/20 border-r-2 border-blue-500":""}`,children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:a.jsx(sP,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:A.name}),A.lastMessageTime&&a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:A.lastMessageTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mt-1",children:A.description}),A.lastMessage&&a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 truncate mt-1",children:A.lastMessage})]})]})},A.id))})]}),a.jsx("div",{className:"flex-1 flex flex-col",children:e?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:m==null?void 0:m.name}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m==null?void 0:m.members.length," members  ",m==null?void 0:m.description]})]}),a.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a.jsx(de,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:v.map(A=>a.jsx("div",{className:`flex ${A.senderId===(t==null?void 0:t.uid)?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${A.senderId===(t==null?void 0:t.uid)?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"}`,children:[A.senderId!==(t==null?void 0:t.uid)&&a.jsx("p",{className:"text-xs font-medium mb-1 opacity-75",children:A.senderName}),a.jsx("p",{className:"text-sm",children:A.text}),a.jsx("p",{className:`text-xs mt-1 opacity-75 ${A.senderId===(t==null?void 0:t.uid)?"text-blue-100":"text-gray-500 dark:text-gray-400"}`,children:A.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},A.id))}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("textarea",{value:n,onChange:A=>s(A.target.value),onKeyPress:j,placeholder:"Type a message...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:1}),a.jsx("button",{onClick:y,disabled:!n.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a.jsx(lg,{className:"w-4 h-4"})})]})})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(F_,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a group to start messaging"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Choose a group from the sidebar to view and send messages."})]})})})]})},TP=()=>{const[t,e]=C.useState(""),[r,n]=C.useState("all"),[s,i]=C.useState("all"),o=[{id:"1",title:"Introduction to Calculus",type:"video",subject:"Mathematics",url:"https://example.com/calculus-intro",description:"Comprehensive introduction to differential and integral calculus",uploadDate:"2024-01-15"},{id:"2",title:"Newton's Laws of Motion",type:"document",subject:"Physics",url:"https://example.com/newtons-laws.pdf",description:"Detailed explanation of Newton's three laws with examples",uploadDate:"2024-01-12"},{id:"3",title:"Organic Chemistry Basics",type:"article",subject:"Chemistry",url:"https://example.com/organic-chem",description:"Fundamentals of organic chemistry and molecular structures",uploadDate:"2024-01-10"},{id:"4",title:"Shakespearean Literature Quiz",type:"quiz",subject:"English",url:"https://example.com/shakespeare-quiz",description:"Test your knowledge of Shakespeare's major works",uploadDate:"2024-01-08"},{id:"5",title:"World War II Documentary",type:"video",subject:"History",url:"https://example.com/wwii-doc",description:"In-depth documentary covering major events of World War II",uploadDate:"2024-01-05"},{id:"6",title:"Python Programming Guide",type:"document",subject:"Computer Science",url:"https://example.com/python-guide.pdf",description:"Complete guide to Python programming for beginners",uploadDate:"2024-01-03"},{id:"7",title:"Trigonometry Practice Problems",type:"quiz",subject:"Mathematics",url:"https://example.com/trig-quiz",description:"Practice problems for trigonometric functions and identities",uploadDate:"2024-01-01"},{id:"8",title:"Electromagnetic Waves Lecture",type:"video",subject:"Physics",url:"https://example.com/em-waves",description:"Comprehensive lecture on electromagnetic wave theory",uploadDate:"2023-12-28"}],c=["all",...Array.from(new Set(o.map(y=>y.subject)))],u=["all","video","document","article","quiz"],d=o.filter(y=>{const j=y.title.toLowerCase().includes(t.toLowerCase())||y.description.toLowerCase().includes(t.toLowerCase()),A=r==="all"||y.subject===r,R=s==="all"||y.type===s;return j&&A&&R}),f=y=>{switch(y){case"video":return a.jsx(tm,{className:"w-5 h-5"});case"document":return a.jsx(et,{className:"w-5 h-5"});case"article":return a.jsx(Gt,{className:"w-5 h-5"});case"quiz":return a.jsx(em,{className:"w-5 h-5"});default:return a.jsx(et,{className:"w-5 h-5"})}},m=y=>{switch(y){case"video":return"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-300";case"document":return"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-300";case"article":return"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-300";case"quiz":return"text-purple-600 bg-purple-50 dark:bg-purple-900/20 dark:text-purple-300";default:return"text-gray-600 bg-gray-50 dark:bg-gray-900/20 dark:text-gray-300"}},v=[{title:"Total Resources",value:o.length,icon:Gt,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Video Lectures",value:o.filter(y=>y.type==="video").length,icon:tm,color:"text-red-600",bgColor:"bg-red-50 dark:bg-red-900/20"},{title:"Documents",value:o.filter(y=>y.type==="document").length,icon:et,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Quizzes",value:o.filter(y=>y.type==="quiz").length,icon:em,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"LearnCenter"}),a.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Upload Resource"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:v.map((y,j)=>a.jsx("div",{className:`${y.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:y.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${y.color}`,children:y.value})]}),a.jsx(y.icon,{className:`w-8 h-8 ${y.color}`})]})},j))}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search resources...",value:t,onChange:y=>e(y.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Po,{className:"w-5 h-5 text-gray-400"}),a.jsx("select",{value:r,onChange:y=>n(y.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:c.map(y=>a.jsx("option",{value:y,children:y==="all"?"All Subjects":y},y))})]}),a.jsx("select",{value:s,onChange:y=>i(y.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:u.map(y=>a.jsx("option",{value:y,children:y==="all"?"All Types":y.charAt(0).toUpperCase()+y.slice(1)},y))})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(y=>a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-4",children:[a.jsx("div",{className:`p-2 rounded-lg ${m(y.type)}`,children:f(y.type)}),a.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 text-xs font-medium rounded-full",children:y.subject})]}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2",children:y.title}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-4 line-clamp-3",children:y.description}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400 mb-4",children:[a.jsx("span",{className:"capitalize",children:y.type}),a.jsx("span",{children:new Date(y.uploadDate).toLocaleDateString()})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsxs("button",{className:"flex-1 flex items-center justify-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Zr,{className:"w-4 h-4 mr-2"}),"Open"]}),y.type==="document"&&a.jsx("button",{className:"px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:a.jsx(Pc,{className:"w-4 h-4"})})]})]},y.id))}),d.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Gt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No resources found"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:t?`No resources match "${t}"`:"No learning resources available at the moment."})]})]})},SP=({subject:t,topic:e})=>{const[r,n]=C.useState([{id:"1",role:"assistant",content:`Hi! I'm your AI study assistant. I'm here to help you with your studies${t?` in ${t}`:""}. What would you like to learn about today?`,timestamp:new Date}]),[s,i]=C.useState(""),[o,c]=C.useState(!1),u=C.useRef(null),d=()=>{var y;(y=u.current)==null||y.scrollIntoView({behavior:"smooth"})};C.useEffect(()=>{d()},[r]);const f=async()=>{if(!s.trim()||o)return;const y={id:Date.now().toString(),role:"user",content:s,timestamp:new Date};n(j=>[...j,y]),i(""),c(!0);try{const j={message:s,context:{subject:t,topic:e},conversationHistory:r.map(_=>({role:_.role,content:_.content}))},A=await Do.getStudyAssistance(j),R={id:(Date.now()+1).toString(),role:"assistant",content:A.response,timestamp:new Date,suggestions:A.suggestions,resources:A.resources};n(_=>[..._,R])}catch{const A={id:(Date.now()+1).toString(),role:"assistant",content:"I apologize, but I'm having trouble connecting to my knowledge base right now. Please try again in a moment.",timestamp:new Date};n(R=>[...R,A])}finally{c(!1)}},m=y=>{y.key==="Enter"&&!y.shiftKey&&(y.preventDefault(),f())},v=y=>{i(y)};return a.jsxs("div",{className:"flex flex-col h-96 bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center p-4 border-b border-gray-200 dark:border-gray-700",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center mr-3",children:a.jsx(Pd,{className:"w-5 h-5 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"AI Study Assistant"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t?`Helping with ${t}`:"Ready to help with your studies"})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[r.map(y=>a.jsx("div",{className:`flex ${y.role==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md ${y.role==="user"?"order-2":"order-1"}`,children:[a.jsxs("div",{className:`flex items-start space-x-2 ${y.role==="user"?"flex-row-reverse space-x-reverse":""}`,children:[a.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center ${y.role==="user"?"bg-blue-600":"bg-gradient-to-r from-blue-500 to-purple-500"}`,children:y.role==="user"?a.jsx(q_,{className:"w-3 h-3 text-white"}):a.jsx(Pd,{className:"w-3 h-3 text-white"})}),a.jsxs("div",{className:`px-3 py-2 rounded-lg ${y.role==="user"?"bg-blue-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"}`,children:[a.jsx("p",{className:"text-sm",children:y.content}),a.jsx("p",{className:`text-xs mt-1 opacity-75 ${y.role==="user"?"text-blue-100":"text-gray-500 dark:text-gray-400"}`,children:y.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),y.suggestions&&y.suggestions.length>0&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[a.jsx(iP,{className:"w-3 h-3 mr-1"}),"Suggestions:"]}),y.suggestions.map((j,A)=>a.jsx("button",{onClick:()=>v(j),className:"block w-full text-left text-xs p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300 rounded hover:bg-blue-100 dark:hover:bg-blue-900/30 transition-colors",children:j},A))]}),y.resources&&y.resources.length>0&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[a.jsx(Gt,{className:"w-3 h-3 mr-1"}),"Recommended resources:"]}),y.resources.map((j,A)=>a.jsxs("a",{href:j.url,target:"_blank",rel:"noopener noreferrer",className:"block text-xs p-2 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 rounded hover:bg-green-100 dark:hover:bg-green-900/30 transition-colors",children:[j.title," (",j.type,")"]},A))]})]})},y.id)),o&&a.jsx("div",{className:"flex justify-start",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-6 h-6 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center",children:a.jsx(Pd,{className:"w-3 h-3 text-white"})}),a.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded-lg",children:a.jsx(ig,{className:"w-4 h-4 animate-spin text-gray-600 dark:text-gray-400"})})]})}),a.jsx("div",{ref:u})]}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("textarea",{value:s,onChange:y=>i(y.target.value),onKeyPress:m,placeholder:"Ask me anything about your studies...",className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none text-sm",rows:1,disabled:o}),a.jsx("button",{onClick:f,disabled:!s.trim()||o,className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a.jsx(lg,{className:"w-4 h-4"})})]})})]})},AP=({assignment:t,onClose:e})=>{const[r,n]=C.useState(!1),[s,i]=C.useState(null),[o,c]=C.useState(""),u=async()=>{if(t){n(!0);try{const f={assignmentTitle:t.title,subject:t.subject,description:t.description||"",dueDate:t.dueDate,currentProgress:o},m=await Do.getAssignmentHelp(f);i(m)}catch(f){console.error("Failed to get assignment help:",f)}finally{n(!1)}}},d=f=>{switch(f){case"high":return"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-300";case"medium":return"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20 dark:text-yellow-300";case"low":return"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-300"}};return t?a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mr-3",children:a.jsx(ur,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI Assignment Helper"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Get personalized assistance for your assignment"})]})]}),e&&a.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:t.title}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(Gt,{className:"w-4 h-4 mr-1"}),t.subject]}),a.jsxs("span",{className:"flex items-center",children:[a.jsx(St,{className:"w-4 h-4 mr-1"}),"Due: ",new Date(t.dueDate).toLocaleDateString()]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Current Progress (Optional)"}),a.jsx("textarea",{value:o,onChange:f=>c(f.target.value),placeholder:"Describe what you've already done or any specific challenges you're facing...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:3})]}),a.jsx("button",{onClick:u,disabled:r,className:"w-full mb-6 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-4 rounded-lg font-medium hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center justify-center",children:r?a.jsxs(a.Fragment,{children:[a.jsx(ig,{className:"w-5 h-5 mr-2 animate-spin"}),"Analyzing Assignment..."]}):a.jsxs(a.Fragment,{children:[a.jsx(ur,{className:"w-5 h-5 mr-2"}),"Get AI Assistance"]})}),s&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(B_,{className:"w-5 h-5 mr-2 text-blue-600"}),"AI Suggestions"]}),a.jsx("div",{className:"space-y-2",children:s.suggestions.map((f,m)=>a.jsxs("div",{className:"flex items-start p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[a.jsx(fr,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-3 mt-0.5 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:f})]},m))})]}),a.jsxs("div",{children:[a.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(St,{className:"w-5 h-5 mr-2 text-green-600"}),"Recommended Study Plan"]}),a.jsx("div",{className:"space-y-3",children:s.studyPlan.map((f,m)=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-600 rounded-lg",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:f.task}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Estimated time: ",f.estimatedTime," hours"]})]}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${d(f.priority)}`,children:f.priority})]},m))})]}),s.resources.length>0&&a.jsxs("div",{children:[a.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(Gt,{className:"w-5 h-5 mr-2 text-purple-600"}),"Recommended Resources"]}),a.jsx("div",{className:"space-y-2",children:s.resources.map((f,m)=>a.jsx("a",{href:f.url,target:"_blank",rel:"noopener noreferrer",className:"block p-3 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:f.title}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 capitalize",children:f.type})]}),a.jsx("div",{className:"text-blue-600 dark:text-blue-400",children:""})]})},m))})]})]})]}):a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"text-center py-8",children:[a.jsx(ur,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"AI Assignment Helper"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Select an assignment to get AI-powered assistance and study recommendations."})]})})},IP=({studentProfile:t})=>{const[e,r]=C.useState(null),[n,s]=C.useState(!1),o=t||{subjects:["Mathematics","Physics","Chemistry","English"],learningStyle:"visual",currentGPA:8.5,weakAreas:["Calculus","Organic Chemistry"],interests:["Science","Technology","Problem Solving"]};C.useEffect(()=>{c()},[]);const c=async()=>{s(!0);try{const m={studentProfile:o},v=await Do.getLearningRecommendations(m);r(v)}catch(m){console.error("Failed to load recommendations:",m)}finally{s(!1)}},u=m=>{switch(m){case"video":return a.jsx(tm,{className:"w-5 h-5"});case"article":return a.jsx(et,{className:"w-5 h-5"});case"practice":return a.jsx(Gt,{className:"w-5 h-5"});case"quiz":return a.jsx(em,{className:"w-5 h-5"});default:return a.jsx(Gt,{className:"w-5 h-5"})}},d=m=>{switch(m){case"video":return"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-300";case"article":return"text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-300";case"practice":return"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-300";case"quiz":return"text-purple-600 bg-purple-50 dark:bg-purple-900/20 dark:text-purple-300";default:return"text-gray-600 bg-gray-50 dark:bg-gray-900/20 dark:text-gray-300"}},f=m=>{switch(m.toLowerCase()){case"beginner":return"text-green-600 bg-green-100 dark:bg-green-900/20 dark:text-green-300";case"intermediate":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20 dark:text-yellow-300";case"advanced":return"text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-300";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/20 dark:text-gray-300"}};return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-pink-500 to-orange-500 rounded-full flex items-center justify-center mr-3",children:a.jsx(rm,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI Learning Recommendations"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Personalized content based on your learning profile"})]})]}),a.jsx("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-gradient-to-r from-pink-500 to-orange-500 text-white rounded-lg hover:from-pink-600 hover:to-orange-600 disabled:opacity-50 transition-colors",children:n?"Loading...":"Refresh"})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Your Learning Profile"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Learning Style:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white capitalize",children:o.learningStyle})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Current GPA:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:o.currentGPA})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subjects:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:o.subjects.join(", ")})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Focus Areas:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:o.weakAreas.join(", ")})]})]})]}),n?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-pink-500 border-t-transparent rounded-full mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Generating personalized recommendations..."})]}):e?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-4",children:["Recommended for You (",e.recommendations.length," items)"]}),e.recommendations.map((m,v)=>a.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:`p-2 rounded-lg ${d(m.type)}`,children:u(m.type)}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-medium text-gray-900 dark:text-white mb-1",children:m.title}),a.jsxs("div",{className:"flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-400",children:[a.jsx("span",{children:m.subject}),a.jsxs("span",{className:"flex items-center",children:[a.jsx(St,{className:"w-4 h-4 mr-1"}),m.estimatedTime," min"]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${f(m.difficulty)}`,children:m.difficulty}),a.jsxs("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400",children:[a.jsx(Ft,{className:"w-4 h-4 mr-1"}),Math.round(m.relevanceScore*100),"%"]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 w-24",children:a.jsx("div",{className:"bg-gradient-to-r from-pink-500 to-orange-500 h-2 rounded-full",style:{width:`${m.relevanceScore*100}%`}})}),a.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Math.round(m.relevanceScore*100),"% match"]})]}),a.jsx("button",{onClick:()=>window.open(m.url,"_blank"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Start Learning"})]})]},v))]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(rm,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No Recommendations Yet"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:'Click "Refresh" to get personalized learning recommendations based on your profile.'})]})]})},CP=({assignments:t})=>{const[e,r]=C.useState(null),[n,s]=C.useState(!1),[i,o]=C.useState({preferredStudyTimes:["14:00-18:00"],breakDuration:15,maxSessionLength:120}),u=t||[{id:"1",title:"Physics Lab Report",subject:"Physics",dueDate:"2024-01-25",estimatedHours:4,priority:8},{id:"2",title:"Math Problem Set",subject:"Mathematics",dueDate:"2024-01-27",estimatedHours:3,priority:7},{id:"3",title:"Chemistry Research Paper",subject:"Chemistry",dueDate:"2024-01-30",estimatedHours:6,priority:9}],d=async()=>{s(!0);try{const m={assignments:u,availableHours:[{day:"Monday",startTime:"14:00",endTime:"18:00"},{day:"Tuesday",startTime:"15:00",endTime:"19:00"},{day:"Wednesday",startTime:"14:00",endTime:"17:00"},{day:"Thursday",startTime:"16:00",endTime:"20:00"},{day:"Friday",startTime:"14:00",endTime:"18:00"},{day:"Saturday",startTime:"10:00",endTime:"16:00"},{day:"Sunday",startTime:"10:00",endTime:"14:00"}],preferences:i},v=await Do.optimizeSchedule(m);r(v)}catch(m){console.error("Failed to optimize schedule:",m)}finally{s(!1)}},f=m=>m>=.8?"text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-300":m>=.6?"text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20 dark:text-yellow-300":"text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-300";return a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-indigo-500 to-blue-500 rounded-full flex items-center justify-center mr-3",children:a.jsx(im,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI Smart Scheduler"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Optimize your study schedule with AI"})]})]}),a.jsx("button",{onClick:d,disabled:n,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-blue-500 text-white rounded-lg hover:from-indigo-600 hover:to-blue-600 disabled:opacity-50 transition-colors flex items-center",children:n?a.jsxs(a.Fragment,{children:[a.jsx(ig,{className:"w-4 h-4 mr-2 animate-spin"}),"Optimizing..."]}):a.jsxs(a.Fragment,{children:[a.jsx(im,{className:"w-4 h-4 mr-2"}),"Optimize Schedule"]})})]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Study Preferences"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Break Duration (minutes)"}),a.jsx("input",{type:"number",value:i.breakDuration,onChange:m=>o({...i,breakDuration:parseInt(m.target.value)||15}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Max Session (minutes)"}),a.jsx("input",{type:"number",value:i.maxSessionLength,onChange:m=>o({...i,maxSessionLength:parseInt(m.target.value)||120}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Preferred Time"}),a.jsxs("select",{value:i.preferredStudyTimes[0],onChange:m=>o({...i,preferredStudyTimes:[m.target.value]}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",children:[a.jsx("option",{value:"09:00-13:00",children:"Morning (9 AM - 1 PM)"}),a.jsx("option",{value:"14:00-18:00",children:"Afternoon (2 PM - 6 PM)"}),a.jsx("option",{value:"19:00-23:00",children:"Evening (7 PM - 11 PM)"})]})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Assignments to Schedule"}),a.jsx("div",{className:"space-y-2",children:u.map(m=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-600 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 dark:text-white",children:m.title}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[m.subject,"  Due: ",new Date(m.dueDate).toLocaleDateString()]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[m.estimatedHours,"h"]}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Priority: ",m.priority,"/10"]})]})]},m.id))})]}),e&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(Ve,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Optimized Schedule"]}),a.jsx("div",{className:"space-y-3",children:e.optimizedSchedule.map((m,v)=>{const y=u.find(j=>j.id===m.assignmentId);return a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-3 h-3 bg-indigo-500 rounded-full"}),a.jsxs("div",{children:[a.jsx("h6",{className:"font-medium text-gray-900 dark:text-white",children:y==null?void 0:y.title}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[new Date(m.scheduledDate).toLocaleDateString(),"  ",m.startTime," - ",m.endTime]})]})]}),a.jsx("div",{className:"flex items-center space-x-2",children:a.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${f(m.estimatedProductivity)}`,children:[Math.round(m.estimatedProductivity*100),"% productivity"]})})]},v)})})]}),e.insights.length>0&&a.jsxs("div",{children:[a.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(fr,{className:"w-5 h-5 mr-2 text-green-600"}),"AI Insights"]}),a.jsx("div",{className:"space-y-2",children:e.insights.map((m,v)=>a.jsxs("div",{className:"flex items-start p-3 bg-green-50 dark:bg-green-900/20 rounded-lg",children:[a.jsx(fr,{className:"w-5 h-5 text-green-600 dark:text-green-400 mr-3 mt-0.5 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-green-800 dark:text-green-300",children:m})]},v))})]}),e.warnings.length>0&&a.jsxs("div",{children:[a.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center",children:[a.jsx(co,{className:"w-5 h-5 mr-2 text-yellow-600"}),"Warnings"]}),a.jsx("div",{className:"space-y-2",children:e.warnings.map((m,v)=>a.jsxs("div",{className:"flex items-start p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg",children:[a.jsx(co,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 mr-3 mt-0.5 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-300",children:m})]},v))})]})]}),!e&&!n&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Ready to Optimize"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:'Click "Optimize Schedule" to get AI-powered study schedule recommendations.'})]})]})};var PP={};const RP=()=>{const[t,e]=C.useState("assistant"),r=[{id:"assistant",name:"Study Assistant",description:"Get instant help with your studies",icon:ag,color:"from-blue-500 to-purple-500",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{id:"assignments",name:"Assignment Helper",description:"AI-powered assignment assistance",icon:Gt,color:"from-purple-500 to-pink-500",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{id:"recommendations",name:"Learning Recommendations",description:"Personalized content suggestions",icon:rm,color:"from-pink-500 to-orange-500",bgColor:"bg-pink-50 dark:bg-pink-900/20"},{id:"scheduler",name:"Smart Scheduler",description:"Optimize your study schedule",icon:Ve,color:"from-indigo-500 to-blue-500",bgColor:"bg-indigo-50 dark:bg-indigo-900/20"},{id:"gpa",name:"GPA Predictor",description:"AI-enhanced GPA predictions",icon:Ft,color:"from-green-500 to-teal-500",bgColor:"bg-green-50 dark:bg-green-900/20"}],n=()=>{switch(t){case"assistant":return a.jsx(SP,{});case"assignments":return a.jsx(AP,{});case"recommendations":return a.jsx(IP,{});case"scheduler":return a.jsx(CP,{});case"gpa":return a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Ft,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Enhanced GPA Predictor"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Your AI-powered GPA prediction model will be integrated here."}),a.jsx("button",{onClick:()=>window.location.href="/dashboard/gpa-predictor",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Go to GPA Predictor"})]})});default:return null}};return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:[a.jsx(ur,{className:"w-8 h-8 mr-3 text-blue-600"}),"AI Hub"]}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Powered by artificial intelligence to enhance your learning experience"})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:r.map(s=>a.jsxs("button",{onClick:()=>e(s.id),className:`p-4 rounded-xl border-2 transition-all duration-200 text-left ${t===s.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600 bg-white dark:bg-gray-800"}`,children:[a.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${s.color} rounded-lg flex items-center justify-center mb-3`,children:a.jsx(s.icon,{className:"w-6 h-6 text-white"})}),a.jsx("h3",{className:`font-semibold mb-1 ${t===s.id?"text-blue-900 dark:text-blue-100":"text-gray-900 dark:text-white"}`,children:s.name}),a.jsx("p",{className:`text-sm ${t===s.id?"text-blue-700 dark:text-blue-300":"text-gray-600 dark:text-gray-400"}`,children:s.description})]},s.id))}),a.jsx("div",{className:"min-h-96",children:n()}),a.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full mr-3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"AI Service Status"}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Using mock responses - Connect your Python service to enable full AI features"})]})]}),a.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Service URL: ",PP.REACT_APP_AI_SERVICE_URL||"http://localhost:8000"]})]})})]})},DP=()=>{var v;const{currentUser:t}=tt(),[e,r]=C.useState(null),[n,s]=C.useState({totalClasses:0,totalStudents:0,pendingAssignments:0,todayAttendance:0}),[i,o]=C.useState([]),[c,u]=C.useState(!0);C.useEffect(()=>{t&&d()},[t]);const d=async()=>{if(t)try{const y=await ge.getTeacherProfile(t.uid);if(r(y),y){const j=await ge.getTeacherClasses(t.uid),A=await ge.getTeacherAssignments(t.uid),R=j.reduce((N,I)=>N+I.students.length,0),_=A.filter(N=>new Date(N.dueDate)>new Date&&N.stats.submissionRate<100).length;s({totalClasses:j.length,totalStudents:R,pendingAssignments:_,todayAttendance:Math.floor(Math.random()*100)}),o([{type:"submission",title:"New assignment submission from Alice Johnson",time:"2 hours ago",icon:et,color:"text-blue-500"},{type:"attendance",title:"Attendance marked for Class 12-A",time:"4 hours ago",icon:Ve,color:"text-green-500"},{type:"grade",title:"Grades updated for Physics Quiz",time:"1 day ago",icon:Ic,color:"text-purple-500"}])}}catch(y){console.error("Error loading teacher data:",y)}finally{u(!1)}},f=[{title:"Mark Attendance",link:"/teacher-dashboard/attendance",icon:Ve,color:"bg-green-50 text-green-700 dark:bg-green-900/20 dark:text-green-300 hover:bg-green-100 dark:hover:bg-green-900/30"},{title:"Create Assignment",link:"/teacher-dashboard/assignments",icon:et,color:"bg-blue-50 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300 hover:bg-blue-100 dark:hover:bg-blue-900/30"},{title:"Update Marks",link:"/teacher-dashboard/marks",icon:Ft,color:"bg-purple-50 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300 hover:bg-purple-100 dark:hover:bg-purple-900/30"},{title:"View Reports",link:"/teacher-dashboard/reports",icon:Ic,color:"bg-orange-50 text-orange-700 dark:bg-orange-900/20 dark:text-orange-300 hover:bg-orange-100 dark:hover:bg-orange-900/30"}],m=[{title:"Total Classes",value:n.totalClasses,icon:Gt,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Total Students",value:n.totalStudents,icon:de,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Pending Assignments",value:n.pendingAssignments,icon:co,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"},{title:"Today's Attendance",value:`${n.todayAttendance}%`,icon:fr,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"}];return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full"})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["Welcome back, ",(e==null?void 0:e.name)||"Teacher","!"]}),a.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:[e==null?void 0:e.department," Department  ",e==null?void 0:e.subjects.join(", ")]})]}),a.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Last login: ",((v=e==null?void 0:e.lastLogin)==null?void 0:v.toLocaleDateString())||"Today"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:m.map((y,j)=>a.jsx("div",{className:`${y.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:y.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${y.color}`,children:y.value})]}),a.jsx(y.icon,{className:`w-8 h-8 ${y.color}`})]})},j))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Quick Actions"}),a.jsx("div",{className:"space-y-3",children:f.map((y,j)=>a.jsxs("a",{href:y.link,className:`flex items-center p-3 rounded-lg transition-colors ${y.color}`,children:[a.jsx(y.icon,{className:"w-5 h-5 mr-3"}),a.jsx("span",{className:"font-medium",children:y.title})]},j))})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Recent Activity"}),a.jsx("a",{href:"/teacher-dashboard/reports",className:"text-sm text-emerald-600 dark:text-emerald-400 hover:text-emerald-700 dark:hover:text-emerald-300",children:"View all"})]}),a.jsx("div",{className:"space-y-4",children:i.map((y,j)=>a.jsxs("div",{className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[a.jsx(y.icon,{className:`w-5 h-5 mt-0.5 ${y.color}`}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:y.title}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center mt-1",children:[a.jsx(St,{className:"w-3 h-3 mr-1"}),y.time]})]})]},j))})]})})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Today's Schedule"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{time:"09:00 - 10:00",class:"Class 12-A",subject:"Mathematics",room:"Room 101"},{time:"10:00 - 11:00",class:"Class 11-B",subject:"Statistics",room:"Room 102"},{time:"14:00 - 15:00",class:"Class 12-C",subject:"Mathematics",room:"Room 101"}].map((y,j)=>a.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-sm font-medium text-emerald-600 dark:text-emerald-400",children:y.time}),a.jsx("span",{className:"text-xs px-2 py-1 bg-emerald-100 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-300 rounded-full",children:y.room})]}),a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-1",children:y.class}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:y.subject})]},j))})]})]})},MP=()=>{var b;const{currentUser:t}=tt(),[e,r]=C.useState([]),[n,s]=C.useState(""),[i,o]=C.useState(new Date().toISOString().split("T")[0]),[c,u]=C.useState([]),[d,f]=C.useState({}),[m,v]=C.useState([]),[y,j]=C.useState(!1),[A,R]=C.useState(!1),[_,N]=C.useState(0);C.useEffect(()=>{t&&I()},[t]),C.useEffect(()=>{n&&(P(),O())},[n,i]);const I=async()=>{if(t)try{const S=await ge.getTeacherClasses(t.uid);r(S),S.length>0&&s(S[0].id)}catch(S){console.error("Error loading classes:",S)}},P=()=>{if(!n)return;j(!0);const S=ge.subscribeToClassStudents(n,T=>{console.log(` Real-time students update for class ${n}: ${T.length} students`),u(T),N(ee=>ee+1);const V={};T.forEach(ee=>{V[ee.id]="present"}),f(V),j(!1)});return()=>{S&&S()}},O=async()=>{if(!(!n||!i))try{const S=await ge.getClassAttendance(n,i);if(v(S),S.length>0){const T={};S.forEach(V=>{T[V.studentId]=V.status}),f(V=>({...V,...T}))}}catch(S){console.error("Error loading existing attendance:",S)}},D=(S,T)=>{f(V=>({...V,[S]:T}))},w=async()=>{if(!(!n||!i)){R(!0);try{const S=Object.entries(d).map(([T,V])=>({studentId:T,status:V}));await ge.markClassAttendance(n,i,S),await O(),alert(` Attendance saved for ${S.length} students on ${i}`)}catch(S){console.error("Error saving attendance:",S),alert(" Error saving attendance. Please try again.")}finally{R(!1)}}},g=(()=>{const S=c.length,T=Object.values(d).filter(be=>be==="present").length,V=Object.values(d).filter(be=>be==="absent").length,ee=Object.values(d).filter(be=>be==="late").length;return{total:S,present:T,absent:V,late:ee,percentage:S>0?Math.round(T/S*100):0}})(),k=S=>{switch(S){case"present":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"absent":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";case"late":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-300"}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Attendance Management"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Real-time student updates: ",_,"  ",c.length," students in class"]})]}),a.jsxs("button",{onClick:w,disabled:A||!n||c.length===0,className:"flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-colors",children:[a.jsx(og,{className:"w-4 h-4 mr-2"}),A?"Saving...":"Save Attendance"]})]}),a.jsx("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-emerald-900 dark:text-emerald-100",children:" Live Student Data"}),a.jsx("p",{className:"text-xs text-emerald-700 dark:text-emerald-300",children:"Student list updates automatically when new students join the class. Attendance is saved in real-time to Firebase."})]})]})}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Class"}),a.jsxs("select",{value:n,onChange:S=>s(S.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select a class"}),e.map(S=>a.jsxs("option",{value:S.id,children:[S.name," - ",S.subject," (",S.students.length," students)"]},S.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date"}),a.jsx("input",{type:"date",value:i,onChange:S=>o(S.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]})}),n&&c.length>0&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Students"}),a.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:g.total})]}),a.jsx(de,{className:"w-8 h-8 text-blue-600"})]})}),a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Present"}),a.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:g.present})]}),a.jsx(fr,{className:"w-8 h-8 text-green-600"})]})}),a.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Absent"}),a.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:g.absent})]}),a.jsx(sm,{className:"w-8 h-8 text-red-600"})]})}),a.jsx("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Attendance Rate"}),a.jsxs("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:[g.percentage,"%"]})]}),a.jsx(Ve,{className:"w-8 h-8 text-purple-600"})]})})]}),n&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4 flex items-center justify-between",children:[a.jsxs("span",{children:["Mark Attendance - ",(b=e.find(S=>S.id===n))==null?void 0:b.name," (",i,")"]}),_>0&&a.jsxs("span",{className:"px-2 py-1 text-xs bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300 rounded-full",children:["Live Updates: ",_]})]}),y?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading students..."})]}):c.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No students found"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"This class doesn't have any students yet. Students will appear here when they register and join the class."})]}):a.jsx("div",{className:"space-y-3",children:c.map(S=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold",children:S.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:S.name}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Roll: ",S.rollNumber,"  ID: ",S.studentId]})]})]}),a.jsx("div",{className:"flex space-x-2",children:["present","absent","late"].map(T=>a.jsxs("button",{onClick:()=>D(S.id,T),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${d[S.id]===T?k(T):"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:[T==="present"&&a.jsx(fr,{className:"w-4 h-4 inline mr-1"}),T==="absent"&&a.jsx(sm,{className:"w-4 h-4 inline mr-1"}),T==="late"&&a.jsx(St,{className:"w-4 h-4 inline mr-1"}),T.charAt(0).toUpperCase()+T.slice(1)]},T))})]},S.id))})]}),!n&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Ve,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a Class"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Choose a class from the dropdown to start marking attendance. Student data updates in real-time."})]})]})},LP=()=>{const{currentUser:t}=tt(),[e,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState(!1),[c,u]=C.useState(null),[d,f]=C.useState([]),[m,v]=C.useState(!1),[y,j]=C.useState({title:"",description:"",classId:"",subject:"",dueDate:"",maxMarks:100,instructions:""});C.useEffect(()=>{t&&(A(),R())},[t]);const A=async()=>{if(t)try{const D=await ge.getTeacherClasses(t.uid);s(D)}catch(D){console.error("Error loading classes:",D)}},R=async()=>{if(t){v(!0);try{const w=(await ge.getTeacherAssignments(t.uid)).map(x=>{const g=n.find(k=>k.id===x.classId);return{...x,className:(g==null?void 0:g.name)||"Unknown Class"}});r(w)}catch(D){console.error("Error loading assignments:",D)}finally{v(!1)}}},_=async()=>{if(!(!t||!y.title||!y.classId))try{await ge.createAssignment(y,t.uid),o(!1),j({title:"",description:"",classId:"",subject:"",dueDate:"",maxMarks:100,instructions:""}),R(),alert(" Assignment created successfully!")}catch(D){console.error("Error creating assignment:",D),alert(" Error creating assignment. Please try again.")}},N=async D=>{try{const w=await ge.getAssignmentSubmissions(D);f(w),u(D)}catch(w){console.error("Error loading submissions:",w)}},I=async(D,w,x)=>{if(c)try{await ge.gradeSubmission(c,D,{grade:w,feedback:x}),N(c),alert(" Submission graded successfully!")}catch(g){console.error("Error grading submission:",g),alert(" Error grading submission. Please try again.")}},P=D=>{switch(D){case"submitted":return"text-green-600 bg-green-100 dark:bg-green-900/20 dark:text-green-300";case"graded":return"text-blue-600 bg-blue-100 dark:bg-blue-900/20 dark:text-blue-300";case"pending":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20 dark:text-yellow-300";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/20 dark:text-gray-300"}},O=[{title:"Total Assignments",value:e.length,icon:et,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Active Assignments",value:e.filter(D=>new Date(D.dueDate)>new Date).length,icon:St,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Total Submissions",value:e.reduce((D,w)=>D+w.stats.totalSubmissions,0),icon:fr,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Average Grade",value:e.length>0?Math.round(e.reduce((D,w)=>D+w.stats.averageGrade,0)/e.length)+"%":"0%",icon:de,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Assignment Management"}),a.jsxs("button",{onClick:()=>o(!0),className:"flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Create Assignment"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:O.map((D,w)=>a.jsx("div",{className:`${D.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:D.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${D.color}`,children:D.value})]}),a.jsx(D.icon,{className:`w-8 h-8 ${D.color}`})]})},w))}),i&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Create New Assignment"})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Assignment Title"}),a.jsx("input",{type:"text",value:y.title,onChange:D=>j({...y,title:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Enter assignment title"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Class"}),a.jsxs("select",{value:y.classId,onChange:D=>{const w=n.find(x=>x.id===D.target.value);j({...y,classId:D.target.value,subject:(w==null?void 0:w.subject)||""})},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select a class"}),n.map(D=>a.jsxs("option",{value:D.id,children:[D.name," - ",D.subject]},D.id))]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subject"}),a.jsx("input",{type:"text",value:y.subject,onChange:D=>j({...y,subject:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Subject",readOnly:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date"}),a.jsx("input",{type:"date",value:y.dueDate,onChange:D=>j({...y,dueDate:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Maximum Marks"}),a.jsx("input",{type:"number",value:y.maxMarks,onChange:D=>j({...y,maxMarks:parseInt(D.target.value)||100}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),a.jsx("textarea",{value:y.description,onChange:D=>j({...y,description:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:4,placeholder:"Assignment description and requirements"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Instructions"}),a.jsx("textarea",{value:y.instructions,onChange:D=>j({...y,instructions:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:3,placeholder:"Additional instructions for students"})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex space-x-3",children:[a.jsx("button",{onClick:_,disabled:!y.title||!y.classId,className:"flex-1 py-2 px-4 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-colors",children:"Create Assignment"}),a.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"})]})]})}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Your Assignments"}),m?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full mx-auto"})}):e.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(et,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No assignments yet"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create your first assignment to get started."})]}):a.jsx("div",{className:"space-y-4",children:e.map(D=>a.jsx("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-md transition-shadow",children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:D.title}),a.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 dark:text-gray-400 mb-2",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(de,{className:"w-4 h-4 mr-1"}),D.className]}),a.jsxs("span",{className:"flex items-center",children:[a.jsx(Ve,{className:"w-4 h-4 mr-1"}),"Due: ",new Date(D.dueDate).toLocaleDateString()]}),a.jsxs("span",{children:["Max: ",D.maxMarks," marks"]})]}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2",children:D.description}),a.jsxs("div",{className:"flex items-center space-x-4 mt-3 text-sm",children:[a.jsxs("span",{className:"text-blue-600 dark:text-blue-400",children:[D.stats.totalSubmissions," submissions"]}),a.jsxs("span",{className:"text-green-600 dark:text-green-400",children:[D.stats.submissionRate,"% submission rate"]}),a.jsxs("span",{className:"text-purple-600 dark:text-purple-400",children:["Avg: ",D.stats.averageGrade,"%"]})]})]}),a.jsxs("div",{className:"flex space-x-2 ml-4",children:[a.jsxs("button",{onClick:()=>N(D.id),className:"px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[a.jsx(Zr,{className:"w-4 h-4 mr-1"}),"View"]}),a.jsx("button",{className:"px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:a.jsx($_,{className:"w-4 h-4"})})]})]})},D.id))})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Assignment Submissions"}),a.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]})}),a.jsx("div",{className:"p-6",children:d.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(et,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No submissions yet"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Students haven't submitted their work yet."})]}):a.jsx("div",{className:"space-y-4",children:d.map(D=>{var w,x;return a.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:D.studentName}),a.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["ID: ",D.studentId,"  Submitted: ",(w=D.submittedAt)==null?void 0:w.toLocaleDateString()]})]}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${P(D.status)}`,children:D.status})]}),a.jsx("p",{className:"text-gray-700 dark:text-gray-300 mb-3",children:D.content}),D.status==="submitted"&&a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("input",{type:"number",placeholder:"Grade",className:"w-20 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm",max:((x=e.find(g=>g.id===c))==null?void 0:x.maxMarks)||100}),a.jsx("input",{type:"text",placeholder:"Feedback",className:"flex-1 px-3 py-1 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"}),a.jsx("button",{onClick:()=>{const g=document.querySelector('input[type="number"]'),k=document.querySelector('input[type="text"]');g&&k&&I(D.id,parseInt(g.value),k.value)},className:"px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition-colors text-sm",children:"Grade"})]}),D.status==="graded"&&a.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:a.jsxs("p",{className:"text-sm text-green-800 dark:text-green-300",children:[a.jsx("strong",{children:"Grade:"})," ",D.grade,"  ",a.jsx("strong",{children:"Feedback:"})," ",D.feedback]})})]},D.id)})})})]})})]})},OP=()=>{var T;const{currentUser:t}=tt(),[e,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState(""),[c,u]=C.useState(""),[d,f]=C.useState("Quiz"),[m,v]=C.useState(100),[y,j]=C.useState([]),[A,R]=C.useState(!1),[_,N]=C.useState(!1);C.useEffect(()=>{t&&I()},[t]),C.useEffect(()=>{i&&P()},[i]),C.useEffect(()=>{n.length>0&&O()},[n,m]);const I=async()=>{if(t)try{const V=await ge.getTeacherClasses(t.uid);r(V),V.length>0&&(o(V[0].id),u(V[0].subject))}catch(V){console.error("Error loading classes:",V)}},P=async()=>{if(i){R(!0);try{const V=await ge.getClassStudents(i);s(V)}catch(V){console.error("Error loading students:",V)}finally{R(!1)}}},O=()=>{const V=n.map(ee=>({studentId:ee.id,studentName:ee.name,marks:0,maxMarks:m,percentage:0,grade:"F"}));j(V)},D=(V,ee)=>{j(be=>be.map(De=>{if(De.studentId===V){const H=ee/m*100,X=w(H);return{...De,marks:ee,percentage:H,grade:X}}return De}))},w=V=>V>=90?"A+":V>=80?"A":V>=70?"B+":V>=60?"B":V>=50?"C+":V>=40?"C":"F",x=V=>{switch(V){case"A+":case"A":return"text-green-600 bg-green-100 dark:bg-green-900/20 dark:text-green-300";case"B+":case"B":return"text-blue-600 bg-blue-100 dark:bg-blue-900/20 dark:text-blue-300";case"C+":case"C":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20 dark:text-yellow-300";default:return"text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-300"}},g=async()=>{if(!(!i||!c||y.length===0)){N(!0);try{const V=y.map(ee=>({studentId:ee.studentId,marks:ee.marks,maxMarks:ee.maxMarks,examType:d}));await ge.updateStudentMarks(i,c,V),alert(" Marks saved successfully!")}catch(V){console.error("Error saving marks:",V),alert(" Error saving marks. Please try again.")}finally{N(!1)}}},b=(()=>{if(y.length===0)return{average:0,highest:0,lowest:0,passRate:0};const V=y.filter(B=>B.marks>0);if(V.length===0)return{average:0,highest:0,lowest:0,passRate:0};const ee=V.map(B=>B.percentage),be=ee.reduce((B,ue)=>B+ue,0)/ee.length,De=Math.max(...ee),H=Math.min(...ee),X=V.filter(B=>B.percentage>=40).length/V.length*100;return{average:be,highest:De,lowest:H,passRate:X}})(),S=[{title:"Class Average",value:`${b.average.toFixed(1)}%`,icon:nP,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Highest Score",value:`${b.highest.toFixed(1)}%`,icon:Ic,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Pass Rate",value:`${b.passRate.toFixed(1)}%`,icon:Ft,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Total Students",value:n.length,icon:de,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Marks Management"}),a.jsxs("button",{onClick:g,disabled:_||y.length===0,className:"flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-colors",children:[a.jsx(og,{className:"w-4 h-4 mr-2"}),_?"Saving...":"Save Marks"]})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Class"}),a.jsxs("select",{value:i,onChange:V=>{o(V.target.value);const ee=e.find(be=>be.id===V.target.value);ee&&u(ee.subject)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select a class"}),e.map(V=>a.jsxs("option",{value:V.id,children:[V.name," - ",V.subject]},V.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subject"}),a.jsx("input",{type:"text",value:c,onChange:V=>u(V.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"Subject"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Exam Type"}),a.jsxs("select",{value:d,onChange:V=>f(V.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"Quiz",children:"Quiz"}),a.jsx("option",{value:"Test",children:"Test"}),a.jsx("option",{value:"Midterm",children:"Midterm"}),a.jsx("option",{value:"Final",children:"Final Exam"}),a.jsx("option",{value:"Assignment",children:"Assignment"}),a.jsx("option",{value:"Project",children:"Project"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Maximum Marks"}),a.jsx("input",{type:"number",value:m,onChange:V=>v(parseInt(V.target.value)||100),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"1"})]})]})}),i&&y.some(V=>V.marks>0)&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:S.map((V,ee)=>a.jsx("div",{className:`${V.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:V.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${V.color}`,children:V.value})]}),a.jsx(V.icon,{className:`w-8 h-8 ${V.color}`})]})},ee))}),i&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Enter Marks - ",(T=e.find(V=>V.id===i))==null?void 0:T.name," (",d,")"]}),A?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full mx-auto"})}):n.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No students found"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"This class doesn't have any students yet."})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-gray-200 dark:border-gray-600",children:[a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900 dark:text-white",children:"Student"}),a.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900 dark:text-white",children:"Roll No."}),a.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-900 dark:text-white",children:"Marks"}),a.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-900 dark:text-white",children:"Percentage"}),a.jsx("th",{className:"text-center py-3 px-4 font-medium text-gray-900 dark:text-white",children:"Grade"})]})}),a.jsx("tbody",{children:y.map((V,ee)=>{var be;return a.jsxs("tr",{className:"border-b border-gray-100 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:V.studentName.charAt(0)}),a.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:V.studentName})]})}),a.jsx("td",{className:"py-3 px-4 text-gray-600 dark:text-gray-400",children:((be=n[ee])==null?void 0:be.rollNumber)||`R${ee+1}`}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("input",{type:"number",value:V.marks,onChange:De=>D(V.studentId,parseInt(De.target.value)||0),className:"w-20 px-2 py-1 border border-gray-300 dark:border-gray-600 rounded text-center bg-white dark:bg-gray-700 text-gray-900 dark:text-white",min:"0",max:m}),a.jsxs("span",{className:"text-gray-500 dark:text-gray-400",children:["/ ",m]})]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsxs("span",{className:"font-medium text-gray-900 dark:text-white",children:[V.percentage.toFixed(1),"%"]})}),a.jsx("td",{className:"py-3 px-4 text-center",children:a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x(V.grade)}`,children:V.grade})})]},V.studentId)})})]})})]}),!i&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Gt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a Class"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Choose a class from the dropdown to start entering marks."})]})]})},VP=()=>{const{currentUser:t}=tt(),[e,r]=C.useState([]),[n,s]=C.useState(""),[i,o]=C.useState([]),[c,u]=C.useState([]),[d,f]=C.useState(""),[m,v]=C.useState(""),[y,j]=C.useState(!1),[A,R]=C.useState(!1);C.useEffect(()=>{t&&_()},[t]),C.useEffect(()=>{n&&N()},[n]);const _=async()=>{if(t)try{const w=await ge.getTeacherClasses(t.uid);r(w),w.length>0&&s(w[0].id)}catch(w){console.error("Error loading classes:",w)}},N=async()=>{if(n){j(!0);try{const w=await ge.getClassStudents(n);o(w);const x=w.map(async k=>{const b={studentId:k.id,studentName:k.name,attendanceRate:Math.random()*40+60,averageGrade:Math.random()*30+70,assignmentSubmissionRate:Math.random()*20+80,overallPerformance:"good"},S=(b.attendanceRate+b.averageGrade+b.assignmentSubmissionRate)/3;return S>=90?b.overallPerformance="excellent":S>=80?b.overallPerformance="good":S>=70?b.overallPerformance="average":b.overallPerformance="needs_improvement",b}),g=await Promise.all(x);u(g)}catch(w){console.error("Error loading class data:",w)}finally{j(!1)}}},I=async()=>{if(d){R(!0);try{const w=c.find(g=>g.studentId===d);if(!w)return;await new Promise(g=>setTimeout(g,2e3));const x=`
## AI Performance Analysis for ${w.studentName}

### Overall Assessment
${w.studentName} demonstrates **${w.overallPerformance.replace("_"," ")}** performance across all metrics. Based on comprehensive data analysis, here are the key insights:

### Attendance Analysis
- **Current Rate**: ${w.attendanceRate.toFixed(1)}%
- **Trend**: ${w.attendanceRate>85?"Consistent and reliable attendance pattern":"Attendance needs improvement for better academic outcomes"}
- **Impact**: ${w.attendanceRate>85?"Strong correlation with academic performance":"Irregular attendance may be affecting learning continuity"}

### Academic Performance
- **Average Grade**: ${w.averageGrade.toFixed(1)}%
- **Performance Level**: ${w.averageGrade>85?"Excellent grasp of subject matter":w.averageGrade>75?"Good understanding with room for improvement":"Requires additional support and intervention"}
- **Strengths**: ${w.averageGrade>80?"Demonstrates strong analytical skills and concept retention":"Shows potential with focused effort"}

### Assignment Engagement
- **Submission Rate**: ${w.assignmentSubmissionRate.toFixed(1)}%
- **Quality**: ${w.assignmentSubmissionRate>90?"Consistently submits high-quality work on time":"Needs to improve consistency in assignment completion"}
- **Participation**: ${w.assignmentSubmissionRate>85?"Actively engaged in coursework":"Could benefit from increased engagement"}

### Recommendations
${w.overallPerformance==="excellent"?` Continue current study habits and consider advanced challenges
 Potential candidate for peer tutoring or leadership roles
 Encourage participation in academic competitions`:w.overallPerformance==="good"?` Focus on consistency across all areas
 Set specific goals for improvement
 Consider additional practice in weaker subjects`:` Implement structured study schedule
 Seek additional support from teachers or tutors
 Regular progress monitoring recommended`}

### Action Plan
1. **Short-term (1-2 weeks)**: ${w.attendanceRate<80?"Improve attendance consistency":"Maintain current positive trends"}
2. **Medium-term (1 month)**: ${w.averageGrade<80?"Focus on core concept mastery":"Explore advanced topics and applications"}
3. **Long-term (semester)**: ${w.overallPerformance==="needs_improvement"?"Achieve consistent performance above 80%":"Maintain excellence and explore leadership opportunities"}

### Parent/Guardian Consultation
${w.overallPerformance==="needs_improvement"?"Recommended to discuss support strategies and create a collaborative improvement plan.":"Positive feedback session to acknowledge achievements and discuss future goals."}

---
*This report was generated using AI analysis of attendance, academic performance, and engagement data. For detailed discussion, please schedule a consultation.*
      `;v(x)}catch(w){console.error("Error generating AI report:",w),v("Error generating report. Please try again.")}finally{R(!1)}}},P=w=>{switch(w){case"excellent":return"text-green-600 bg-green-100 dark:bg-green-900/20 dark:text-green-300";case"good":return"text-blue-600 bg-blue-100 dark:bg-blue-900/20 dark:text-blue-300";case"average":return"text-yellow-600 bg-yellow-100 dark:bg-yellow-900/20 dark:text-yellow-300";case"needs_improvement":return"text-red-600 bg-red-100 dark:bg-red-900/20 dark:text-red-300";default:return"text-gray-600 bg-gray-100 dark:bg-gray-900/20 dark:text-gray-300"}},O={totalStudents:i.length,averageAttendance:c.length>0?c.reduce((w,x)=>w+x.attendanceRate,0)/c.length:0,averageGrade:c.length>0?c.reduce((w,x)=>w+x.averageGrade,0)/c.length:0,excellentPerformers:c.filter(w=>w.overallPerformance==="excellent").length},D=[{title:"Total Students",value:O.totalStudents,icon:de,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Class Average",value:`${O.averageGrade.toFixed(1)}%`,icon:Ft,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Attendance Rate",value:`${O.averageAttendance.toFixed(1)}%`,icon:rP,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Top Performers",value:O.excellentPerformers,icon:et,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"AI Reports & Analytics"}),a.jsx("div",{className:"flex space-x-2",children:a.jsxs("button",{className:"flex items-center px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[a.jsx(Pc,{className:"w-4 h-4 mr-2"}),"Export Data"]})})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Class"}),a.jsxs("select",{value:n,onChange:w=>s(w.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select a class"}),e.map(w=>a.jsxs("option",{value:w.id,children:[w.name," - ",w.subject]},w.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Student for AI Report"}),a.jsxs("select",{value:d,onChange:w=>f(w.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select a student"}),i.map(w=>a.jsxs("option",{value:w.id,children:[w.name," - ",w.rollNumber]},w.id))]})]})]})}),n&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:D.map((w,x)=>a.jsx("div",{className:`${w.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:w.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${w.color}`,children:w.value})]}),a.jsx(w.icon,{className:`w-8 h-8 ${w.color}`})]})},x))}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n&&a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Class Performance Overview"}),y?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full mx-auto"})}):c.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No data available"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Select a class to view performance data."})]}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:c.map(w=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:w.studentName.charAt(0)}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:w.studentName}),a.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-600 dark:text-gray-400",children:[a.jsxs("span",{children:["Attendance: ",w.attendanceRate.toFixed(1),"%"]}),a.jsxs("span",{children:["Grade: ",w.averageGrade.toFixed(1),"%"]})]})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${P(w.overallPerformance)}`,children:w.overallPerformance.replace("_"," ")}),a.jsx("button",{onClick:()=>f(w.studentId),className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:a.jsx(Zr,{className:"w-4 h-4"})})]})]},w.studentId))})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"AI Performance Report"}),a.jsxs("button",{onClick:I,disabled:!d||A,className:"flex items-center px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 disabled:opacity-50 transition-colors",children:[a.jsx(ur,{className:"w-4 h-4 mr-2"}),A?"Generating...":"Generate AI Report"]})]}),d?A?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Generating AI Report"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Analyzing student data and generating comprehensive insights..."})]}):m?a.jsxs("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:[a.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 max-h-96 overflow-y-auto",children:a.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-700 dark:text-gray-300 font-sans",children:m})}),a.jsxs("div",{className:"flex space-x-2 mt-4",children:[a.jsxs("button",{className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[a.jsx(Pc,{className:"w-4 h-4 mr-1"}),"Download PDF"]}),a.jsx("button",{onClick:()=>v(""),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm",children:"Clear"})]})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(et,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Ready to Generate"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:'Click "Generate AI Report" to create a comprehensive performance analysis.'})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(ur,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a Student"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Choose a student from the dropdown to generate an AI-powered performance report."})]})]})]})]})},FP=()=>{const{currentUser:t}=tt(),[e,r]=C.useState(null),[n,s]=C.useState(""),[i,o]=C.useState(""),[c]=C.useState([{id:"class-12a-math",name:"Class 12-A Mathematics",description:"Mathematics class discussions and announcements",members:["teacher1","student1","student2","student3"],lastMessage:"Tomorrow's test has been postponed to Friday",lastMessageTime:new Date("2024-01-20T15:30:00"),type:"class"},{id:"class-11b-physics",name:"Class 11-B Physics",description:"Physics class discussions and lab updates",members:["teacher1","student4","student5","student6"],lastMessage:"Lab report submissions due next week",lastMessageTime:new Date("2024-01-20T14:15:00"),type:"class"},{id:"math-teachers",name:"Mathematics Department",description:"Mathematics teachers coordination",members:["teacher1","teacher2","teacher3"],lastMessage:"Curriculum meeting scheduled for Monday",lastMessageTime:new Date("2024-01-19T16:45:00"),type:"subject"},{id:"parent-teacher",name:"Parent-Teacher Communication",description:"Communication with parents and guardians",members:["teacher1","parent1","parent2"],lastMessage:"Parent-teacher meeting next Thursday",lastMessageTime:new Date("2024-01-19T09:20:00"),type:"general"}]),[u,d]=C.useState([{id:"1",text:"Good morning everyone! Tomorrow's mathematics test has been postponed to Friday due to the school event.",senderId:"teacher1",senderName:"Prof. Anderson",timestamp:new Date("2024-01-20T15:30:00"),groupId:"class-12a-math"},{id:"2",text:"Thank you for the update, Professor!",senderId:"student1",senderName:"Alice Johnson",timestamp:new Date("2024-01-20T15:32:00"),groupId:"class-12a-math"},{id:"3",text:"Should we still prepare for the original syllabus?",senderId:"student2",senderName:"Bob Smith",timestamp:new Date("2024-01-20T15:35:00"),groupId:"class-12a-math"},{id:"4",text:"Yes, the syllabus remains the same. Focus on chapters 8-12.",senderId:"teacher1",senderName:"Prof. Anderson",timestamp:new Date("2024-01-20T15:37:00"),groupId:"class-12a-math"},{id:"5",text:"Lab report submissions are due next week. Please submit them by Wednesday.",senderId:"teacher1",senderName:"Prof. Anderson",timestamp:new Date("2024-01-20T14:15:00"),groupId:"class-11b-physics"}]),f=c.filter(_=>_.name.toLowerCase().includes(i.toLowerCase())||_.description.toLowerCase().includes(i.toLowerCase())),m=c.find(_=>_.id===e),v=u.filter(_=>_.groupId===e),y=()=>{if(n.trim()&&e&&t){const _={id:Date.now().toString(),text:n.trim(),senderId:t.uid,senderName:"Prof. Anderson",timestamp:new Date,groupId:e};d([...u,_]),s("")}},j=_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),y())},A=_=>{switch(_){case"class":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"subject":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"general":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}},R=_=>{switch(_){case"class":return"";case"subject":return"";case"general":return"";default:return""}};return a.jsxs("div",{className:"h-[calc(100vh-8rem)] flex bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden",children:[a.jsxs("div",{className:"w-80 border-r border-gray-200 dark:border-gray-700 flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Messages"}),a.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a.jsx(Tr,{className:"w-5 h-5"})})]}),a.jsxs("div",{className:"relative",children:[a.jsx(zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search groups...",value:i,onChange:_=>o(_.target.value),className:"w-full pl-9 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:f.map(_=>a.jsx("div",{onClick:()=>r(_.id),className:`p-4 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors ${e===_.id?"bg-emerald-50 dark:bg-emerald-900/20 border-r-2 border-emerald-500":""}`,children:a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"text-2xl",children:R(_.type)}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center justify-between mb-1",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:_.name}),_.lastMessageTime&&a.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:_.lastMessageTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${A(_.type)}`,children:_.type}),a.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[_.members.length," members"]})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate mb-1",children:_.description}),_.lastMessage&&a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 truncate",children:_.lastMessage})]})]})},_.id))})]}),a.jsx("div",{className:"flex-1 flex flex-col",children:e?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"text-2xl",children:R((m==null?void 0:m.type)||"general")}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:m==null?void 0:m.name}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m==null?void 0:m.members.length," members  ",m==null?void 0:m.description]})]})]}),a.jsx("button",{className:"p-2 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:a.jsx(de,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:v.map(_=>a.jsx("div",{className:`flex ${_.senderId===(t==null?void 0:t.uid)?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-lg ${_.senderId===(t==null?void 0:t.uid)?"bg-emerald-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white"}`,children:[_.senderId!==(t==null?void 0:t.uid)&&a.jsx("p",{className:"text-xs font-medium mb-1 opacity-75",children:_.senderName}),a.jsx("p",{className:"text-sm",children:_.text}),a.jsx("p",{className:`text-xs mt-1 opacity-75 ${_.senderId===(t==null?void 0:t.uid)?"text-emerald-100":"text-gray-500 dark:text-gray-400"}`,children:_.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},_.id))}),a.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("textarea",{value:n,onChange:_=>s(_.target.value),onKeyPress:j,placeholder:"Type a message...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:1}),a.jsx("button",{onClick:y,disabled:!n.trim(),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a.jsx(lg,{className:"w-4 h-4"})})]})})]}):a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(F_,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a group to start messaging"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Choose a group from the sidebar to view and send messages to your students and colleagues."})]})})})]})},UP=()=>{const{currentUser:t}=tt(),[e,r]=C.useState([]),[n,s]=C.useState(null),[i,o]=C.useState([]),[c,u]=C.useState(!1),[d,f]=C.useState(!1),[m,v]=C.useState(0),[y,j]=C.useState({name:"",subject:"",grade:"",section:"",schedule:[{day:"Monday",startTime:"09:00",endTime:"10:00"}]});C.useEffect(()=>{t&&(A(),R())},[t]);const A=async()=>{if(t){u(!0);try{const x=await ge.getTeacherClasses(t.uid);r(x)}catch(x){console.error("Error loading classes:",x)}finally{u(!1)}}},R=()=>{if(!t)return;const x=ge.subscribeToAllStudents(g=>{console.log(` Real-time class updates: ${g.length} total students`),v(k=>k+1),A()});return()=>{x&&x()}},_=async x=>{s(x);try{const g=await ge.getClassStudents(x.id);o(g)}catch(g){console.error("Error loading class students:",g)}},N=async()=>{if(!t||!y.name||!y.subject||!y.grade||!y.section){alert("Please fill in all required fields");return}try{u(!0);const x=await ge.createClass({name:y.name,subject:y.subject,grade:y.grade,section:y.section,schedule:y.schedule,teacherId:t.uid});j({name:"",subject:"",grade:"",section:"",schedule:[{day:"Monday",startTime:"09:00",endTime:"10:00"}]}),f(!1),await A(),alert(` Class "${y.name}" created successfully!`)}catch(x){console.error("Error creating class:",x),alert(" Error creating class. Please try again.")}finally{u(!1)}},I=()=>{j({...y,schedule:[...y.schedule,{day:"Monday",startTime:"09:00",endTime:"10:00"}]})},P=x=>{j({...y,schedule:y.schedule.filter((g,k)=>k!==x)})},O=(x,g,k)=>{const b=y.schedule.map((S,T)=>T===x?{...S,[g]:k}:S);j({...y,schedule:b})},D=x=>!x||x.length===0?"No schedule set":x.map(g=>`${g.day} ${g.startTime}-${g.endTime}`).join(", "),w=[{title:"Total Classes",value:e.length,icon:as,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Total Students",value:e.reduce((x,g)=>x+g.students.length,0),icon:de,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Active Classes",value:e.filter(x=>x.isActive).length,icon:Ve,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Real-time Updates",value:m,icon:St,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"My Classes"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Real-time updates: ",m,"  ",e.length," classes"]})]}),a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:[a.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Create Class"]})]}),a.jsx("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-emerald-900 dark:text-emerald-100",children:" Live Class Data"}),a.jsx("p",{className:"text-xs text-emerald-700 dark:text-emerald-300",children:"Student counts and class rosters update automatically when students register and join classes."})]})]})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:w.map((x,g)=>a.jsx("div",{className:`${x.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:x.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${x.color}`,children:x.value})]}),a.jsx(x.icon,{className:`w-8 h-8 ${x.color}`})]})},g))}),d&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Create New Class"}),a.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:a.jsx(Ai,{className:"w-5 h-5"})})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Class Name *"}),a.jsx("input",{type:"text",value:y.name,onChange:x=>j({...y,name:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Class 12-A Mathematics"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Subject *"}),a.jsx("input",{type:"text",value:y.subject,onChange:x=>j({...y,subject:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Mathematics"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Grade *"}),a.jsxs("select",{value:y.grade,onChange:x=>j({...y,grade:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select Grade"}),[9,10,11,12].map(x=>a.jsx("option",{value:x.toString(),children:x},x))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Section *"}),a.jsxs("select",{value:y.section,onChange:x=>j({...y,section:x.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"",children:"Select Section"}),["A","B","C","D"].map(x=>a.jsx("option",{value:x,children:x},x))]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Class Schedule"}),a.jsx("button",{type:"button",onClick:I,className:"text-sm text-emerald-600 hover:text-emerald-700",children:"+ Add Slot"})]}),a.jsx("div",{className:"space-y-3",children:y.schedule.map((x,g)=>a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("select",{value:x.day,onChange:k=>O(g,"day",k.target.value),className:"flex-1 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].map(k=>a.jsx("option",{value:k,children:k},k))}),a.jsx("input",{type:"time",value:x.startTime,onChange:k=>O(g,"startTime",k.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("span",{className:"text-gray-500",children:"to"}),a.jsx("input",{type:"time",value:x.endTime,onChange:k=>O(g,"endTime",k.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),y.schedule.length>1&&a.jsx("button",{type:"button",onClick:()=>P(g),className:"text-red-600 hover:text-red-700",children:a.jsx(Ai,{className:"w-4 h-4"})})]},g))})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex space-x-3",children:[a.jsx("button",{onClick:N,disabled:c||!y.name||!y.subject||!y.grade||!y.section,className:"flex-1 py-2 px-4 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-colors flex items-center justify-center",children:c?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"}),"Creating..."]}):a.jsxs(a.Fragment,{children:[a.jsx(og,{className:"w-4 h-4 mr-2"}),"Create Class"]})}),a.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancel"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Your Classes (",e.length,")",m>0&&a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300 rounded-full",children:"Live"})]}),c?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading classes..."})]}):e.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(as,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No classes created"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Create your first class to get started."}),a.jsx("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"Create Class"})]}):a.jsx("div",{className:"space-y-4",children:e.map(x=>a.jsx("div",{className:`border border-gray-200 dark:border-gray-600 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer ${(n==null?void 0:n.id)===x.id?"ring-2 ring-emerald-500 bg-emerald-50 dark:bg-emerald-900/20":""}`,onClick:()=>_(x),children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white",children:x.name}),a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x.isActive?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}`,children:x.isActive?"Active":"Inactive"})]}),a.jsxs("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(as,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:[x.subject,"  Grade ",x.grade,"-",x.section]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(de,{className:"w-4 h-4 mr-2"}),a.jsxs("span",{children:[x.students.length," students"]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(St,{className:"w-4 h-4 mr-2"}),a.jsx("span",{className:"truncate",children:D(x.schedule)})]})]})]}),a.jsxs("div",{className:"flex space-x-2 ml-4",children:[a.jsx("button",{onClick:g=>{g.stopPropagation(),_(x)},className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:a.jsx(Zr,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:a.jsx($_,{className:"w-4 h-4"})})]})]})},x.id))})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Class Details"}),n?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-3",children:n.name}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Subject:"}),a.jsx("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:n.subject})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Grade:"}),a.jsxs("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:[n.grade,"-",n.section]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Students:"}),a.jsxs("span",{className:"ml-2 font-medium text-gray-900 dark:text-white",children:[n.students.length," enrolled"]})]})]})]}),n.schedule&&n.schedule.length>0&&a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Class Schedule"}),a.jsx("div",{className:"space-y-2",children:n.schedule.map((x,g)=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[a.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:x.day}),a.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[x.startTime," - ",x.endTime]})]},g))})]}),a.jsxs("div",{children:[a.jsxs("h5",{className:"font-medium text-gray-900 dark:text-white mb-3",children:["Students (",i.length,")"]}),i.length===0?a.jsxs("div",{className:"text-center py-4",children:[a.jsx(de,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No students enrolled yet. Students will appear here when they register and join this class."})]}):a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:i.map(x=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:x.name.charAt(0)}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h6",{className:"font-medium text-gray-900 dark:text-white",children:x.name}),a.jsxs("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Roll: ",x.rollNumber,"  ID: ",x.studentId]})]})]},x.id))})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{className:"flex-1 py-2 px-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm",children:"Mark Attendance"}),a.jsx("button",{className:"flex-1 py-2 px-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm",children:"Create Assignment"})]})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(as,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a Class"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Click on a class from the list to view its details and students."})]})]})]})]})},$P=()=>{const{currentUser:t}=tt(),[e,r]=C.useState([]),[n,s]=C.useState([]),[i,o]=C.useState([]),[c,u]=C.useState("all"),[d,f]=C.useState(""),[m,v]=C.useState(null),[y,j]=C.useState(null),[A,R]=C.useState(!1),[_,N]=C.useState(0);C.useEffect(()=>{t&&(I(),P())},[t]),C.useEffect(()=>{O()},[n,d,c]);const I=async()=>{if(t)try{const g=await ge.getTeacherClasses(t.uid);r(g)}catch(g){console.error("Error loading classes:",g)}},P=()=>{if(!t)return;R(!0);const g=ge.subscribeToAllStudents(k=>{console.log(` Real-time update: ${k.length} students`),s(k),N(b=>b+1),R(!1)});return()=>{g&&g()}},O=()=>{let g=n;if(d&&(g=g.filter(k=>k.name.toLowerCase().includes(d.toLowerCase())||k.studentId.toLowerCase().includes(d.toLowerCase())||k.rollNumber.toLowerCase().includes(d.toLowerCase())||k.email.toLowerCase().includes(d.toLowerCase()))),c!=="all"){const k=e.find(b=>b.id===c);k&&(g=g.filter(b=>k.students.includes(b.id)))}o(g)},D=async g=>{v(g);try{const k=await ge.getStudentPerformanceData(g.id);j(k)}catch(k){console.error("Error loading student performance:",k),j({attendance:[],grades:[],assignments:[],summary:{attendanceRate:Math.random()*40+60,averageGrade:Math.random()*30+70,assignmentSubmissionRate:Math.random()*20+80}})}},w=()=>{R(!0),P()},x=[{title:"Total Students",value:n.length,icon:de,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Active Students",value:n.filter(g=>g.isActive).length,icon:Ft,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Classes Teaching",value:e.length,icon:Ve,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Real-time Updates",value:_,icon:uo,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Students"}),a.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[i.length," of ",n.length," students  Real-time updates: ",_]})]}),a.jsxs("button",{onClick:w,disabled:A,className:"flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 transition-colors",children:[a.jsx(uo,{className:`w-4 h-4 mr-2 ${A?"animate-spin":""}`}),A?"Loading...":"Refresh"]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:x.map((g,k)=>a.jsx("div",{className:`${g.bgColor} rounded-xl p-6 border border-gray-200 dark:border-gray-700`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:g.title}),a.jsx("p",{className:`text-2xl font-bold mt-1 ${g.color}`,children:g.value})]}),a.jsx(g.icon,{className:`w-8 h-8 ${g.color}`})]})},k))}),a.jsx("div",{className:"bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-200 dark:border-emerald-800 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-pulse"}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-emerald-900 dark:text-emerald-100",children:" Live Student Data"}),a.jsx("p",{className:"text-xs text-emerald-700 dark:text-emerald-300",children:"Student registrations and updates are reflected in real-time. New students appear automatically when they sign up."})]})]})}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:a.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[a.jsxs("div",{className:"flex-1 relative",children:[a.jsx(zi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search students by name, ID, roll number, or email...",value:d,onChange:g=>f(g.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Po,{className:"w-5 h-5 text-gray-400"}),a.jsxs("select",{value:c,onChange:g=>u(g.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"all",children:"All Classes"}),e.map(g=>a.jsxs("option",{value:g.id,children:[g.name," - ",g.subject," (",g.students.length," students)"]},g.id))]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Students List (",i.length,")",_>0&&a.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-emerald-100 text-emerald-800 dark:bg-emerald-900/20 dark:text-emerald-300 rounded-full",children:"Live"})]}),A?a.jsxs("div",{className:"text-center py-8",children:[a.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading students..."})]}):i.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:d?"No students found":"No students available"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:d?`No students match "${d}"`:"Students will appear here when they register."})]}):a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:i.map(g=>a.jsxs("div",{className:`flex items-center justify-between p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:shadow-md transition-all cursor-pointer ${(m==null?void 0:m.id)===g.id?"ring-2 ring-emerald-500 bg-emerald-50 dark:bg-emerald-900/20":""}`,onClick:()=>D(g),children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-semibold",children:g.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:g.name}),a.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("span",{children:["Roll: ",g.rollNumber]}),a.jsx("span",{children:""}),a.jsxs("span",{children:["ID: ",g.studentId]})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:g.class})]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${g.isActive?"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300":"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-300"}`,children:g.isActive?"Active":"Inactive"}),a.jsx("button",{onClick:k=>{k.stopPropagation(),D(g)},className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:a.jsx(Zr,{className:"w-4 h-4"})})]})]},g.id))})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Student Details"}),m?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-bold text-xl",children:m.name.charAt(0)}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:m.name}),a.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[m.studentId,"  Roll: ",m.rollNumber]}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:m.class})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(_u,{className:"w-4 h-4 mr-2 text-gray-400"}),a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:m.email})]}),m.parentContact&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(aP,{className:"w-4 h-4 mr-2 text-gray-400"}),a.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:m.parentContact})]})]})]}),y&&a.jsxs("div",{children:[a.jsx("h5",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Performance Summary"}),a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Attendance Rate"}),a.jsxs("span",{className:"font-semibold text-blue-900 dark:text-blue-100",children:[y.summary.attendanceRate.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-blue-200 dark:bg-blue-800 rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${y.summary.attendanceRate}%`}})})]}),a.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-green-700 dark:text-green-300",children:"Average Grade"}),a.jsxs("span",{className:"font-semibold text-green-900 dark:text-green-100",children:[y.summary.averageGrade.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-500",style:{width:`${y.summary.averageGrade}%`}})})]}),a.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-purple-700 dark:text-purple-300",children:"Assignment Submission"}),a.jsxs("span",{className:"font-semibold text-purple-900 dark:text-purple-100",children:[y.summary.assignmentSubmissionRate.toFixed(1),"%"]})]}),a.jsx("div",{className:"w-full bg-purple-200 dark:bg-purple-800 rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${y.summary.assignmentSubmissionRate}%`}})})]})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{className:"flex-1 py-2 px-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors text-sm",children:"Send Message"}),a.jsx("button",{className:"flex-1 py-2 px-3 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors text-sm",children:"View Reports"})]})]}):a.jsxs("div",{className:"text-center py-8",children:[a.jsx(de,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h4",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"Select a Student"}),a.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Click on a student from the list to view their details and performance."})]})]})]})]})};function zP(){return a.jsx(YC,{children:a.jsx(QC,{children:a.jsx(X2,{children:a.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:a.jsxs(q2,{children:[a.jsx(Te,{path:"/login",element:a.jsx(pP,{})}),a.jsx(Te,{path:"/teacher-login",element:a.jsx(yP,{})}),a.jsx(Te,{path:"/register",element:a.jsx(xP,{})}),a.jsxs(Te,{path:"/dashboard",element:a.jsx(JC,{children:a.jsx(hP,{})}),children:[a.jsx(Te,{index:!0,element:a.jsx(vP,{})}),a.jsx(Te,{path:"ai-hub",element:a.jsx(RP,{})}),a.jsx(Te,{path:"communities",element:a.jsx(EP,{})}),a.jsx(Te,{path:"events",element:a.jsx(NP,{})}),a.jsx(Te,{path:"attendance",element:a.jsx(wP,{})}),a.jsx(Te,{path:"assignments",element:a.jsx(bP,{})}),a.jsx(Te,{path:"gpa-predictor",element:a.jsx(kP,{})}),a.jsx(Te,{path:"messages",element:a.jsx(jP,{})}),a.jsx(Te,{path:"learncenter",element:a.jsx(TP,{})})]}),a.jsxs(Te,{path:"/teacher-dashboard",element:a.jsx(ZC,{children:a.jsx(gP,{})}),children:[a.jsx(Te,{index:!0,element:a.jsx(DP,{})}),a.jsx(Te,{path:"classes",element:a.jsx(UP,{})}),a.jsx(Te,{path:"students",element:a.jsx($P,{})}),a.jsx(Te,{path:"attendance",element:a.jsx(MP,{})}),a.jsx(Te,{path:"assignments",element:a.jsx(LP,{})}),a.jsx(Te,{path:"marks",element:a.jsx(OP,{})}),a.jsx(Te,{path:"reports",element:a.jsx(VP,{})}),a.jsx(Te,{path:"messages",element:a.jsx(FP,{})})]}),a.jsx(Te,{path:"/",element:a.jsx(rf,{to:"/dashboard\\",replace:!0})})]})})})})})}ew(document.getElementById("root")).render(a.jsx(C.StrictMode,{children:a.jsx(zP,{})}));
